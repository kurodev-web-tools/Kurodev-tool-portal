(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64],{45113:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ea});var a=s(36166),i=s(5766),n=s(82789),l=s(49227),r=s(66614),c=s(34437),o=s(26423),d=s(2391),m=s(10508),h=s(87617),x=s(78926),u=s(1219),p=s(54038),g=s(86520),f=s(9885),v=s(388),j=s(89534),N=s(43202),b=s(50521),w=s(31676),y=s(86821),k=s(28448),C=s(35302),z=s(51549);let S={simple:"シンプル",cute:"かわいい",cool:"クール",stylish:"スタイリッシュ",elegant:"エレガント",modern:"モダン",vintage:"ヴィンテージ",minimal:"ミニマル",colorful:"カラフル",dark:"ダーク",bright:"ブライト",nature:"ナチュラル",urban:"アーバン",fantasy:"ファンタジー",retro:"レトロ",futuristic:"フューチャー",romantic:"ロマンチック",energetic:"エネルギッシュ",calm:"カーム",professional:"プロフェッショナル",casual:"カジュアル",formal:"フォーマル",playful:"プレイフル",serious:"シリアス",artistic:"アーティスティック",tech:"テック",gaming:"ゲーミング",music:"ミュージック",food:"フード",travel:"トラベル",fashion:"ファッション",beauty:"ビューティー",lifestyle:"ライフスタイル",business:"ビジネス",education:"エデュケーション",health:"ヘルス",sports:"スポーツ",entertainment:"エンターテイメント",news:"ニュース",technology:"テクノロジー",science:"サイエンス",culture:"カルチャー",social:"ソーシャル",personal:"パーソナル",creative:"クリエイティブ",innovative:"イノベーティブ",traditional:"トラディショナル",contemporary:"コンテンポラリー",experimental:"エクスペリメンタル",classic:"クラシック",trendy:"トレンディ",unique:"ユニーク",premium:"プレミアム",affordable:"アフォーダブル",luxury:"ラグジュアリー",eco:"エコ",sustainable:"サステナブル",organic:"オーガニック",digital:"デジタル",analog:"アナログ",hybrid:"ハイブリッド",pure:"ピュア",mixed:"ミックス",solid:"ソリッド",gradient:"グラデーション",pattern:"パターン",texture:"テクスチャー",geometric:"ジオメトリック",abstract:"アブストラクト",realistic:"リアリスティック",cartoon:"カートゥーン",anime:"アニメ",manga:"マンガ",illustration:"イラストレーション",photography:"フォトグラフィー",design:"デザイン",art:"アート",craft:"クラフト",handmade:"ハンドメイド",industrial:"インダストリアル",rustic:"ラスティック",cozy:"コージー",spacious:"スペーシャス",compact:"コンパクト",large:"ラージ",small:"スモール",medium:"ミディアム",extra:"エクストラ",mega:"メガ",micro:"マイクロ",macro:"マクロ",nano:"ナノ",pico:"ピコ",giga:"ギガ",kilo:"キロ",milli:"ミリ",centi:"センチ",deci:"デシ",deca:"デカ",hecto:"ヘクト",peta:"ペタ",exa:"エクサ",zetta:"ゼタ",yotta:"ヨタ",ronna:"ロナ",quetta:"クエタ",femto:"フェムト",atto:"アト",zepto:"ゼプト",yocto:"ヨクト",ronto:"ロント",quecto:"クエクト"},E=["1:1","4:3","9:16","16:9"],R=i.memo(e=>{let{onSelectTemplate:t,selectedTemplateId:s}=e,{aspectRatio:n,setAspectRatio:l,customAspectRatio:r,setCustomAspectRatio:c}=(0,N.S)(),[o,d]=(0,i.useState)([]),[m,h]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{h(!0),console.log("\uD83D\uDD04 テンプレート読み込み開始...");let e=await (0,z.K)();console.log("✅ テンプレート読み込み完了:",e.length,"個"),console.log("\uD83D\uDCDD 読み込まれたジャンル:",[...new Set(e.map(e=>e.genre))]),d(e)}catch(e){console.error("❌ テンプレート読み込み失敗:",e),d([])}finally{h(!1)}})()},[]);let x=(e,t)=>{let s=parseInt(e.target.value,10),a={...r,[t]:s};!isNaN(s)&&s>0&&(c(a),l("custom"))},u=(0,i.useMemo)(()=>{console.log("\uD83C\uDFAF 現在のアスペクト比:",n);let e=o.filter(e=>"custom"===n||e.supportedAspectRatios.includes(n));return console.log("\uD83D\uDD0D フィルタリング前のテンプレート数:",o.length),console.log("\uD83D\uDD0D フィルタリング後のテンプレート数:",e.length),console.log("\uD83D\uDCCB フィルタリング後のジャンル:",[...new Set(e.map(e=>e.genre))]),e},[o,n]),g=(0,i.useMemo)(()=>{let e=[...new Set(u.map(e=>e.genre))];return console.log("\uD83D\uDD0D 利用可能なジャンル:",e),console.log("\uD83D\uDCCA フィルタリングされたテンプレート数:",u.length),console.log("\uD83D\uDCCB 全テンプレート数:",o.length),console.log("\uD83C\uDFAF 現在のアスペクト比:",n),console.log("\uD83D\uDCDD 全ジャンル（フィルタリング前）:",[...new Set(o.map(e=>e.genre))]),e},[u,o,n]),f=(0,i.useMemo)(()=>(e=>{let t={};return e.forEach(e=>{t[e]=(e=>S[e]||e)(e)}),t})(g),[g]);return m?(0,a.jsx)("div",{className:"w-full p-4 text-center",children:(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"テンプレートを読み込み中..."})}):(0,a.jsxs)(k.nD,{type:"multiple",className:"w-full",defaultValue:["aspect-ratio","templates"],children:[(0,a.jsxs)(k.As,{value:"aspect-ratio",children:[(0,a.jsx)(k.$m,{children:"アスペクト比"}),(0,a.jsxs)(k.ub,{className:"space-y-4 pt-4",children:[(0,a.jsx)(v.J,{children:"プリセット"}),(0,a.jsx)(C.O,{type:"single",value:"custom"===n?"":n,onValueChange:e=>{e&&l(e)},variant:"outline",className:"flex-wrap justify-start",children:E.map(e=>(0,a.jsx)(C.d,{value:e,"aria-label":"比率 ".concat(e),children:e},e))}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{children:"手動設定"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.p,{type:"number",placeholder:"幅",className:"w-24",value:r.width,onChange:e=>x(e,"width")}),(0,a.jsx)("span",{children:":"}),(0,a.jsx)(j.p,{type:"number",placeholder:"高さ",className:"w-24",value:r.height,onChange:e=>x(e,"height")})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"小さい数字で比率、大きい数字で解像度を指定できます。"})]})]})]}),(0,a.jsxs)(k.As,{value:"templates",children:[(0,a.jsx)(k.$m,{children:"テンプレート選択"}),(0,a.jsx)(k.ub,{className:"pt-4",children:g.length>0?(0,a.jsxs)(p.tU,{defaultValue:g[0],className:"w-full",children:[(0,a.jsx)(p.j7,{className:(0,y.cn)("w-full h-auto p-1",g.length<=4?1===g.length?"grid grid-cols-1":2===g.length?"grid grid-cols-2":3===g.length?"grid grid-cols-3":"grid grid-cols-4":"flex overflow-x-auto space-x-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100"),children:g.map(e=>(0,a.jsx)(p.Xi,{value:e,className:(0,y.cn)(g.length>4?"min-w-fit whitespace-nowrap":"","h-8 px-3 py-1 text-sm"),children:f[e]},e))}),g.map(e=>(0,a.jsx)(p.av,{value:e,children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-4",children:u.filter(t=>t.genre===e).map(e=>(0,a.jsx)(w.Zp,{className:(0,y.cn)("cursor-pointer hover:border-primary transition-colors group",s===e.id&&"border-primary ring-2 ring-primary"),onClick:()=>t(e),children:(0,a.jsx)(w.Wu,{className:"p-0 rounded-md",children:(0,a.jsx)("div",{className:(0,y.cn)("w-full rounded-md flex items-center justify-center relative overflow-hidden","1:1"===n?"aspect-square":"4:3"===n?"aspect-[4/3]":"9:16"===n?"aspect-[9/16]":"aspect-video"),children:(0,a.jsx)(b.wF,{src:e.initialImageSrc,alt:e.name,aspectRatio:"16:9",breakpoints:{sm:200,md:250,lg:300},style:{objectFit:"cover"},className:"transition-transform duration-300 group-hover:scale-105"})})})},e.id))})},e))]}):(0,a.jsx)("div",{className:"text-center text-sm text-muted-foreground py-4",children:"このアスペクト比に対応するテンプレートはありません。"})})]})]})});var D=s(72811),$=s(90542);let M=i.memo(e=>{let{id:t,isSelected:s,text:n,color:l="white",fontSize:r="2rem",className:c,x:o,y:d,width:m,height:h,rotation:x,zIndex:u,onDragStop:p,onResizeStop:g,enableResizing:f,disableDragging:v}=e,{updateLayer:j}=(0,N.S)(),[b,w]=(0,i.useState)({x:o,y:d}),[k,C]=(0,i.useState)(!1),z=(0,i.useRef)(null),S=(0,i.useRef)(null);(0,i.useEffect)(()=>{w({x:o,y:d})},[o,d]);let E=(0,i.useCallback)(e=>{var s;e.preventDefault(),e.stopPropagation(),C(!0);let a=null==(s=z.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+b.x+m/2,r=n.top+b.y+h/2,c=e=>{if(0===e.touches.length)return;let s=e.touches[0].clientX-l;j(t,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,s)+90})},o=()=>{C(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[t,j,b.x,b.y,m,h]);return(0,i.useEffect)(()=>{let e=S.current;if(e)return e.addEventListener("touchstart",E,{passive:!1}),()=>{e.removeEventListener("touchstart",E)}},[E]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.p,{ref:z,size:{width:m,height:h},position:b,onDragStart:()=>{if(k)return!1},onDrag:(e,t)=>{k||w({x:t.x,y:t.y})},onDragStop:p,onResizeStop:g,minWidth:50,minHeight:20,enableResizing:f,disableDragging:v||k,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},children:(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",style:{transform:"rotate(".concat(x,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("p",{className:(0,y.cn)("cursor-move",c),style:{color:l,fontSize:r,lineHeight:1,whiteSpace:"pre-wrap"},children:n})})}),s&&(0,a.jsx)("div",{ref:S,onMouseDown:e=>{var s;e.preventDefault(),e.stopPropagation(),C(!0);let a=null==(s=z.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+b.x+m/2,r=n.top+b.y+h/2,c=e=>{let s=e.clientX-l;j(t,{rotation:180/Math.PI*Math.atan2(e.clientY-r,s)+90})},o=()=>{C(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-50",style:{left:b.x+m/2,top:b.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)($.A,{className:"h-4 w-4"})})]})}),J=i.memo(e=>{let{id:t,isSelected:s,src:n,alt:l,x:r,y:c,width:o,height:d,rotation:m,onDragStop:h,onResize:x,onResizeStop:u,onSelect:p,isLocked:g,isDraggable:f,lockAspectRatio:v,enableResizing:j,disableDragging:b,isBackground:w,zIndex:k}=e,{updateLayer:C}=(0,N.S)(),[z,S]=(0,i.useState)({x:r,y:c}),[E,R]=(0,i.useState)(!1),M=(0,i.useRef)(null),J=(0,i.useRef)(null);(0,i.useEffect)(()=>{S({x:r,y:c})},[r,c]);let A=(0,i.useCallback)(e=>{var s;e.preventDefault(),e.stopPropagation(),R(!0);let a=null==(s=M.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+z.x+o/2,r=n.top+z.y+d/2,c=e=>{if(0===e.touches.length)return;let s=e.touches[0].clientX-l;C(t,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,s)+90})},m=()=>{R(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",m)};window.addEventListener("touchmove",c),window.addEventListener("touchend",m)},[t,C,z.x,z.y,o,d]);return(0,i.useEffect)(()=>{let e=J.current;if(e)return e.addEventListener("touchstart",A,{passive:!1}),()=>{e.removeEventListener("touchstart",A)}},[A]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.p,{ref:M,size:w?{width:"100%",height:"100%"}:{width:o,height:d},position:w?{x:0,y:0}:z,onDragStart:()=>{if(E||w)return!1},onDrag:(e,t)=>{E||w||S({x:t.x,y:t.y})},onDragStop:h,onResize:x,onResizeStop:u,lockAspectRatio:v,enableResizing:!w&&j,disableDragging:w||b||E,className:(0,y.cn)("border border-dashed border-transparent transition-colors duration-200",{"hover:border-gray-500":!w&&s}),onClick:p,style:{zIndex:k},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(m,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundImage:n?"url(".concat(n,")"):"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},title:l})})}),s&&!g&&!w&&(0,a.jsx)("div",{ref:J,onMouseDown:e=>{var s;e.preventDefault(),e.stopPropagation(),R(!0);let a=null==(s=M.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+z.x+o/2,r=n.top+z.y+d/2,c=e=>{let s=e.clientX-l;C(t,{rotation:180/Math.PI*Math.atan2(e.clientY-r,s)+90})},m=()=>{R(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",m)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",m)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-50",style:{left:z.x+o/2,top:z.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)($.A,{className:"h-4 w-4"})})]})}),A=(0,i.memo)(e=>{let{id:t,isSelected:s,shapeType:n,backgroundColor:l,borderColor:r,borderWidth:c,rotation:o,zIndex:d,onDragStop:m,onResize:h,onResizeStop:x,lockAspectRatio:u,enableResizing:p,disableDragging:g,x:f,y:v,width:j,height:b}=e,{updateLayer:w}=(0,N.S)(),[y,k]=(0,i.useState)({x:f||0,y:v||0}),[C,z]=(0,i.useState)(!1),S=(0,i.useRef)(null),E=(0,i.useRef)(null);(0,i.useEffect)(()=>{k({x:f||0,y:v||0})},[f,v]);let R=(0,i.useCallback)(e=>{var s;e.preventDefault(),e.stopPropagation(),z(!0);let a=null==(s=S.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+y.x+j/2,r=n.top+y.y+b/2,c=e=>{if(0===e.touches.length)return;let s=e.touches[0].clientX-l;w(t,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,s)+90})},o=()=>{z(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[t,w,y.x,y.y,j,b]);return(0,i.useEffect)(()=>{let e=E.current;if(e)return e.addEventListener("touchstart",R,{passive:!1}),()=>{e.removeEventListener("touchstart",R)}},[R]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.p,{ref:S,size:{width:j,height:b},position:y,onDragStart:()=>{if(C)return!1},onDrag:(e,t)=>{C||k({x:t.x,y:t.y})},onDragStop:m,onResize:h,onResizeStop:x,lockAspectRatio:u,enableResizing:p,disableDragging:g||C,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{zIndex:d},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(o,"deg)"),transformOrigin:"center"},children:(()=>{let e={width:"100%",height:"100%",style:{overflow:"visible"}};switch(n){case"line":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("line",{x1:0,y1:b/2,x2:j,y2:b/2,stroke:r,strokeWidth:c})});case"arrow":return(0,a.jsxs)("svg",{...e,children:[(0,a.jsx)("defs",{children:(0,a.jsx)("marker",{id:"arrowhead-".concat(t),markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",fill:r,children:(0,a.jsx)("polygon",{points:"0 0, 10 3.5, 0 7"})})}),(0,a.jsx)("line",{x1:0,y1:b/2,x2:j-10,y2:b/2,stroke:r,strokeWidth:c,markerEnd:"url(#arrowhead-".concat(t,")")})]});case"triangle":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(j/2,",0 0,").concat(b," ").concat(j,",").concat(b),fill:l,stroke:r,strokeWidth:c})});case"star":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*j,",0 ").concat(.618*j,",").concat(.382*b," ").concat(j,",").concat(.382*b," ").concat(.691*j,",").concat(.618*b," ").concat(.809*j,",").concat(b," ").concat(.5*j,",").concat(.764*b," ").concat(.191*j,",").concat(b," ").concat(.309*j,",").concat(.618*b," 0,").concat(.382*b," ").concat(.382*j,",").concat(.382*b),fill:l,stroke:r,strokeWidth:c})});case"heart":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("path",{d:"M".concat(.5*j,",").concat(.9*b," C").concat(.5*j,",").concat(.9*b," ").concat(.1*j,",").concat(.5*b," ").concat(.1*j,",").concat(.3*b," C").concat(.1*j,",").concat(.15*b," ").concat(.25*j,",").concat(.1*b," ").concat(.4*j,",").concat(.1*b," C").concat(.5*j,",").concat(.1*b," ").concat(.5*j,",").concat(.2*b," ").concat(.5*j,",").concat(.2*b," C").concat(.5*j,",").concat(.2*b," ").concat(.5*j,",").concat(.1*b," ").concat(.6*j,",").concat(.1*b," C").concat(.75*j,",").concat(.1*b," ").concat(.9*j,",").concat(.15*b," ").concat(.9*j,",").concat(.3*b," C").concat(.9*j,",").concat(.5*b," ").concat(.5*j,",").concat(.9*b," ").concat(.5*j,",").concat(.9*b," Z"),fill:l,stroke:r,strokeWidth:c})});case"diamond":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(j/2,",0 ").concat(j,",").concat(b/2," ").concat(j/2,",").concat(b," 0,").concat(b/2),fill:l,stroke:r,strokeWidth:c})});case"polygon":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*j,",0 ").concat(.9*j,",").concat(.3*b," ").concat(.7*j,",").concat(.9*b," ").concat(.3*j,",").concat(.9*b," ").concat(.1*j,",").concat(.3*b),fill:l,stroke:r,strokeWidth:c})});default:return(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:l,border:"".concat(c,"px solid ").concat(r),borderRadius:"circle"===n?"50%":"0"}})}})()})}),s&&(0,a.jsx)("div",{ref:E,onMouseDown:e=>{var s;e.preventDefault(),e.stopPropagation(),z(!0);let a=null==(s=S.current)?void 0:s.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+y.x+j/2,r=n.top+y.y+b/2,c=e=>{let s=e.clientX-l;w(t,{rotation:180/Math.PI*Math.atan2(e.clientY-r,s)+90})},o=()=>{z(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-50",style:{left:y.x+j/2,top:y.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)($.A,{className:"h-4 w-4"})})]})});var L=s(10238),W=s(8748),P=s(17603),T=s(84704),F=s(6522),I=s(33129),X=s(30951),B=s(61501),O=s(82551),q=s(25513),H=s(91946),V=s(15496),U=s(48664),G=s(57588),Z=s(80358),Y=s(7463),_=s(12392);let K={web:[{name:"Web バナー (大)",width:1200,height:630,platform:"web"},{name:"Web バナー (中)",width:800,height:420,platform:"web"},{name:"Web バナー (小)",width:600,height:315,platform:"web"},{name:"ヘッダー画像",width:1920,height:400,platform:"web"}],social:[{name:"Twitter ヘッダー",width:1500,height:500,platform:"twitter"},{name:"Twitter 投稿",width:1200,height:675,platform:"twitter"},{name:"Instagram 投稿",width:1080,height:1080,platform:"instagram"},{name:"Instagram ストーリー",width:1080,height:1920,platform:"instagram"},{name:"Facebook カバー",width:1200,height:630,platform:"facebook"}],print:[{name:"A4 (300DPI)",width:2480,height:3508,platform:"print"},{name:"A3 (300DPI)",width:3508,height:4961,platform:"print"},{name:"名刺 (300DPI)",width:1063,height:638,platform:"print"},{name:"ポスター A2 (300DPI)",width:4961,height:7016,platform:"print"},{name:"フライヤー A5 (300DPI)",width:1748,height:2480,platform:"print"}],presentation:[{name:"スライド 16:9",width:1920,height:1080,platform:"presentation"},{name:"スライド 4:3",width:1024,height:768,platform:"presentation"},{name:"プレゼン用高解像度",width:3840,height:2160,platform:"presentation"}]},Q={low:{pixelRatio:1,label:"軽量 (1x)",description:"Web表示用"},medium:{pixelRatio:1.5,label:"標準 (1.5x)",description:"一般的な用途"},high:{pixelRatio:2,label:"高品質 (2x)",description:"Retina対応"},ultra:{pixelRatio:3,label:"超高品質 (3x)",description:"高解像度ディスプレイ"},print:{pixelRatio:4,label:"印刷用 (4x)",description:"300DPI印刷対応"}},ee=e=>{let{onExport:t,isExporting:s=!1}=e,n=!(0,_.U)("(min-width: 768px)"),[c,d]=(0,i.useState)({resolution:"fhd",quality:"high",format:"png",pixelRatio:2,backgroundColor:"#ffffff",includeTransparency:!1,optimizeForPlatform:"general",batchExport:!1,batchSizes:[]}),[m,h]=(0,i.useState)("web"),[x,u]=(0,i.useState)([]),p=e=>{d(t=>({...t,...e}))},g=e=>{p({batchExport:!0,batchSizes:K[e],optimizeForPlatform:"web"===e?"web":"print"===e?"print":"social",quality:"print"===e?"print":"high",format:"png",includeTransparency:"print"!==e}),h(e)},f=async()=>{let e=document.getElementById("download-target");if(!e)return void l.oR.error("プレビューエリアが見つかりません");try{await t(e,c)}catch(e){console.error("Export failed:",e),l.oR.error("エクスポートに失敗しました")}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(w.Zp,{children:[(0,a.jsx)(w.aR,{className:"pb-3",children:(0,a.jsxs)(w.ZB,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(B.A,{className:"h-4 w-4"}),"用途別プリセット"]})}),(0,a.jsx)(w.Wu,{className:"space-y-3",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"web"===m?"default":"outline",size:n?"sm":"default",onClick:()=>g("web"),className:"flex items-center gap-2",children:[(0,a.jsx)(O.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Web用"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Web"})]}),(0,a.jsxs)(r.$,{variant:"social"===m?"default":"outline",size:n?"sm":"default",onClick:()=>g("social"),className:"flex items-center gap-2",children:[(0,a.jsx)(q.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"SNS用"}),(0,a.jsx)("span",{className:"sm:hidden",children:"SNS"})]}),(0,a.jsxs)(r.$,{variant:"print"===m?"default":"outline",size:n?"sm":"default",onClick:()=>g("print"),className:"flex items-center gap-2",children:[(0,a.jsx)(H.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"印刷用"}),(0,a.jsx)("span",{className:"sm:hidden",children:"印刷"})]}),(0,a.jsxs)(r.$,{variant:"presentation"===m?"default":"outline",size:n?"sm":"default",onClick:()=>g("presentation"),className:"flex items-center gap-2",children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"プレゼン用"}),(0,a.jsx)("span",{className:"sm:hidden",children:"プレゼン"})]})]})})]}),(0,a.jsxs)(w.Zp,{children:[(0,a.jsx)(w.aR,{className:"pb-3",children:(0,a.jsxs)(w.ZB,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"基本設定"]})}),(0,a.jsxs)(w.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"resolution",children:"解像度"}),(0,a.jsxs)(F.l6,{value:c.resolution,onValueChange:e=>p({resolution:e}),children:[(0,a.jsx)(F.bq,{className:n?"h-10":"",children:(0,a.jsx)(F.yv,{})}),(0,a.jsxs)(F.gC,{children:[(0,a.jsx)(F.eb,{value:"hd",children:"HD (1280\xd7720)"}),(0,a.jsx)(F.eb,{value:"fhd",children:"Full HD (1920\xd71080)"}),(0,a.jsx)(F.eb,{value:"4k",children:"4K (3840\xd72160)"}),(0,a.jsx)(F.eb,{value:"print",children:"印刷用高解像度"}),(0,a.jsx)(F.eb,{value:"custom",children:"カスタム"})]})]})]}),"custom"===c.resolution&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(v.J,{htmlFor:"customWidth",children:"幅 (px)"}),(0,a.jsx)(j.p,{id:"customWidth",type:"number",value:c.customWidth||"",onChange:e=>p({customWidth:parseInt(e.target.value)||void 0}),placeholder:"1920",inputMode:"numeric",className:n?"h-10":""})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(v.J,{htmlFor:"customHeight",children:"高さ (px)"}),(0,a.jsx)(j.p,{id:"customHeight",type:"number",value:c.customHeight||"",onChange:e=>p({customHeight:parseInt(e.target.value)||void 0}),placeholder:"1080",inputMode:"numeric",className:n?"h-10":""})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"quality",children:"品質"}),(0,a.jsxs)(F.l6,{value:c.quality,onValueChange:e=>{let t=Q[e];p({quality:e,pixelRatio:t.pixelRatio})},children:[(0,a.jsx)(F.bq,{className:n?"h-10":"",children:(0,a.jsx)(F.yv,{})}),(0,a.jsx)(F.gC,{children:Object.entries(Q).map(e=>{let[t,s]=e;return(0,a.jsx)(F.eb,{value:t,children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:s.label}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:s.description})]})},t)})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"format",children:"フォーマット"}),(0,a.jsxs)(F.l6,{value:c.format,onValueChange:e=>p({format:e}),children:[(0,a.jsx)(F.bq,{className:n?"h-10":"",children:(0,a.jsx)(F.yv,{})}),(0,a.jsxs)(F.gC,{children:[(0,a.jsx)(F.eb,{value:"png",children:"PNG (透明背景対応)"}),(0,a.jsx)(F.eb,{value:"jpeg",children:"JPEG (軽量)"})]})]})]}),"png"===c.format&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(I.S,{id:"transparency",checked:c.includeTransparency,onCheckedChange:e=>p({includeTransparency:e})}),(0,a.jsx)(v.J,{htmlFor:"transparency",className:"text-sm",children:"透明背景を使用"})]}),!c.includeTransparency&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{htmlFor:"backgroundColor",children:"背景色"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(j.p,{id:"backgroundColor",type:"color",value:c.backgroundColor,onChange:e=>p({backgroundColor:e.target.value}),className:"w-12 h-10 p-1 border rounded"}),(0,a.jsx)(j.p,{value:c.backgroundColor,onChange:e=>p({backgroundColor:e.target.value}),placeholder:"#ffffff",className:(0,y.cn)("flex-1",n?"h-10":"")})]})]})]})]}),c.batchExport&&c.batchSizes.length>0&&(0,a.jsxs)(w.Zp,{children:[(0,a.jsx)(w.aR,{className:"pb-3",children:(0,a.jsxs)(w.ZB,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(U.A,{className:"h-4 w-4"}),"バッチエクスポート"]})}),(0,a.jsx)(w.Wu,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"以下のサイズで一括エクスポートします:"}),(0,a.jsx)("div",{className:"grid gap-1",children:c.batchSizes.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded text-sm",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)(X.E,{variant:"secondary",children:[e.width,"\xd7",e.height]})]},t))})]})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{onClick:f,disabled:s,className:(0,y.cn)("flex-1",n?"h-11":""),children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.A,{className:"mr-2 h-4 w-4 animate-spin"}),"エクスポート中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"エクスポート"]})}),(0,a.jsxs)(r.$,{variant:"outline",onClick:()=>{let e=prompt("プリセット名を入力してください:");if(e){let t={...c,name:e};u(e=>[...e,t]),l.oR.success('プリセット "'.concat(e,'" を保存しました'))}},disabled:s,className:n?"h-11":"",title:"現在の設定をプリセットとして保存",children:[(0,a.jsx)(Y.A,{className:"h-4 w-4"}),n?"":"保存"]})]})]})},et=["image/jpeg","image/jpg","image/png","image/webp"];function es(){let{isOpen:e,setIsOpen:t,isDesktop:b}=(0,h.c)({defaultOpen:!1,desktopDefaultOpen:!0}),[w,y]=i.useState("settings"),[k,C]=i.useState(!1),[z,S]=i.useState(!1),[E,D]=i.useState(!1),[$,F]=i.useState(!1),[I,X]=i.useState(!0),[B,O]=i.useState(!1),[q,H]=i.useState(20),{handleAsyncError:V}=(0,x.u)(),{selectedTemplate:U,setSelectedTemplate:G,currentText:Z,setCurrentText:Y,layers:_,addLayer:K,removeLayer:Q,updateLayer:es,selectedLayerId:ea,setSelectedLayerId:ei,reorderLayers:en,duplicateLayer:el,moveLayerUp:er,moveLayerDown:ec,aspectRatio:eo,customAspectRatio:ed}=(0,N.S)(),em=_.find(e=>e.id===ea),eh=i.useCallback(()=>{let t;return b?(t=E?{width:"min(2000px, 95vw)",maxWidth:"none"}:e?{width:"min(1500px, 75vw)",maxWidth:"none"}:{width:"min(1800px, 90vw)",maxWidth:"none"},console.log("Preview size:",{isDesktop:b,isPreviewDedicatedMode:E,isSidebarOpen:e,size:t}),t):E?{width:"95vw",maxWidth:"none",maxHeight:"80vh"}:{width:"90vw",maxWidth:"none",maxHeight:"40vh"}},[b,E,e]),{zoom:ex,setZoom:eu,undo:ep,redo:eg,canUndo:ef,canRedo:ev,addToHistory:ej,resetHistoryFlag:eN,saveToLocalStorage:eb,loadFromLocalStorage:ew}=(0,T.Y)(_,ea);i.useEffect(()=>{let e=e=>{if("Shift"===e.key&&C(!0),e.ctrlKey||e.metaKey)switch(e.key){case"z":e.preventDefault(),e.shiftKey?eg()&&eN():ep()&&eN();break;case"y":e.preventDefault(),eg()&&eN();break;case"s":e.preventDefault(),eb(_,ea)?l.oR.success("プロジェクトを保存しました"):l.oR.error("保存に失敗しました")}},t=e=>{"Shift"===e.key&&C(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[ep,eg,eN,eb,_,ea]),i.useEffect(()=>{b?t(!0):t(!1)},[b]);let ey=i.useCallback(async(e,t)=>{S(!0);try{await V(async()=>{let a,i,r={width:1920,height:1080};switch(t.resolution){case"hd":r={width:1280,height:720};break;case"fhd":r={width:1920,height:1080};break;case"4k":r={width:3840,height:2160};break;case"print":r={width:2480,height:3508};break;case"custom":t.customWidth&&t.customHeight&&(r={width:t.customWidth,height:t.customHeight})}if("custom"!==eo){let[e,t]=eo.split(":").map(Number);e>0&&t>0&&(r.width=Math.round(r.height*(e/t)))}else if(ed.width>0&&ed.height>0){let e=ed.width/ed.height;r.width=Math.round(r.height*e)}let c={cacheBust:!0,pixelRatio:t.pixelRatio||2,quality:"png"===t.format?1:.9,backgroundColor:t.backgroundColor||(t.includeTransparency?"transparent":"#ffffff"),width:r.width,height:r.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===t.format)a=await (0,n.$E)(e,c),i="asset-".concat(t.optimizeForPlatform,"-").concat(r.width,"x").concat(r.height,".png");else if("jpeg"===t.format){let{toJpeg:n}=await Promise.resolve().then(s.bind(s,82789));a=await n(e,c),i="asset-".concat(t.optimizeForPlatform,"-").concat(r.width,"x").concat(r.height,".jpg")}else a=await (0,n.$E)(e,c),i="asset-".concat(t.optimizeForPlatform,"-").concat(r.width,"x").concat(r.height,".png");let o=document.createElement("a");o.download=i,o.href=a,o.click(),l.oR.success("".concat(i," をエクスポートしました"))},"エクスポートに失敗しました")}finally{S(!1)}},[eo,ed,V]),ek=i.useCallback(async(e,t)=>{S(!0);try{let a=t.batchSizes.map(async a=>{let i,l,r={cacheBust:!0,pixelRatio:t.pixelRatio||2,quality:"png"===t.format?1:.9,backgroundColor:t.backgroundColor||(t.includeTransparency?"transparent":"#ffffff"),width:a.width,height:a.height};if("png"===t.format)i=await (0,n.$E)(e,r),l="asset-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");else if("jpeg"===t.format){let{toJpeg:t}=await Promise.resolve().then(s.bind(s,82789));i=await t(e,r),l="asset-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".jpg")}else i=await (0,n.$E)(e,r),l="asset-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");let c=document.createElement("a");return c.download=l,c.href=i,c.click(),l}),i=await Promise.all(a);l.oR.success("".concat(i.length,"個のファイルをエクスポートしました"))}catch(e){console.error("Batch export failed:",e),l.oR.error("バッチエクスポートに失敗しました")}finally{S(!1)}},[]),eC=i.useCallback(async e=>{let t=document.getElementById("download-target");if(!t)return void l.oR.error("プレビューエリアが見つかりません");try{await ey(t,{resolution:"super"===e?"4k":"high"===e?"fhd":"hd",quality:"high",format:"png",pixelRatio:"super"===e?4:"high"===e?2:1,backgroundColor:"#ffffff",includeTransparency:!1,optimizeForPlatform:"general",batchExport:!1,batchSizes:[]})}catch(e){console.error("Export failed:",e),l.oR.error("エクスポートに失敗しました")}},[ey]),ez=i.useCallback((e,t,s)=>{es(e,{x:s.x,y:s.y}),setTimeout(()=>ej(_,ea),0)},[es,ej,_,ea]),eS=i.useCallback((e,t,s,a,i)=>{es(e,{width:s.offsetWidth,height:s.offsetHeight,x:i.x,y:i.y}),setTimeout(()=>ej(_,ea),0)},[es,ej,_,ea]),eE=e=>{let t=_.filter(e=>"shape"===e.type).length*(b?20:5),s=_.filter(t=>t.shapeType===e).length+1,a="",i=b?550:10,n=b?250:10,l=b?300:50,r=b?300:50,c=b?2:1,o=b?300:100,d=b?5:3;switch(e){case"rectangle":a="四角 ".concat(s);break;case"circle":a="円 ".concat(s);break;case"line":a="線 ".concat(s);break;case"arrow":a="矢印 ".concat(s)}K({type:"shape",shapeType:e,name:a,visible:!0,locked:!1,x:i+t,y:n+t,width:"line"===e||"arrow"===e?o:l,height:"line"===e||"arrow"===e?d:r,backgroundColor:"#cccccc",borderColor:"#000000",borderWidth:c}),setTimeout(()=>ej(_,ea),0)},eR=i.useCallback(()=>{eb(_,ea)?l.oR.success("プロジェクトを保存しました"):l.oR.error("保存に失敗しました")},[eb,_,ea]),eD=i.useCallback(()=>{ep()&&(eN(),l.oR.success("操作を元に戻しました"))},[ep,eN]),e$=i.useCallback(()=>{eg()&&(eN(),l.oR.success("操作をやり直しました"))},[eg,eN]);if(!U)return(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("p",{children:"テンプレートを読み込み中..."})});let eM=()=>{var e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本情報"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"レイヤー名"}),(0,a.jsx)(j.p,{value:(null==em?void 0:em.name)||"",onChange:e=>em&&es(em.id,{name:e.target.value}),className:"mt-1",placeholder:"レイヤー名を入力",disabled:!em})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"X座標"}),(0,a.jsx)(j.p,{type:"number",value:(null==em?void 0:em.x)||0,onChange:e=>em&&es(em.id,{x:Number(e.target.value)}),className:"mt-1",disabled:!em})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"Y座標"}),(0,a.jsx)(j.p,{type:"number",value:(null==em?void 0:em.y)||0,onChange:e=>em&&es(em.id,{y:Number(e.target.value)}),className:"mt-1",disabled:!em})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"幅"}),(0,a.jsx)(j.p,{type:"number",value:(null==em?void 0:em.width)||0,onChange:e=>em&&es(em.id,{width:Number(e.target.value)}),className:"mt-1",disabled:!em})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"高さ"}),(0,a.jsx)(j.p,{type:"number",value:(null==em?void 0:em.height)||0,onChange:e=>em&&es(em.id,{height:Number(e.target.value)}),className:"mt-1",disabled:!em})]})]})]})]}),(null==em?void 0:em.type)==="text"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"テキスト"}),(0,a.jsx)(g.T,{value:em.text||"",onChange:e=>es(em.id,{text:e.target.value}),className:"mt-1 min-h-[80px] resize-none",placeholder:"テキストを入力してください"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"フォントサイズ"}),(0,a.jsx)(f.A,{value:[parseFloat((null==(e=em.fontSize)?void 0:e.replace("rem",""))||"2")],onValueChange:e=>{let[t]=e;return es(em.id,{fontSize:"".concat(t,"rem")})},min:.5,max:8,step:.1,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center mt-1",children:em.fontSize||"2rem"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:em.color||"#ffffff",onChange:e=>es(em.id,{color:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:em.color||"#ffffff",onChange:e=>es(em.id,{color:e.target.value}),className:"flex-1"})]})]})]})]})]}),(null==em?void 0:em.type)==="image"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"画像設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"画像を変更"}),(0,a.jsx)(j.p,{type:"file",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){let e=URL.createObjectURL(s);es(em.id,{src:e})}},className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"不透明度"}),(0,a.jsx)(f.A,{value:[em.opacity||100],onValueChange:e=>{let[t]=e;return es(em.id,{opacity:t})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[em.opacity||100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"回転角度"}),(0,a.jsx)(f.A,{value:[em.rotation||0],onValueChange:e=>{let[t]=e;return es(em.id,{rotation:t})},min:-180,max:180,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[em.rotation||0,"\xb0"]})]})]})]}),(null==em?void 0:em.type)==="shape"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"図形設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"図形の種類"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,a.jsx)(r.$,{variant:"rectangle"===em.shapeType?"default":"outline",onClick:()=>es(em.id,{shapeType:"rectangle"}),size:"sm",children:"四角形"}),(0,a.jsx)(r.$,{variant:"circle"===em.shapeType?"default":"outline",onClick:()=>es(em.id,{shapeType:"circle"}),size:"sm",children:"円"}),(0,a.jsx)(r.$,{variant:"line"===em.shapeType?"default":"outline",onClick:()=>es(em.id,{shapeType:"line"}),size:"sm",children:"線"}),(0,a.jsx)(r.$,{variant:"arrow"===em.shapeType?"default":"outline",onClick:()=>es(em.id,{shapeType:"arrow"}),size:"sm",children:"矢印"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"塗りつぶし色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:em.backgroundColor||"#000000",onChange:e=>es(em.id,{backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:em.backgroundColor||"#000000",onChange:e=>es(em.id,{backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"境界線色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:em.borderColor||"#000000",onChange:e=>es(em.id,{borderColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:em.borderColor||"#000000",onChange:e=>es(em.id,{borderColor:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"境界線の太さ"}),(0,a.jsx)(f.A,{value:[em.borderWidth||0],onValueChange:e=>{let[t]=e;return es(em.id,{borderWidth:t})},min:0,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[em.borderWidth||0,"px"]})]})]})]}),!em&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"レイヤーを選択してください"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"レイヤーパネルからレイヤーを選択すると、ここで詳細設定ができます"})]})]})},eJ=(0,a.jsxs)(p.tU,{value:w,onValueChange:y,className:"w-full",children:[(0,a.jsxs)(p.j7,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(p.Xi,{value:"settings",children:"テンプレート"}),(0,a.jsx)(p.Xi,{value:"tools",children:"ツール"}),(0,a.jsx)(p.Xi,{value:"layers",children:"レイヤー"}),(0,a.jsx)(p.Xi,{value:"export",children:"エクスポート"})]}),(0,a.jsx)(p.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(R,{onSelectTemplate:G,selectedTemplateId:U.id})}),(0,a.jsx)(p.av,{value:"tools",className:"mt-4",children:eM()}),(0,a.jsx)(p.av,{value:"layers",className:"mt-4",children:(0,a.jsx)(L.G,{context:{layers:_,updateLayer:es,removeLayer:Q,selectedLayerId:ea,setSelectedLayerId:ei,reorderLayers:en,duplicateLayer:el,addLayer:K,moveLayerUp:er,moveLayerDown:ec},onShapeSelect:e=>eE(e),showShapeSelector:!0})}),(0,a.jsx)(p.av,{value:"export",className:"mt-4",children:(0,a.jsx)(ee,{onExport:(e,t)=>t.batchExport&&t.batchSizes.length>0?ek(e,t):ey(e,t),isExporting:z})})]}),eA=(0,a.jsxs)(p.tU,{value:w,onValueChange:y,className:"w-full",children:[(0,a.jsxs)(p.j7,{className:"grid w-full grid-cols-2 h-12",children:[(0,a.jsx)(p.Xi,{value:"settings",className:"text-xs",children:"テンプレート"}),(0,a.jsx)(p.Xi,{value:"export",className:"text-xs",children:"エクスポート"})]}),(0,a.jsx)(p.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(R,{onSelectTemplate:G,selectedTemplateId:U.id})}),(0,a.jsx)(p.av,{value:"export",className:"mt-4",children:(0,a.jsx)(ee,{onExport:(e,t)=>t.batchExport&&t.batchSizes.length>0?ek(e,t):ey(e,t),isExporting:z})})]});return(0,a.jsxs)("div",{className:"relative flex flex-col lg:h-screen",children:[e&&!b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>t(!1)}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row flex-grow lg:h-full",children:[(0,a.jsxs)("main",{className:"flex-1 flex flex-col lg:h-full p-2 pt-16 lg:p-4 lg:pt-4",children:[(0,a.jsx)("div",{className:"".concat(b?"flex-1 flex flex-col min-h-[600px] lg:min-h-0":"flex-shrink-0"),children:(0,a.jsxs)(a.Fragment,{children:[b&&(0,a.jsx)(W.M,{zoom:ex,setZoom:eu,onUndo:eD,onRedo:e$,onSave:eR,onDownload:eC,canUndo:ef,canRedo:ev,isPreviewDedicatedMode:E,onTogglePreviewMode:()=>D(!E)}),!b&&E&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-20",children:(0,a.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>D(!1),className:"bg-background/90 backdrop-blur-sm shadow-lg",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"通常表示に戻る"]})}),(0,a.jsx)("div",{className:"".concat(b?"flex-1 overflow-auto bg-gray-100 dark:bg-gray-900 relative":"flex-shrink-0 bg-gray-100 dark:bg-gray-900 relative max-h-[50vh] overflow-auto"),children:(0,a.jsx)("div",{className:"".concat(b?"flex items-center justify-center h-full p-4 lg:p-8":"flex items-center justify-center p-4"),children:(0,a.jsx)(P.Z,{zoom:ex,onZoomReset:()=>eu(1),className:"w-full",aspectRatio:eo,customAspectRatio:ed,showGrid:$,setShowGrid:F,showAspectGuide:I,setShowAspectGuide:X,showSafeArea:B,setShowSafeArea:O,gridSize:q,setGridSize:H,children:(0,a.jsx)("div",{id:"thumbnail-preview",style:{aspectRatio:"custom"===eo?"".concat(ed.width," / ").concat(ed.height):eo.replace(":"," / "),...eh()},className:"bg-card relative border rounded-md shadow-lg",children:(0,a.jsx)("div",{id:"download-target",className:"w-full h-full relative overflow-hidden",children:_.map(e=>{let t=e.id===ea,s=t&&!e.locked,i=t&&!e.locked;return e.visible?"image"===e.type?(0,a.jsx)(J,{id:e.id,isSelected:t,src:e.src||"",alt:e.name,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,onDragStop:(t,s)=>ez(e.id,t,s),onResize:(t,s,a,i,n)=>eS(e.id,s,a,i,n),onResizeStop:(t,s,a,i,n)=>eS(e.id,s,a,i,n),lockAspectRatio:k,enableResizing:i,disableDragging:!s,onSelect:()=>ei(e.id),isLocked:e.locked,isDraggable:s,onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},isBackground:e.isBackground,zIndex:e.zIndex},e.id):"text"===e.type?(0,a.jsx)(M,{id:e.id,isSelected:t,text:e.text||"",color:e.color||"#000000",fontSize:e.fontSize||"1rem",x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,onDragStop:(t,s)=>ez(e.id,t,s),onResizeStop:(t,s,a,i,n)=>eS(e.id,s,a,i,n),enableResizing:i,disableDragging:!s,zIndex:e.zIndex},e.id):"shape"===e.type&&e.shapeType?(0,a.jsx)(A,{id:e.id,isSelected:t,shapeType:e.shapeType,backgroundColor:e.backgroundColor||"#cccccc",borderColor:e.borderColor||"#000000",borderWidth:e.borderWidth||0,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,onDragStop:(t,s)=>ez(e.id,t,s),onResize:(t,s,a,i,n)=>eS(e.id,s,a,i,n),onResizeStop:(t,s,a,i,n)=>eS(e.id,s,a,i,n),lockAspectRatio:k,enableResizing:i,disableDragging:!s,zIndex:e.zIndex},e.id):null:null})})})})})})]})}),!b&&!E&&(0,a.jsxs)("div",{className:"border-t bg-background/95 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"\uD83D\uDCA1 ヒント: 「ツール設定」でレイヤーの詳細編集、「レイヤー管理」でレイヤーの並び替えができます。テンプレートやエクスポートはサイドバーからアクセスできます。"})}),(0,a.jsxs)("div",{className:"p-2 lg:p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"クイックアクセス"}),(0,a.jsx)(p.tU,{value:w,onValueChange:y,className:"w-full",children:(0,a.jsxs)(p.j7,{className:"w-full h-12 items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground",children:[(0,a.jsx)(p.Xi,{value:"tools",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"ツール設定"}),(0,a.jsx)(p.Xi,{value:"layers",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー管理"}),(0,a.jsx)(p.Xi,{value:"edit",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー編集"}),(0,a.jsx)(p.Xi,{value:"preview",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"プレビュー"})]})})]}),"tools"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"ツール設定"}),eM()]}),"layers"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー管理"}),(0,a.jsx)(L.G,{context:{layers:_,updateLayer:es,removeLayer:Q,selectedLayerId:ea,setSelectedLayerId:ei,reorderLayers:en,duplicateLayer:el,addLayer:K,moveLayerUp:er,moveLayerDown:ec},onShapeSelect:e=>eE(e),showShapeSelector:!0})]}),"edit"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー編集"}),em?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-2 bg-secondary/50 rounded-md",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"選択中"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:em.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCD0 位置"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.x&&es(em.id,{x:em.x-10})},className:"h-7 w-7 p-0",children:"←"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"X"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:"number"==typeof em.x?Math.round(em.x):0,onChange:e=>es(em.id,{x:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.x&&es(em.id,{x:em.x+10})},className:"h-7 w-7 p-0",children:"→"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.y&&es(em.id,{y:em.y-10})},className:"h-7 w-7 p-0",children:"↑"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"Y"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:"number"==typeof em.y?Math.round(em.y):0,onChange:e=>es(em.id,{y:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.y&&es(em.id,{y:em.y+10})},className:"h-7 w-7 p-0",children:"↓"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCCF サイズ"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.width&&es(em.id,{width:Math.max(10,em.width-20)})},className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"幅"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:"number"==typeof em.width?Math.round(em.width):0,onChange:e=>es(em.id,{width:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.width&&es(em.id,{width:em.width+20})},className:"h-7 w-7 p-0",children:"+"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.height&&es(em.id,{height:Math.max(10,em.height-20)})},className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"高さ"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:"number"==typeof em.height?Math.round(em.height):0,onChange:e=>es(em.id,{height:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{"number"==typeof em.height&&es(em.id,{height:em.height+20})},className:"h-7 w-7 p-0",children:"+"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDD04 回転"}),(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>es(em.id,{rotation:(em.rotation||0)-15}),className:"h-7 w-7 p-0",title:"反時計回り 15\xb0",children:"↺"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>es(em.id,{rotation:(em.rotation||0)-5}),className:"h-7 w-7 p-0",title:"反時計回り 5\xb0",children:"↶"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(em.rotation||0),onChange:e=>es(em.id,{rotation:Number(e.target.value)}),className:"h-7 text-xs text-center",placeholder:"角度"})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>es(em.id,{rotation:(em.rotation||0)+5}),className:"h-7 w-7 p-0",title:"時計回り 5\xb0",children:"↷"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>es(em.id,{rotation:(em.rotation||0)+15}),className:"h-7 w-7 p-0",title:"時計回り 15\xb0",children:"↻"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>es(em.id,{rotation:0}),className:"h-7 px-2 text-xs",children:"0\xb0"})]})]}),"text"===em.type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"✏️ テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.T,{value:em.text||"",onChange:e=>es(em.id,{text:e.target.value}),className:"text-xs min-h-[60px] resize-none",placeholder:"テキストを入力"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground w-8",children:"色"}),(0,a.jsx)("input",{type:"color",value:em.color||"#000000",onChange:e=>es(em.id,{color:e.target.value}),className:"w-8 h-7 rounded border"}),(0,a.jsx)(j.p,{value:em.color||"#000000",onChange:e=>es(em.id,{color:e.target.value}),className:"h-7 text-xs flex-1",placeholder:"#000000"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=Math.max(.5,parseFloat(em.fontSize||"1rem")-.25);es(em.id,{fontSize:"".concat(e,"rem")})},className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"サイズ"}),(0,a.jsx)(j.p,{value:em.fontSize||"1rem",onChange:e=>es(em.id,{fontSize:e.target.value}),className:"h-7 text-xs",placeholder:"1rem"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=parseFloat(em.fontSize||"1rem");es(em.id,{fontSize:"".concat(e+.25,"rem")})},className:"h-7 w-7 p-0",children:"+"})]})]})]})]})]}):(0,a.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:(0,a.jsx)("p",{className:"text-xs",children:"レイヤーを選択してください"})})]}),"preview"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDD0D ズーム"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eu(Math.max(.25,ex-.25)),className:"h-8 w-8 p-0",disabled:ex<=.25,children:"−"}),(0,a.jsx)("div",{className:"flex-1 text-center",children:(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(100*ex),"%"]})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eu(Math.min(4,ex+.25)),className:"h-8 w-8 p-0",disabled:ex>=4,children:"+"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eu(1),className:"w-full h-8",children:"リセット (100%)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCCA プレビュー情報"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"アスペクト比:"}),(0,a.jsx)("span",{className:"font-medium",children:"custom"===eo?"".concat(ed.width,":").concat(ed.height):eo||"16:9"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"ズーム率:"}),(0,a.jsxs)("span",{className:"font-medium",children:[Math.round(100*ex),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"グリッド:"}),(0,a.jsx)("span",{className:"font-medium",children:"40px"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"⚙️ プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"グリッド表示"}),(0,a.jsx)(r.$,{size:"sm",variant:$?"default":"outline",onClick:()=>F(!$),className:"h-6 px-2 text-xs",children:$?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"アスペクト比ガイド"}),(0,a.jsx)(r.$,{size:"sm",variant:I?"default":"outline",onClick:()=>X(!I),className:"h-6 px-2 text-xs",children:I?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"セーフエリア"}),(0,a.jsx)(r.$,{size:"sm",variant:B?"default":"outline",onClick:()=>O(!B),className:"h-6 px-2 text-xs",children:B?"ON":"OFF"})]}),$&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"グリッドサイズ"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:10===q?"default":"outline",onClick:()=>H(10),className:"h-6 px-2 text-xs flex-1",children:"10px"}),(0,a.jsx)(r.$,{size:"sm",variant:20===q?"default":"outline",onClick:()=>H(20),className:"h-6 px-2 text-xs flex-1",children:"20px"}),(0,a.jsx)(r.$,{size:"sm",variant:40===q?"default":"outline",onClick:()=>H(40),className:"h-6 px-2 text-xs flex-1",children:"40px"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCFA 表示モード"}),(0,a.jsx)(r.$,{size:"sm",variant:E?"default":"outline",onClick:()=>D(!E),className:"w-full h-8",children:E?"通常表示に戻る":"フルスクリーン表示"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCBE 保存・出力"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:eR,className:"h-8",children:"保存"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eC("high"),className:"h-8",children:"ダウンロード"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"レイヤーを追加"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{K({type:"text",name:"テキスト ".concat(_.filter(e=>"text"===e.type).length+1),visible:!0,locked:!1,x:b?550:50,y:b?250:50,width:b?300:150,height:b?100:50,text:Z,color:"#000000",fontSize:b?"2rem":"1rem"}),setTimeout(()=>ej(_,ea),0)},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"T"}),(0,a.jsx)("span",{children:"テキスト"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("image-upload"))?void 0:e.click()},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDDBC️"}),(0,a.jsx)("span",{children:"画像"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eE("rectangle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⬜"}),(0,a.jsx)("span",{children:"四角"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eE("circle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⭕"}),(0,a.jsx)("span",{children:"円"})]})]}),(0,a.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{let t=e.target.files;if(t){for(let e of Array.from(t)){if(e.size>0xa00000){l.oR.error("ファイルサイズが大きすぎます: ".concat(e.name),{description:"10MB以下のファイルを選択してください。"});continue}if(!et.includes(e.type)){l.oR.error("ファイル形式が無効です: ".concat(e.name),{description:"JPEG, PNG, WEBP形式の画像ファイルを選択してください。"});continue}let t=URL.createObjectURL(e);K({type:"image",name:e.name,visible:!0,locked:!1,x:b?550:50,y:b?250:50,width:b?300:150,height:b?300:150,src:t})}e.target.value=""}},className:"hidden",multiple:!0})]})]})]})]}),!e&&(0,a.jsx)(u.R,{onOpen:()=>t(!0),isDesktop:b,tabs:[{id:"settings",label:"テンプレート",icon:(0,a.jsx)(o.A,{className:"h-4 w-4"})},{id:"tools",label:"ツール",icon:(0,a.jsx)(d.A,{className:"h-4 w-4"})},{id:"layers",label:"レイヤー",icon:(0,a.jsx)(m.A,{className:"h-4 w-4"})}],onTabClick:e=>{console.log("Tab clicked:",e)}}),!E&&(0,a.jsx)(u.B,{isOpen:e,onClose:()=>t(!1),title:"",isDesktop:b,className:"".concat(b?"lg:w-96":"w-full max-w-sm"),children:b?eJ:eA})]})]})}function ea(){return(0,a.jsx)(N.U,{children:(0,a.jsx)(es,{})})}},80318:(e,t,s)=>{Promise.resolve().then(s.bind(s,45113))}},e=>{e.O(0,[96,76,358],()=>e(e.s=80318)),_N_E=e.O()}]);