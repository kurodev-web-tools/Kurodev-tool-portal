(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{45963:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>to});var a=s(18841),l=s(58669),i=s(89863),r=s(78071),n=s(28198),c=s(34691),o=s(64248),d=s(78541),x=s(86930),m=s(80889),h=s(59172),u=s(84885),p=s(23473),g=s(6166),j=s(44166),f=s(30897),v=s(7934),y=s(49907),b=s(33544),N=s(61197),w=s(98356),A=s(77902),S=s(2570),C=s(53333),k=s(23254),F=s(98156),L=s(14967),R=s(58935),E=s(22215),T=s(83190),z=s(79706),I=s(43210),D=s(38479),M=s(28775),J=s(42542),O=s(23718),P=s(77463),q=s(65939),B=s(24156);let G=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:320,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:180,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;return new Promise((l,i)=>{let r=new Image;r.crossOrigin="anonymous",r.onload=()=>{let e=document.createElement("canvas"),n=e.getContext("2d");if(!n)return void i(Error("Canvas context not available"));let{width:c,height:o}=r;c>o?c>t&&(o=o*t/c,c=t):o>s&&(c=c*s/o,o=s),e.width=c,e.height=o,n.drawImage(r,0,0,c,o),l(e.toDataURL("image/jpeg",a))},r.onerror=()=>{i(Error("Failed to load image"))},r.src=e})},$=async e=>{try{return await G(e,320,180,.7)}catch(t){return B.vF.error("プレビュー生成失敗",t,"imageUtils"),e}};var U=s(10768),W=s(40987),V=s(64613),H=s(87570),Z=s(20579),X=s(17167),K=s(1683),Y=s(75359),_=s(83239);class Q{static async generatePreview(e){let t=document.createElement("canvas"),s=t.getContext("2d");if(!s)throw Error("Canvas context not available");for(let a of(t.width=200,t.height=150,this.drawBackground(s,e.layout.background,200,150),e.layout.objects))this.drawObject(s,a,e,200,150);return t.toDataURL("image/png")}static drawBackground(e,t,s,a){if("color"===t.type)e.fillStyle=t.value,e.fillRect(0,0,s,a);else if("gradient"===t.type){let l=e.createLinearGradient(0,0,s,a);l.addColorStop(0,t.value.start),l.addColorStop(1,t.value.end),e.fillStyle=l,e.fillRect(0,0,s,a)}}static drawObject(e,t,s,a,l){let i=a/1e3,r=l/750,n=t.position.x*i,c=t.position.y*r,o=t.position.width*i,d=t.position.height*r;e.save(),e.translate(n+o/2,c+d/2),e.rotate((t.position.rotation||0)*Math.PI/180),"text"===t.type&&t.content?this.drawText(e,t.content,s,o,d):"shape"===t.type&&t.content?this.drawShape(e,t.content,o,d):"image"===t.type&&t.content&&this.drawImagePlaceholder(e,o,d),e.restore()}static drawText(e,t,s,a,l){e.fillStyle=t.color||s.colorPalette.text,e.font="".concat(t.fontSize||s.fontSettings.size," ").concat(t.fontFamily||s.fontSettings.family),e.textAlign="center",e.textBaseline="middle";let i=t.text||"テキスト";e.fillText(i,0,0)}static drawShape(e,t,s,a){e.fillStyle=t.backgroundColor||"#cccccc",e.strokeStyle=t.borderColor||"#000000",e.lineWidth=t.borderWidth||2;let l=s/2,i=a/2;switch(t.shapeType){case"rectangle":default:e.fillRect(-l,-i,s,a),e.strokeRect(-l,-i,s,a);break;case"circle":e.beginPath(),e.arc(0,0,Math.min(l,i),0,2*Math.PI),e.fill(),e.stroke();break;case"triangle":e.beginPath(),e.moveTo(0,-i),e.lineTo(-l,i),e.lineTo(l,i),e.closePath(),e.fill(),e.stroke();break;case"star":this.drawStar(e,0,0,Math.min(l,i),5);break;case"heart":this.drawHeart(e,0,0,Math.min(l,i));break;case"diamond":e.beginPath(),e.moveTo(0,-i),e.lineTo(l,0),e.lineTo(0,i),e.lineTo(-l,0),e.closePath(),e.fill(),e.stroke()}}static drawStar(e,t,s,a,l){let i=.5*a;e.beginPath();for(let r=0;r<2*l;r++){let n=r*Math.PI/l,c=r%2==0?a:i,o=t+Math.cos(n)*c,d=s+Math.sin(n)*c;0===r?e.moveTo(o,d):e.lineTo(o,d)}e.closePath(),e.fill(),e.stroke()}static drawHeart(e,t,s,a){let l=a/20;e.beginPath(),e.moveTo(t,s+5*l),e.bezierCurveTo(t,s,t-5*l,s,t-5*l,s+5*l),e.bezierCurveTo(t-5*l,s+10*l,t,s+10*l,t,s+15*l),e.bezierCurveTo(t,s+10*l,t+5*l,s+10*l,t+5*l,s+5*l),e.bezierCurveTo(t+5*l,s,t,s,t,s+5*l),e.fill(),e.stroke()}static drawImagePlaceholder(e,t,s){e.fillStyle="#f0f0f0",e.fillRect(-t/2,-s/2,t,s),e.strokeStyle="#cccccc",e.lineWidth=1,e.strokeRect(-t/2,-s/2,t,s),e.fillStyle="#999999",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("\uD83D\uDCF7",0,0)}}let ee=e=>{let{onSubmit:t}=e,[s,i]=(0,l.useState)({name:"",description:"",category:"custom",style:"simple",difficulty:"beginner",tags:""});return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({...s,metadata:{version:"1.0.0",author:"User",tags:s.tags.split(",").map(e=>e.trim()).filter(Boolean),difficulty:s.difficulty,estimatedTime:5,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}}})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"name",children:"テンプレート名"}),(0,a.jsx)(A.p,{id:"name",value:s.name,onChange:e=>i({...s,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"category",children:"カテゴリ"}),(0,a.jsxs)(S.l6,{value:s.category,onValueChange:e=>i({...s,category:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(S.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(S.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"description",children:"説明"}),(0,a.jsx)(b.T,{id:"description",value:s.description,onChange:e=>i({...s,description:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"style",children:"スタイル"}),(0,a.jsxs)(S.l6,{value:s.style,onValueChange:e=>i({...s,style:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(S.eb,{value:"cool",children:"クール"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(S.eb,{value:"simple",children:"シンプル"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"difficulty",children:"難易度"}),(0,a.jsxs)(S.l6,{value:s.difficulty,onValueChange:e=>i({...s,difficulty:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(S.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(S.eb,{value:"advanced",children:"上級"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"tags",children:"タグ（カンマ区切り）"}),(0,a.jsx)(A.p,{id:"tags",value:s.tags,onChange:e=>i({...s,tags:e.target.value}),placeholder:"例: ゲーム, アクション, 面白い"})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2",children:(0,a.jsx)(n.$,{type:"submit",children:"作成"})})]})},et=e=>{let{template:t,onSubmit:s}=e,[i,r]=(0,l.useState)({name:t.name,description:t.description,category:t.category,style:t.style,difficulty:t.metadata.difficulty,tags:t.metadata.tags.join(", ")});return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s({...t,...i,metadata:{...t.metadata,tags:i.tags.split(",").map(e=>e.trim()).filter(Boolean),difficulty:i.difficulty,lastModified:new Date().toISOString()}})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-name",children:"テンプレート名"}),(0,a.jsx)(A.p,{id:"edit-name",value:i.name,onChange:e=>r({...i,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-category",children:"カテゴリ"}),(0,a.jsxs)(S.l6,{value:i.category,onValueChange:e=>r({...i,category:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(S.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(S.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-description",children:"説明"}),(0,a.jsx)(b.T,{id:"edit-description",value:i.description,onChange:e=>r({...i,description:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-style",children:"スタイル"}),(0,a.jsxs)(S.l6,{value:i.style,onValueChange:e=>r({...i,style:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(S.eb,{value:"cool",children:"クール"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(S.eb,{value:"simple",children:"シンプル"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-difficulty",children:"難易度"}),(0,a.jsxs)(S.l6,{value:i.difficulty,onValueChange:e=>r({...i,difficulty:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(S.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(S.eb,{value:"advanced",children:"上級"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"edit-tags",children:"タグ（カンマ区切り）"}),(0,a.jsx)(A.p,{id:"edit-tags",value:i.tags,onChange:e=>r({...i,tags:e.target.value}),placeholder:"例: ゲーム, アクション, 面白い"})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2",children:(0,a.jsx)(n.$,{type:"submit",children:"更新"})})]})},es=e=>{let{templates:t,onTemplatesChange:s,onSelectTemplate:r}=e,{createTemplateFromCurrentLayers:c,layers:o}=(0,i.S)(),d=(e=>{let{templates:t,onTemplatesChange:s,layers:a,createTemplateFromCurrentLayers:i}=e,[r,n]=(0,l.useState)(!1),[c,o]=(0,l.useState)(!1),[d,x]=(0,l.useState)(null),[m,h]=(0,l.useState)(""),[u,p]=(0,l.useState)("all"),[g,j]=(0,l.useState)("all"),f=(0,l.useMemo)(()=>t.filter(e=>{let t=e.name.toLowerCase().includes(m.toLowerCase())||(e.description||"").toLowerCase().includes(m.toLowerCase())||e.metadata.tags.some(e=>e.toLowerCase().includes(m.toLowerCase())),s="all"===u||e.category===u,a="all"===g||e.metadata.difficulty===g;return t&&s&&a}),[t,m,u,g]),v=(0,l.useCallback)(async e=>{if(0===a.length)return void q.oR.error("テンプレート作成不可",{description:"テンプレートを作成するには、まずプレビューエリアにオブジェクトを配置してください。"});let l=i(e);try{let e=await Q.generatePreview(l);l.preview=e}catch(e){B.vF.warn("プレビュー画像生成失敗",{error:e},"TemplateManager")}s([...t,l]),n(!1)},[a,i,s,t]),y=(0,l.useCallback)(e=>{x(e),o(!0)},[]),b=(0,l.useCallback)(e=>{s(t.map(t=>t.id===e.id?e:t)),o(!1),x(null)},[t,s]),N=(0,l.useCallback)(e=>{confirm("このテンプレートを削除しますか？")&&s(t.filter(t=>t.id!==e))},[t,s]),w=(0,l.useCallback)(e=>{s([...t,{...e,id:"template-".concat(Date.now()),name:"".concat(e.name,"のコピー"),metadata:{...e.metadata,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},isCustom:!0,createdAt:new Date().toISOString()}])},[t,s]);return{isCreateDialogOpen:r,setIsCreateDialogOpen:n,isEditDialogOpen:c,setIsEditDialogOpen:o,editingTemplate:d,setEditingTemplate:x,searchQuery:m,setSearchQuery:h,selectedCategory:u,setSelectedCategory:p,selectedDifficulty:g,setSelectedDifficulty:j,filteredTemplates:f,handleCreateTemplate:v,handleEditTemplate:y,handleUpdateTemplate:b,handleDeleteTemplate:N,handleDuplicateTemplate:w,handleExportTemplate:(0,l.useCallback)(e=>{let t="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),s="".concat(e.name.replace(/\s+/g,"_"),".json"),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",s),a.click()},[]),handleImportTemplate:(0,l.useCallback)(e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];if(!l)return;let i=new FileReader;i.onload=e=>{try{var a;let l=JSON.parse(null==(a=e.target)?void 0:a.result);l.id="template-".concat(Date.now()),l.isCustom=!0,l.createdAt=new Date().toISOString(),l.metadata.lastModified=new Date().toISOString(),s([...t,l])}catch(e){q.oR.error("テンプレート読み込み失敗",{description:"テンプレートファイルの読み込みに失敗しました。"})}},i.readAsText(l),e.target.value=""},[t,s])}})({templates:t,onTemplatesChange:s,layers:o,createTemplateFromCurrentLayers:c});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold whitespace-nowrap",children:"テンプレート管理"}),(0,a.jsx)("p",{className:"text-muted-foreground whitespace-nowrap",children:"カスタムテンプレートの作成、編集、管理を行います"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("import-template"))?void 0:e.click()},children:[(0,a.jsx)(Z.A,{className:"h-4 w-4 mr-2"}),"インポート"]}),(0,a.jsx)("input",{id:"import-template",type:"file",accept:".json",onChange:d.handleImportTemplate,className:"hidden"}),(0,a.jsxs)(H.lG,{open:d.isCreateDialogOpen,onOpenChange:d.setIsCreateDialogOpen,children:[(0,a.jsx)(H.zM,{asChild:!0,children:(0,a.jsxs)(n.$,{size:"sm",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 mr-2"}),"新規作成"]})}),(0,a.jsxs)(H.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"新しいテンプレートを作成"}),(0,a.jsxs)(H.rr,{children:["プレビューエリアのオブジェクトからテンプレートを作成します（",o.length,"個のオブジェクトが配置されています）"]})]}),(0,a.jsx)(ee,{onSubmit:d.handleCreateTemplate})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,a.jsx)(A.p,{placeholder:"テンプレートを検索...",value:d.searchQuery,onChange:e=>d.setSearchQuery(e.target.value)})}),(0,a.jsxs)(S.l6,{value:d.selectedCategory,onValueChange:d.setSelectedCategory,children:[(0,a.jsx)(S.bq,{className:"w-[150px]",children:(0,a.jsx)(S.yv,{placeholder:"カテゴリ"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"すべて"}),(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(S.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(S.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]}),(0,a.jsxs)(S.l6,{value:d.selectedDifficulty,onValueChange:d.setSelectedDifficulty,children:[(0,a.jsx)(S.bq,{className:"w-[150px]",children:(0,a.jsx)(S.yv,{placeholder:"難易度"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"すべて"}),(0,a.jsx)(S.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(S.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(S.eb,{value:"advanced",children:"上級"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.filteredTemplates.map(e=>(0,a.jsxs)(F.Zp,{className:"relative",children:[(0,a.jsxs)(F.aR,{className:"pb-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("div",{className:"flex gap-1",children:(0,a.jsxs)(_.Bc,{children:[(0,a.jsxs)(_.m_,{children:[(0,a.jsx)(_.k$,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>r(e),className:"h-7 w-7 p-0",children:(0,a.jsx)(X.A,{className:"h-3 w-3"})})}),(0,a.jsx)(_.ZI,{children:(0,a.jsx)("p",{children:"プレビュー"})})]}),(0,a.jsxs)(_.m_,{children:[(0,a.jsx)(_.k$,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>d.handleEditTemplate(e),className:"h-7 w-7 p-0",children:(0,a.jsx)(K.A,{className:"h-3 w-3"})})}),(0,a.jsx)(_.ZI,{children:(0,a.jsx)("p",{children:"編集"})})]}),(0,a.jsxs)(_.m_,{children:[(0,a.jsx)(_.k$,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>d.handleDeleteTemplate(e.id),className:"h-7 w-7 p-0 text-destructive hover:text-destructive",children:(0,a.jsx)(Y.A,{className:"h-3 w-3"})})}),(0,a.jsx)(_.ZI,{children:(0,a.jsx)("p",{children:"削除"})})]})]})})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)(F.ZB,{className:"text-lg truncate",children:e.name}),(0,a.jsx)(F.BT,{className:"mt-1 line-clamp-2",children:e.description}),e.preview&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.preview,alt:"".concat(e.name,"のプレビュー"),className:"w-full h-16 object-cover rounded border"})})]})]}),(0,a.jsx)(F.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(L.E,{variant:"secondary",className:"".concat("gaming"===e.category?"bg-blue-100 text-blue-800 border-blue-200":"talk"===e.category?"bg-green-100 text-green-800 border-green-200":"singing"===e.category?"bg-purple-100 text-purple-800 border-purple-200":"collaboration"===e.category?"bg-orange-100 text-orange-800 border-orange-200":"event"===e.category?"bg-pink-100 text-pink-800 border-pink-200":"bg-[#2D2D2D] text-[#E0E0E0] border-[#4A4A4A]"),children:e.category}),(0,a.jsx)(L.E,{variant:"outline",children:e.style}),(0,a.jsx)(L.E,{variant:"outline",children:e.metadata.difficulty})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[e.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[e.layout.objects.length,"オブジェクト"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>d.handleDuplicateTemplate(e),className:"flex-1 text-xs",children:"複製"}),(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>d.handleExportTemplate(e),className:"flex-1 text-xs",children:[(0,a.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"出力"]})]})]})})]},e.id))}),(0,a.jsx)(H.lG,{open:d.isEditDialogOpen,onOpenChange:d.setIsEditDialogOpen,children:(0,a.jsxs)(H.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"テンプレートを編集"}),(0,a.jsx)(H.rr,{children:"テンプレートの情報を編集できます"})]}),d.editingTemplate&&(0,a.jsx)(et,{template:d.editingTemplate,onSubmit:d.handleUpdateTemplate})]})})]})};var ea=s(84731),el=s(66391),ei=s(91530),er=s(5403),en=s(78561),ec=s(21645),eo=s(42005),ed=s(79678),ex=s(19463);class em{validateConfig(){let{target:e,parameters:t,constraints:s}=this.config;return!(t.objectCount.min>t.objectCount.max)&&!(t.objectCount.preferred<t.objectCount.min)&&!(t.objectCount.preferred>t.objectCount.max)&&!(s.minObjectSize>s.maxObjectSize)}generateId(){return"auto-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}generateName(e,t){let s={cute:["可愛い","キュート","チャーミング"],cool:["クール","スタイリッシュ","モダン"],elegant:["エレガント","上品","洗練された"],funny:["面白い","ユーモラス","楽しい"],simple:["シンプル","ミニマル","クリーン"]},a={gaming:["ゲーム","プレイ","バトル"],talk:["トーク","おしゃべり","雑談"],singing:["歌","ミュージック","パフォーマンス"],collaboration:["コラボ","協力","チーム"],event:["イベント","お祭り","特別"],custom:["カスタム","オリジナル","ユニーク"]},l=s[t]||s.simple,i=a[e]||a.custom,r=l[Math.floor(Math.random()*l.length)],n=i[Math.floor(Math.random()*i.length)];return"".concat(r).concat(n,"テンプレート")}constructor(e){this.config=e}}class eh extends em{async generate(){let e=Date.now();if(!this.validateConfig())throw Error("Invalid configuration");let t=await this.generateTemplate(),s=await this.evaluate(t);return{template:t,score:s,metadata:{generationTime:Date.now()-e,algorithm:"rule-based",version:"1.0.0"},suggestions:this.generateSuggestions(t,s)}}async generateTemplate(){let{target:e,parameters:t,constraints:s}=this.config,a=this.colorPalettes[t.colorScheme]||this.colorPalettes.complementary,l=a[Math.floor(Math.random()*a.length)],i=this.fontSettings[t.fontStyle]||this.fontSettings.modern,r=this.determineObjectCount(),n=this.generateLayout(r,e.aspectRatio);return{id:this.generateId(),name:this.generateName(e.category,e.style),description:"".concat(e.category,"向けの").concat(e.style,"なデザインテンプレート"),category:e.category,style:e.style,rating:0,preview:"",supportedAspectRatios:[e.aspectRatio],layout:n,colorPalette:l,fontSettings:{family:i.family,size:this.determineFontSize(e.difficulty),weight:i.weight,style:i.style,lineHeight:1.2,letterSpacing:"0",textAlign:"center",textDecoration:"none",textShadow:"none"},settings:{defaultFontSize:this.determineFontSize(e.difficulty),defaultFontFamily:i.family,defaultTextColor:l.text,defaultBackgroundColor:l.background,maxObjects:s.maxObjectSize,minObjectSize:s.minObjectSize,maxObjectSize:s.maxObjectSize,allowAnimation:!1,allowEffects:!1,allowVideo:!1,allowGif:!1,exportFormats:["png","jpg"],defaultExportFormat:"png",exportQuality:"high"},metadata:{version:"1.0.0",author:"Auto Generator",tags:this.generateTags(e.category,e.style),difficulty:e.difficulty,estimatedTime:this.estimateTime(r,e.difficulty),lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},isCustom:!1,createdAt:new Date().toISOString()}}determineObjectCount(){let{min:e,max:t,preferred:s}=this.config.parameters.objectCount,{difficulty:a}=this.config.target;return Math.max(e,Math.min(t,Math.round(s*({beginner:.7,intermediate:1,advanced:1.3})[a])))}generateLayout(e,t){let[s,a]=t.split(":").map(Number),l=1e3*a/s,i=[],r=Math.max(1,Math.floor(.6*e));for(let e=0;e<r;e++)i.push(this.generateTextObject(e,1e3,l));let n=e-r;for(let e=0;e<n;e++)i.push(this.generateShapeObject(e,1e3,l));return{background:{type:"color",value:"#ffffff"},objects:i}}generateTextObject(e,t,s){let a=this.generatePositions(t,s),l=a[e%a.length];return{id:"text-".concat(e),type:"text",visible:!0,locked:!1,position:{x:l.x,y:l.y,width:l.width,height:l.height,rotation:0,opacity:1},zIndex:e+1,content:{text:this.generateTextContent(e),color:"#1f2937",fontSize:this.determineFontSize(this.config.target.difficulty),fontFamily:this.fontSettings[this.config.parameters.fontStyle].family}}}generateShapeObject(e,t,s){let a=this.generatePositions(t,s),l=a[e%a.length],i=["rectangle","circle","triangle","star"],r=i[Math.floor(Math.random()*i.length)];return{id:"shape-".concat(e),type:"shape",visible:!0,locked:!1,position:{x:l.x,y:l.y,width:l.width,height:l.height,rotation:360*Math.random(),opacity:.8},zIndex:e+1,content:{shapeType:r,backgroundColor:this.getRandomColor(),borderColor:"#000000",borderWidth:2}}}generatePositions(e,t){let s=[];for(let a=0;a<3;a++)for(let l=0;l<3;l++){let i=50+l*(e-100)/3,r=50+a*(t-100)/3,n=(e-100)/3-20,c=(t-100)/3-20;s.push({x:i,y:r,width:n,height:c})}return s}generateTextContent(e){let t=["サンプルテキスト","タイトル","サブタイトル","説明文","キャッチコピー","メッセージ","テーマ","コンセプト"];return t[e%t.length]}determineFontSize(e){let t={beginner:["2rem","2.5rem","3rem"],intermediate:["1.5rem","2rem","2.5rem","3rem","3.5rem"],advanced:["1rem","1.5rem","2rem","2.5rem","3rem","3.5rem","4rem"]},s=t[e]||t.beginner;return s[Math.floor(Math.random()*s.length)]}getRandomColor(){let e=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"];return e[Math.floor(Math.random()*e.length)]}generateTags(e,t){return[...{gaming:["ゲーム","プレイ","バトル","アクション"],talk:["トーク","おしゃべり","雑談","コミュニケーション"],singing:["歌","ミュージック","パフォーマンス","音楽"],collaboration:["コラボ","協力","チーム","パートナーシップ"],event:["イベント","お祭り","特別","記念"],custom:["カスタム","オリジナル","ユニーク","特別"]}[e]||[],...{cute:["可愛い","キュート","チャーミング","愛らしい"],cool:["クール","スタイリッシュ","モダン","洗練"],elegant:["エレガント","上品","洗練された","美しい"],funny:["面白い","ユーモラス","楽しい","愉快"],simple:["シンプル","ミニマル","クリーン","シンプル"]}[t]||[],"自動生成"]}estimateTime(e,t){return Math.round(2*e*({beginner:1,intermediate:1.5,advanced:2})[t])}async evaluate(e){let t=this.evaluateAesthetics(e),s=this.evaluateUsability(e),a=this.evaluateUniqueness(e),l=this.evaluateTrendiness(e);return{overall:Math.round((t+s+a+l)/4),aesthetics:Math.round(t),usability:Math.round(s),uniqueness:Math.round(a),trendiness:Math.round(l)}}evaluateAesthetics(e){let t=50,{primary:s,secondary:a,accent:l}=e.colorPalette;this.isColorHarmonious(s,a)&&(t+=10),this.isColorHarmonious(a,l)&&(t+=10);let i=e.layout.objects.length;return i>=3&&i<=8&&(t+=15),i>8&&(t-=10),"Arial, sans-serif"!==e.fontSettings.family&&(t+=5),Math.min(100,Math.max(0,t))}evaluateUsability(e){let t=50,s=e.layout.objects.length;return s>=2&&s<=6&&(t+=20),s>6&&(t-=15),e.layout.objects.filter(e=>"text"===e.type).length>0&&(t+=10),"color"===e.layout.background.type&&(t+=5),Math.min(100,Math.max(0,t))}evaluateUniqueness(e){let t=30,{primary:s,secondary:a,accent:l}=e.colorPalette;return this.isUniqueColorCombination(s,a,l)&&(t+=20),e.layout.objects.length%2==1&&(t+=10),(e.fontSettings.family.includes("serif")||e.fontSettings.family.includes("cursive"))&&(t+=15),Math.min(100,Math.max(0,t))}evaluateTrendiness(e){let t=40,s=new Date().getFullYear();return e.createdAt&&new Date(e.createdAt).getFullYear()===s&&(t+=10),(e.fontSettings.family.includes("Inter")||e.fontSettings.family.includes("Roboto"))&&(t+=15),e.layout.objects.length<=4&&(t+=10),Math.min(100,Math.max(0,t))}isColorHarmonious(e,t){let s=e.replace("#",""),a=t.replace("#",""),l=parseInt(s.substr(0,2),16),i=parseInt(s.substr(2,2),16),r=parseInt(s.substr(4,2),16),n=parseInt(a.substr(0,2),16),c=Math.sqrt((l-n)**2+(i-parseInt(a.substr(2,2),16))**2+(r-parseInt(a.substr(4,2),16))**2);return c>100&&c<300}isUniqueColorCombination(e,t,s){return 3===new Set([e,t,s]).size}generateSuggestions(e,t){let s=[];return t.aesthetics<70&&(s.push("カラーパレットの調整を検討してください"),s.push("オブジェクトの配置バランスを改善してください")),t.usability<70&&(s.push("テキストの可読性を向上させてください"),s.push("オブジェクト数を適切な範囲に調整してください")),t.uniqueness<60&&(s.push("より独自性のあるデザイン要素を追加してください"),s.push("カラーパレットの組み合わせを変更してください")),t.trendiness<60&&(s.push("モダンなフォントを使用してください"),s.push("ミニマルなデザインを心がけてください")),0===s.length&&s.push("バランスの取れた良いテンプレートです"),s}constructor(...e){super(...e),this.colorPalettes={monochrome:[{primary:"#2D3748",secondary:"#4A5568",accent:"#718096",background:"#F7FAFC",text:"#1A202C"},{primary:"#2B6CB0",secondary:"#3182CE",accent:"#4299E1",background:"#EBF8FF",text:"#1A365D"},{primary:"#805AD5",secondary:"#9F7AEA",accent:"#B794F6",background:"#FAF5FF",text:"#322659"}],complementary:[{primary:"#E53E3E",secondary:"#38A169",accent:"#D69E2E",background:"#FFF5F5",text:"#1A202C"},{primary:"#3182CE",secondary:"#E53E3E",accent:"#38A169",background:"#EBF8FF",text:"#1A365D"},{primary:"#805AD5",secondary:"#D69E2E",accent:"#38A169",background:"#FAF5FF",text:"#322659"}],triadic:[{primary:"#E53E3E",secondary:"#38A169",accent:"#3182CE",background:"#FFF5F5",text:"#1A202C"},{primary:"#805AD5",secondary:"#E53E3E",accent:"#38A169",background:"#FAF5FF",text:"#322659"},{primary:"#D69E2E",secondary:"#3182CE",accent:"#E53E3E",background:"#FFFBEB",text:"#1A202C"}]},this.fontSettings={modern:{family:"Inter, sans-serif",weight:"500",style:"normal"},classic:{family:"Georgia, serif",weight:"400",style:"normal"},playful:{family:"Comic Sans MS, cursive",weight:"400",style:"normal"},elegant:{family:"Playfair Display, serif",weight:"400",style:"italic"},bold:{family:"Impact, Arial Black, sans-serif",weight:"900",style:"normal"}}}}class eu extends em{async generate(){let e=Date.now();if(!this.validateConfig())throw Error("Invalid configuration");let t=await this.callAIAPI(),s=await this.evaluate(t);return{template:t,score:s,metadata:{generationTime:Date.now()-e,algorithm:"ai-powered",version:"1.0.0"},suggestions:this.generateSuggestions(t,s)}}async callAIAPI(){throw Error("AI generation not yet implemented")}async evaluate(e){return{overall:85,aesthetics:90,usability:80,uniqueness:85,trendiness:90}}generateSuggestions(e,t){return["AI生成による高品質なテンプレートです"]}constructor(e,t,s){super(e),this.apiEndpoint=t,this.apiKey=s}}class ep{static createGenerator(e,t,s){switch(e){case"rule-based":return new eh(t);case"ai-powered":if(!(null==s?void 0:s.apiEndpoint)||!(null==s?void 0:s.apiKey))throw Error("API endpoint and key required for AI generator");return new eu(t,s.apiEndpoint,s.apiKey);default:throw Error("Unknown generator type: ".concat(e))}}}let eg={target:{category:"custom",style:"simple",aspectRatio:"16:9",difficulty:"beginner"},parameters:{objectCount:{min:2,max:8,preferred:4},colorScheme:"complementary",fontStyle:"modern",layoutType:"centered"},constraints:{maxTextLength:50,minObjectSize:20,maxObjectSize:400,allowOverlap:!1,requireBalance:!0},quality:{complexity:"medium",uniqueness:"medium",trendiness:"medium"}};var ej=s(89432);let ef=e=>{let{onTemplateGenerated:t,onTemplatesGenerated:s}=e,[i,r]=(0,l.useState)(eg),[c,o]=(0,l.useState)(!1),[d,x]=(0,l.useState)([]),[m,h]=(0,l.useState)(null),[u,f]=(0,l.useState)(1),v=(0,ej.U)("(min-width: 768px)"),[y,A]=(0,l.useState)(()=>new Set),[k,R]=(0,l.useState)({}),[E,T]=(0,l.useState)(null),[z,D]=(0,l.useState)(""),[M,J]=(0,l.useState)(()=>new Set);(0,l.useEffect)(()=>{try{let e=localStorage.getItem("thumbnailGeneratorAutoFavorites");e&&A(new Set(JSON.parse(e)))}catch(e){B.vF.error("お気に入り読み込み失敗",e,"AutoGenerationPanel")}try{let e=localStorage.getItem("thumbnailGeneratorAutoNotes");e&&R(JSON.parse(e))}catch(e){B.vF.error("メモ読み込み失敗",e,"AutoGenerationPanel")}},[]);let P=e=>{r(t=>({...t,target:{...t.target,...e}}))},G=e=>{r(t=>({...t,parameters:{...t.parameters,...e}}))},$=e=>{r(t=>({...t,quality:{...t.quality,...e}}))},U=async()=>{o(!0);try{let e=ep.createGenerator("rule-based",i),t=[];for(let s=0;s<u;s++){let s=await e.generate();t.push(s)}x(t),q.oR.success("".concat(u,"個のテンプレートを生成しました！"))}catch(e){B.vF.error("テンプレート生成失敗",e,"AutoGenerationPanel"),q.oR.error("テンプレート生成に失敗しました")}finally{o(!1)}},W=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600",V=(e,s,l)=>{let i=M.has(e.template.id),r=null==l?void 0:l.includes("mobile-card");return(0,a.jsxs)(F.Zp,{className:(0,C.cn)("relative",r&&"snap-center shrink-0",l&&!r&&l),style:r?{width:"min(85vw, 340px)"}:void 0,children:[(0,a.jsx)(F.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)(F.ZB,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)("span",{className:"truncate",children:e.template.name}),y.has(e.template.id)&&(0,a.jsx)(I.A,{className:"h-4 w-4 text-[#FF7FBF]",fill:"#FF7FBF"})]}),e.template.description&&(0,a.jsx)(F.BT,{className:"mt-1 line-clamp-2",children:e.template.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:(0,C.cn)("h-9 w-9 transition-colors",y.has(e.template.id)?"text-[#FF7FBF]":"text-muted-foreground hover:text-[#FF7FBF]"),onClick:()=>(e=>{A(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),localStorage.setItem("thumbnailGeneratorAutoFavorites",JSON.stringify(Array.from(s))),s})})(e.template.id),title:y.has(e.template.id)?"お気に入りを解除":"お気に入りに追加",children:(0,a.jsx)(I.A,{className:"h-4 w-4",fill:y.has(e.template.id)?"#FF7FBF":"none"})}),(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-9 w-9 text-muted-foreground hover:text-foreground transition-colors",onClick:()=>(e=>{T(e),D(k[e]||"")})(e.template.id),title:"メモを追加",children:(0,a.jsx)(el.A,{className:"h-4 w-4"})}),(0,a.jsxs)(L.E,{variant:"secondary",className:"ml-1",children:["#",s+1]})]})]})}),(0,a.jsx)(F.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"総合スコア"}),(0,a.jsxs)("span",{className:"font-semibold ".concat(W(e.score.overall)),children:[e.score.overall,"/100"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"美学"}),(0,a.jsx)("span",{className:W(e.score.aesthetics),children:e.score.aesthetics})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"使いやすさ"}),(0,a.jsx)("span",{className:W(e.score.usability),children:e.score.usability})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"独自性"}),(0,a.jsx)("span",{className:W(e.score.uniqueness),children:e.score.uniqueness})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"トレンド性"}),(0,a.jsx)("span",{className:W(e.score.trendiness),children:e.score.trendiness})]})]})]}),(0,a.jsx)(ea.w,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[e.template.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[e.template.layout.objects.length,"オブジェクト"]})]}),k[e.template.id]&&(0,a.jsxs)("div",{className:"rounded-md border border-[#3A3A3A] bg-[#1E1E1E] p-3 text-xs text-muted-foreground",children:[(0,a.jsxs)("p",{className:"font-medium text-foreground flex items-center gap-1 mb-1",children:[(0,a.jsx)(el.A,{className:"h-3 w-3"}),"メモ"]}),(0,a.jsx)("p",{className:"whitespace-pre-wrap break-words",children:k[e.template.id]})]}),(0,a.jsxs)("div",{className:"rounded-md border border-[#3A3A3A] bg-[#1B1B1B] p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"生成テキスト"}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>(e=>{J(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})})(e.template.id),children:i?"折りたたむ":"展開"})]}),i?(0,a.jsxs)("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground mb-1",children:"改善提案"}),(0,a.jsx)("ul",{className:"space-y-1 list-disc list-inside",children:e.suggestions.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),e.template.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground mb-1",children:"説明文"}),(0,a.jsx)("p",{className:"whitespace-pre-wrap leading-relaxed",children:e.template.description})]})]}):(0,a.jsx)("p",{className:"mt-2 text-xs text-muted-foreground line-clamp-2",children:e.suggestions[0]||"詳細情報はありません"})]}),(0,a.jsx)("div",{className:"rounded-md border border-dashed border-muted bg-muted/30 aspect-video flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"プレビュー（実装予定）"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>(e=>{h(e),t(e.template),q.oR.success("テンプレートを選択しました！")})(e),className:"flex-1",children:[(0,a.jsx)(X.A,{className:"h-4 w-4 mr-1"}),"選択"]}),(0,a.jsxs)(H.lG,{children:[(0,a.jsx)(H.zM,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"outline",size:"sm",children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(H.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"テンプレート詳細"}),(0,a.jsxs)(H.rr,{children:[e.template.name,"の詳細情報と改善提案"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"スコア詳細"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"総合スコア"}),(0,a.jsxs)("span",{className:W(e.score.overall),children:[e.score.overall,"/100"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"美学"}),(0,a.jsxs)("span",{className:W(e.score.aesthetics),children:[e.score.aesthetics,"/100"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"使いやすさ"}),(0,a.jsxs)("span",{className:W(e.score.usability),children:[e.score.usability,"/100"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"独自性"}),(0,a.jsxs)("span",{className:W(e.score.uniqueness),children:[e.score.uniqueness,"/100"]})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"改善提案"}),(0,a.jsx)("ul",{className:"space-y-1",children:e.suggestions.map((e,t)=>(0,a.jsxs)("li",{className:"text-sm text-muted-foreground",children:["• ",e]},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"生成情報"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{children:["生成時間: ",e.metadata.generationTime,"ms"]}),(0,a.jsxs)("div",{children:["アルゴリズム: ",e.metadata.algorithm]}),(0,a.jsxs)("div",{children:["バージョン: ",e.metadata.version]})]})]})]})]})]})]})]})})]},e.template.id)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2 whitespace-nowrap",children:[(0,a.jsx)(p.A,{className:"h-6 w-6 text-purple-500"}),"AI自動生成"]}),(0,a.jsx)("p",{className:"text-muted-foreground whitespace-nowrap",children:"AIが自動でテンプレートを生成します"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{r(eg),q.oR.success("設定をリセットしました")},children:[(0,a.jsx)(ei.A,{className:"h-4 w-4 mr-2"}),"リセット"]})})]}),(0,a.jsxs)(j.tU,{defaultValue:"basic",className:"w-full",children:[(0,a.jsxs)(j.j7,{className:"grid w-full grid-cols-3 h-auto",children:[(0,a.jsx)(j.Xi,{value:"basic",className:"text-xs sm:text-sm",children:"基本設定"}),(0,a.jsx)(j.Xi,{value:"advanced",className:"text-xs sm:text-sm",children:"詳細設定"}),(0,a.jsx)(j.Xi,{value:"results",className:"text-xs sm:text-sm",children:"生成結果"})]}),(0,a.jsxs)(j.av,{value:"basic",className:"space-y-6",children:[(0,a.jsxs)(F.Zp,{children:[(0,a.jsxs)(F.aR,{children:[(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(er.A,{className:"h-5 w-5"}),"生成対象"]}),(0,a.jsx)(F.BT,{children:"生成するテンプレートの基本情報を設定します"})]}),(0,a.jsxs)(F.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"category",children:"カテゴリ"}),(0,a.jsxs)(S.l6,{value:i.target.category,onValueChange:e=>P({category:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(S.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(S.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"style",children:"スタイル"}),(0,a.jsxs)(S.l6,{value:i.target.style,onValueChange:e=>P({style:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(S.eb,{value:"cool",children:"クール"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(S.eb,{value:"simple",children:"シンプル"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"aspectRatio",children:"アスペクト比"}),(0,a.jsxs)(S.l6,{value:i.target.aspectRatio,onValueChange:e=>P({aspectRatio:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"1:1",children:"1:1 (正方形)"}),(0,a.jsx)(S.eb,{value:"4:3",children:"4:3 (標準)"}),(0,a.jsx)(S.eb,{value:"16:9",children:"16:9 (横長)"}),(0,a.jsx)(S.eb,{value:"9:16",children:"9:16 (縦長)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"difficulty",children:"難易度"}),(0,a.jsxs)(S.l6,{value:i.target.difficulty,onValueChange:e=>P({difficulty:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(S.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(S.eb,{value:"advanced",children:"上級"})]})]})]})]})]})]}),(0,a.jsxs)(F.Zp,{children:[(0,a.jsxs)(F.aR,{children:[(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(en.A,{className:"h-5 w-5"}),"生成設定"]}),(0,a.jsx)(F.BT,{children:"生成するテンプレートの数と品質を設定します"})]}),(0,a.jsxs)(F.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(w.J,{htmlFor:"generationCount",children:["生成数: ",u,"個"]}),(0,a.jsx)(N.A,{value:[u],onValueChange:e=>f(e[0]),min:1,max:10,step:1,className:"mt-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{children:"複雑さ"}),(0,a.jsxs)(S.l6,{value:i.quality.complexity,onValueChange:e=>$({complexity:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"low",children:"低"}),(0,a.jsx)(S.eb,{value:"medium",children:"中"}),(0,a.jsx)(S.eb,{value:"high",children:"高"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{children:"独自性"}),(0,a.jsxs)(S.l6,{value:i.quality.uniqueness,onValueChange:e=>$({uniqueness:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"low",children:"低"}),(0,a.jsx)(S.eb,{value:"medium",children:"中"}),(0,a.jsx)(S.eb,{value:"high",children:"高"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{children:"トレンド性"}),(0,a.jsxs)(S.l6,{value:i.quality.trendiness,onValueChange:e=>$({trendiness:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"low",children:"低"}),(0,a.jsx)(S.eb,{value:"medium",children:"中"}),(0,a.jsx)(S.eb,{value:"high",children:"高"})]})]})]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(n.$,{onClick:U,disabled:c,size:"lg",className:"px-8",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ei.A,{className:"h-5 w-5 mr-2 animate-spin"}),"生成中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.A,{className:"h-5 w-5 mr-2"}),"テンプレート生成"]})})})]}),(0,a.jsxs)(j.av,{value:"advanced",className:"space-y-6",children:[(0,a.jsxs)(F.Zp,{children:[(0,a.jsx)(F.aR,{children:(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eo.A,{className:"h-5 w-5"}),"カラーパレット"]})}),(0,a.jsx)(F.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"colorScheme",children:"配色パターン"}),(0,a.jsxs)(S.l6,{value:i.parameters.colorScheme,onValueChange:e=>G({colorScheme:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"monochrome",children:"モノクロ"}),(0,a.jsx)(S.eb,{value:"complementary",children:"補色"}),(0,a.jsx)(S.eb,{value:"triadic",children:"三色配色"}),(0,a.jsx)(S.eb,{value:"analogous",children:"類似色"}),(0,a.jsx)(S.eb,{value:"random",children:"ランダム"})]})]})]})})]}),(0,a.jsxs)(F.Zp,{children:[(0,a.jsx)(F.aR,{children:(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ed.A,{className:"h-5 w-5"}),"フォント設定"]})}),(0,a.jsx)(F.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"fontStyle",children:"フォントスタイル"}),(0,a.jsxs)(S.l6,{value:i.parameters.fontStyle,onValueChange:e=>G({fontStyle:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"modern",children:"モダン"}),(0,a.jsx)(S.eb,{value:"classic",children:"クラシック"}),(0,a.jsx)(S.eb,{value:"playful",children:"プレイフル"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"bold",children:"ボールド"})]})]})]})})]}),(0,a.jsxs)(F.Zp,{children:[(0,a.jsx)(F.aR,{children:(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ex.A,{className:"h-5 w-5"}),"レイアウト設定"]})}),(0,a.jsxs)(F.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"layoutType",children:"レイアウトタイプ"}),(0,a.jsxs)(S.l6,{value:i.parameters.layoutType,onValueChange:e=>G({layoutType:e}),children:[(0,a.jsx)(S.bq,{children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"centered",children:"中央配置"}),(0,a.jsx)(S.eb,{value:"asymmetric",children:"非対称"}),(0,a.jsx)(S.eb,{value:"grid",children:"グリッド"}),(0,a.jsx)(S.eb,{value:"flow",children:"フロー"}),(0,a.jsx)(S.eb,{value:"random",children:"ランダム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(w.J,{children:["オブジェクト数: ",i.parameters.objectCount.preferred,"個"]}),(0,a.jsx)(N.A,{value:[i.parameters.objectCount.preferred],onValueChange:e=>G({objectCount:{...i.parameters.objectCount,preferred:e[0]}}),min:i.parameters.objectCount.min,max:i.parameters.objectCount.max,step:1,className:"mt-2"})]})]})]})]}),(0,a.jsx)(j.av,{value:"results",className:"space-y-6",children:0===d.length?(0,a.jsx)(F.Zp,{children:(0,a.jsxs)(F.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(p.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"テンプレートが生成されていません"}),(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"基本設定タブでテンプレートを生成してください"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["生成結果 (",d.length,"個)"]}),(0,a.jsxs)(n.$,{onClick:()=>{let e=d.map(e=>e.template);s(e),q.oR.success("".concat(e.length,"個のテンプレートを追加しました！"))},variant:"outline",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"全て追加"]})]}),v?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map((e,t)=>V(e,t))}):1===d.length?(0,a.jsx)("div",{className:"space-y-4",children:V(d[0],0,"w-full")}):(0,a.jsx)("div",{className:"-mx-2 flex snap-x snap-mandatory gap-4 overflow-x-auto pb-4 px-2",children:d.map((e,t)=>V(e,t,"mobile-card"))})]})})]}),(0,a.jsx)(H.lG,{open:null!==E,onOpenChange:e=>{e||(T(null),D(""))},children:(0,a.jsxs)(H.Cf,{className:"max-w-md",children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"メモを編集"}),(0,a.jsx)(H.rr,{children:"生成したテンプレートに関するメモを残しておくと、後から参照しやすくなります。"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(b.T,{value:z,onChange:e=>D(e.target.value),placeholder:"気づきやアイデアを記入してください",className:"min-h-[120px]"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:[z.length,"文字"]}),(0,a.jsx)("span",{children:"最大 500 文字推奨"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 pt-2",children:[(0,a.jsx)(n.$,{variant:"destructive",size:"sm",onClick:()=>{E&&(R(e=>{let t={...e};return delete t[E],localStorage.setItem("thumbnailGeneratorAutoNotes",JSON.stringify(t)),t}),T(null),D(""),q.oR.success("メモを削除しました"))},disabled:!E||!(E&&k[E]),className:"sm:w-auto w-full",children:"メモを削除"}),(0,a.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>{T(null),D("")},className:"flex-1 sm:flex-none",children:"キャンセル"}),(0,a.jsx)(n.$,{size:"sm",onClick:()=>{E&&(R(e=>{let t={...e,[E]:z.trim()};return localStorage.setItem("thumbnailGeneratorAutoNotes",JSON.stringify(t)),t}),T(null),D(""),q.oR.success("メモを保存しました"))},className:"flex-1 sm:flex-none",disabled:!z.trim(),children:"保存する"})]})]})]})})]})},ev=["1:1","4:3","9:16","16:9"];var ey=s(26560);let eb="thumbnail-generator-favorites",eN=[{value:"all",label:"すべて"},{value:"gaming",label:"ゲーム"},{value:"talk",label:"雑談"},{value:"singing",label:"歌枠"},{value:"collaboration",label:"コラボ"},{value:"event",label:"イベント"},{value:"custom",label:"カスタム"}],ew=[{value:"all",label:"全スタイル"},{value:"cute",label:"キュート"},{value:"cool",label:"クール"},{value:"elegant",label:"エレガント"},{value:"funny",label:"ファニー"},{value:"simple",label:"シンプル"}],eA=[{value:"all",label:"全難易度"},{value:"beginner",label:"初級"},{value:"intermediate",label:"中級"},{value:"advanced",label:"上級"}],eS=e=>{let{template:t,isSelected:s,isFavorite:i,onSelect:r,onToggleFavorite:c,onDelete:o,previewSize:d,isCompact:x=!1}=e,m=(0,l.useMemo)(()=>{if(x)return{height:"180px"};switch(d){case"small":return{height:"120px"};case"medium":default:return{height:"160px"};case"large":return{height:"240px"}}},[d]);return(0,a.jsx)(F.Zp,{className:(0,C.cn)("cursor-pointer hover:border-[#20B2AA] transition-all duration-200 group relative overflow-hidden",s&&"border-2 border-[#20B2AA] ring-2 ring-[#20B2AA] ring-offset-2",!s&&"hover:shadow-lg",x&&"w-[82vw] min-w-[82vw] snap-center"),onClick:()=>r(t),children:(0,a.jsxs)(F.Wu,{className:"p-0 relative",children:[(0,a.jsxs)("div",{className:(0,C.cn)("w-full bg-[#2D2D2D] relative overflow-hidden","aspect-video"),style:m,children:[t.preview?(0,a.jsx)("img",{src:t.preview,alt:t.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"}):(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-center text-xs md:text-sm relative overflow-hidden",style:{background:"color"===t.layout.background.type||"gradient"===t.layout.background.type?t.layout.background.value:"#f8f9fa"},children:[t.layout.objects.map(e=>{var s,l;return"text"===e.type&&(null==(s=e.content)?void 0:s.text)?(0,a.jsx)("div",{className:"absolute",style:{left:"".concat(e.position.x/1200*100,"%"),top:"".concat(e.position.y/675*100,"%"),width:"".concat(e.position.width/1200*100,"%"),height:"".concat(e.position.height/675*100,"%"),fontSize:"large"===d?"0.75rem":"0.5rem",color:e.content.color||t.colorPalette.text,fontFamily:e.content.fontFamily||t.fontSettings.family,fontWeight:(null==(l=e.content.fontSize)?void 0:l.includes("bold"))?"bold":"normal",textAlign:e.content.textAlign||t.fontSettings.textAlign,display:"flex",alignItems:"center",justifyContent:"center",transform:"scale(".concat(Math.min(1,100/(e.content.text.length||1)),")")},children:e.content.text},e.id):null}),0===t.layout.objects.length&&t.initialText&&(0,a.jsx)("p",{className:"font-bold text-center px-1",style:{color:t.initialTextColor||t.colorPalette.text,fontSize:"large"===d?"0.75rem":"0.5rem"},children:t.initialText})]}),(0,a.jsx)("button",{onClick:e=>c(t.id,e),className:(0,C.cn)("absolute top-2 right-2 p-1.5 rounded-full bg-black/50 backdrop-blur-sm transition-all duration-200 z-10","hover:bg-black/70 hover:scale-110",i&&"bg-[#20B2AA]/80 hover:bg-[#20B2AA]"),"aria-label":i?"お気に入りを解除":"お気に入りに追加",title:i?"お気に入りを解除":"お気に入りに追加",children:(0,a.jsx)(I.A,{className:(0,C.cn)("h-4 w-4 transition-colors",i?"fill-[#20B2AA] text-[#20B2AA]":"text-white")})}),s&&(0,a.jsx)("div",{className:"absolute inset-0 bg-[#20B2AA]/10 border-2 border-[#20B2AA] rounded-md"}),!x&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:(0,a.jsx)("p",{className:"text-xs text-white font-medium truncate",children:t.name})}),o&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 md:group-hover:opacity-100 transition-opacity hidden md:flex items-center justify-center gap-2",children:(0,a.jsxs)(n.$,{size:"sm",variant:"destructive",onClick:e=>{e.stopPropagation(),o(t.id)},children:[(0,a.jsx)(J.A,{className:"h-4 w-4 mr-1"}),"削除"]})})]}),(0,a.jsxs)("div",{className:(0,C.cn)("p-3",x&&"space-y-2"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-sm truncate text-foreground",children:t.name}),t.description&&!x&&(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0] mt-1 line-clamp-2",children:t.description})]}),o&&(0,a.jsx)(n.$,{size:"sm",variant:"ghost",className:(0,C.cn)("ml-2 h-6 w-6 p-0 flex-shrink-0",x?"opacity-100 text-muted-foreground":"md:hidden"),onClick:e=>{e.stopPropagation(),o(t.id)},children:(0,a.jsx)(J.A,{className:"h-3 w-3"})})]}),(0,a.jsxs)("div",{className:(0,C.cn)("flex items-center justify-between mt-2",x&&"mt-1"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[(0,a.jsx)(L.E,{variant:"secondary",className:"text-xs",children:"gaming"===t.category?"ゲーム":"talk"===t.category?"雑談":"singing"===t.category?"歌枠":"collaboration"===t.category?"コラボ":"event"===t.category?"イベント":"カスタム"}),(0,a.jsx)(L.E,{variant:"outline",className:"text-xs",style:{color:"beginner"===t.metadata.difficulty?"#22c55e":"intermediate"===t.metadata.difficulty?"#f59e0b":"#ef4444"},children:"beginner"===t.metadata.difficulty?"初級":"intermediate"===t.metadata.difficulty?"中級":"上級"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(O.A,{className:"h-3 w-3 text-yellow-500"}),(0,a.jsx)("span",{className:"text-xs",children:t.rating})]})]}),!x&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1 text-xs text-[#A0A0A0]",children:[(0,a.jsxs)("span",{children:[t.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[t.layout.objects.length,"オブジェクト"]})]})]})]})})},eC=e=>{let{onCreateTemplate:t,onClose:s}=e,[i,r]=(0,l.useState)(""),[c,o]=(0,l.useState)(""),[d,x]=(0,l.useState)("custom"),[m,h]=(0,l.useState)("simple"),[u,p]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),[f,v]=(0,l.useState)(!1),[y,N]=(0,l.useState)(!1),C=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){v(!0);try{let e=await new Promise((e,t)=>{let a=new FileReader;a.onload=t=>{var s;e(null==(s=t.target)?void 0:s.result)},a.onerror=()=>{t(Error("Failed to read file"))},a.readAsDataURL(s)});p(e),N(!0);let t=await $(e);j(t),q.oR.success("画像をアップロードし、プレビューを生成しました！")}catch(e){B.vF.error("画像アップロード失敗",e,"TemplateSelector"),q.oR.error("画像のアップロードに失敗しました")}finally{v(!1),N(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)(F.Zp,{className:"w-full max-w-md mx-4",children:[(0,a.jsxs)(F.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"h-5 w-5"}),"カスタムテンプレート作成"]}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:s,children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-sm text-[#A0A0A0]",children:"既存のサムネイル画像をアップロードしてテンプレートとして保存できます"}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:(0,a.jsxs)("p",{className:"text-xs text-yellow-800",children:[(0,a.jsx)("strong",{children:"注意:"})," カスタムテンプレートは現在1280\xd7720でのエクスポートのみ対応しています。 他の解像度でのエクスポートは正常に動作しない場合があります。"]})})]}),(0,a.jsxs)(F.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"テンプレート画像"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(A.p,{type:"file",accept:"image/*",onChange:C,className:"mb-2"}),u&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"aspect-video bg-[#2D2D2D] rounded-md overflow-hidden",children:(0,a.jsx)("img",{src:u,alt:"テンプレート",className:"w-full h-full object-cover"})}),(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0]",children:"元画像 (1280\xd7720px推奨)"})]}),g&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"aspect-video bg-[#2D2D2D] rounded-md overflow-hidden max-w-xs",children:(0,a.jsx)("img",{src:g,alt:"プレビュー",className:"w-full h-full object-cover"})}),(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0]",children:"プレビュー画像 (320\xd7180px)"})]}),f&&(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0] mt-1",children:"アップロード中..."}),y&&(0,a.jsx)("p",{className:"text-xs text-blue-500 mt-1",children:"プレビュー生成中..."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"テンプレート名"}),(0,a.jsx)(A.p,{value:i,onChange:e=>r(e.target.value),placeholder:"テンプレート名を入力",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"説明"}),(0,a.jsx)(b.T,{value:c,onChange:e=>o(e.target.value),placeholder:"テンプレートの説明を入力",className:"mt-1 min-h-[80px] resize-none"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"カテゴリ"}),(0,a.jsxs)(S.l6,{value:d,onValueChange:x,children:[(0,a.jsx)(S.bq,{className:"mt-1",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーム"}),(0,a.jsx)(S.eb,{value:"talk",children:"雑談"}),(0,a.jsx)(S.eb,{value:"singing",children:"歌枠"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"スタイル"}),(0,a.jsxs)(S.l6,{value:m,onValueChange:h,children:[(0,a.jsx)(S.bq,{className:"mt-1",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"cute",children:"可愛い"}),(0,a.jsx)(S.eb,{value:"cool",children:"クール"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"funny",children:"面白い"}),(0,a.jsx)(S.eb,{value:"simple",children:"シンプル"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsxs)(n.$,{onClick:()=>i.trim()?u?void(t({name:i,description:c,category:d,style:m,preview:g}),r(""),o(""),x("custom"),h("simple"),p(""),j("")):void q.oR.error("テンプレート画像をアップロードしてください"):void q.oR.error("テンプレート名を入力してください"),className:"flex-1",disabled:!i.trim(),children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"テンプレートを作成"]}),(0,a.jsx)(n.$,{variant:"outline",onClick:s,children:"キャンセル"})]})]})]})})},ek=e=>{let{onSelectTemplate:t,selectedTemplateId:s,availableTabs:r,defaultTab:c}=e,{aspectRatio:o,setAspectRatio:d,customAspectRatio:x,setCustomAspectRatio:m}=(0,i.S)(),h=(0,ej.U)("(min-width: 1024px)"),u=(0,ej.U)("(min-width: 768px)"),[g,f]=(0,l.useState)(""),[v,y]=(0,l.useState)("all"),[b,N]=(0,l.useState)("all"),[k,F]=(0,l.useState)("all"),[L,J]=(0,l.useState)(!1),[O,P]=(0,l.useState)([]),[B,G]=(0,l.useState)(ey.k),$=(0,l.useMemo)(()=>r&&0!==r.length?r:["browse","manage","auto-generate"],[r]),[H,Z]=(0,l.useState)(()=>c&&$.includes(c)?c:$[0]);(0,l.useEffect)(()=>{Z(e=>c&&$.includes(c)?c:$.includes(e)?e:$[0])},[$,c]);let[X,K]=(0,l.useState)(()=>{{let e=localStorage.getItem(eb);return e?new Set(JSON.parse(e)):new Set}}),[Y,_]=(0,l.useState)("medium"),[Q,ee]=(0,l.useState)("all");(0,l.useEffect)(()=>{let e=localStorage.getItem("customThumbnailTemplates");if(e){let t=JSON.parse(e);P(t),G([...ey.k,...t])}},[]);let et=(e,t)=>{let s=parseInt(e.target.value,10),a={...x,[t]:s};!isNaN(s)&&s>0&&(m(a),d("custom"))},ea=(0,l.useMemo)(()=>B.filter(e=>{var t;let s=e.name.toLowerCase().includes(g.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(g.toLowerCase()))||e.metadata.tags.some(e=>e.toLowerCase().includes(g.toLowerCase())),a="all"===v||e.category===v,l="all"===b||e.style===b,i="all"===k||e.metadata.difficulty===k,r="custom"===o||e.supportedAspectRatios.includes(o);return s&&a&&l&&i&&r}),[B,g,v,b,k,o]),el=(0,l.useMemo)(()=>{let e=ea;return"favorites"===Q&&(e=e.filter(e=>X.has(e.id))),e},[ea,Q,X]),ei=(0,l.useMemo)(()=>{if(!u)return"grid-cols-1";if(!h)return"grid-cols-2";switch(Y){case"small":return"grid-cols-3";case"medium":default:return"grid-cols-2";case"large":return"grid-cols-1"}},[h,Y]),er=(e,t)=>{t.stopPropagation();let s=new Set(X);s.has(e)?s.delete(e):s.add(e),K(s),localStorage.setItem(eb,JSON.stringify(Array.from(s)))},en=e=>{if(confirm("このカスタムテンプレートを削除しますか？")){let t=O.filter(t=>t.id!==e);P(t),G([...ey.k,...t]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(t)),q.oR.success("カスタムテンプレートを削除しました！")}},ec=e=>{P(e),G([...ey.k,...e]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(e))};return(0,a.jsxs)("div",{className:"w-full",children:[$.length>1&&(0,a.jsx)("div",{className:"border-b mb-4",children:(0,a.jsxs)("div",{className:"flex justify-center flex-wrap gap-1",children:[$.includes("browse")&&(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("browse"===H?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>Z("browse"),children:[(0,a.jsx)(R.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"選択"})]}),$.includes("manage")&&(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("manage"===H?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>Z("manage"),children:[(0,a.jsx)(E.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"管理"})]}),$.includes("auto-generate")&&(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("auto-generate"===H?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>Z("auto-generate"),children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"AI生成"})]})]})}),"browse"===H?(0,a.jsxs)(U.nD,{type:"multiple",className:"w-full",defaultValue:["aspect-ratio","templates"],children:[(0,a.jsxs)(U.As,{value:"aspect-ratio",children:[(0,a.jsx)(U.$m,{children:"アスペクト比"}),(0,a.jsxs)(U.ub,{className:"space-y-4 pt-4",children:[(0,a.jsx)(w.J,{children:"プリセット"}),(0,a.jsx)(W.O,{type:"single",value:"custom"===o?"":o,onValueChange:e=>{e&&d(e)},variant:"outline",className:"flex-wrap justify-start",children:ev.map(e=>(0,a.jsx)(W.d,{value:e,"aria-label":"比率 ".concat(e),children:e},e))}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"手動設定"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.p,{type:"number",placeholder:"幅",className:"w-24",value:x.width,onChange:e=>et(e,"width")}),(0,a.jsx)("span",{children:":"}),(0,a.jsx)(A.p,{type:"number",placeholder:"高さ",className:"w-24",value:x.height,onChange:e=>et(e,"height")})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"小さい数字で比率、大きい数字で解像度を指定できます。"})]})]})]}),(0,a.jsxs)(U.As,{value:"templates",children:[(0,a.jsx)(U.$m,{children:"テンプレート選択"}),(0,a.jsx)(U.ub,{className:"pt-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg md:text-lg font-semibold",children:"テンプレート選択"}),(0,a.jsxs)(n.$,{size:"sm",variant:"outline",onClick:()=>J(!0),className:"flex items-center gap-1 md:gap-2 h-9 px-3 md:px-4",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"カスタム作成"}),(0,a.jsx)("span",{className:"sm:hidden",children:"作成"})]})]}),!u&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(V.F,{className:"w-full",children:[(0,a.jsx)("div",{className:"flex gap-2 px-1 py-1",children:eN.map(e=>(0,a.jsx)(n.$,{size:"sm",variant:v===e.value?"default":"outline",className:(0,C.cn)("rounded-full px-4 py-1 text-xs whitespace-nowrap",v===e.value?"":"bg-[#1A1A1A]"),onClick:()=>y(e.value),children:e.label},e.value))}),(0,a.jsx)(V.$,{orientation:"horizontal"})]}),(0,a.jsxs)(V.F,{className:"w-full",children:[(0,a.jsx)("div",{className:"flex gap-2 px-1 py-1",children:ew.map(e=>(0,a.jsx)(n.$,{size:"sm",variant:b===e.value?"default":"outline",className:(0,C.cn)("rounded-full px-4 py-1 text-xs whitespace-nowrap",b===e.value?"":"bg-[#1A1A1A]"),onClick:()=>N(e.value),children:e.label},e.value))}),(0,a.jsx)(V.$,{orientation:"horizontal"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 px-1",children:eA.map(e=>(0,a.jsx)(n.$,{size:"sm",variant:k===e.value?"default":"outline",className:(0,C.cn)("rounded-full px-3 py-1 text-xs",k===e.value?"":"bg-[#1A1A1A]"),onClick:()=>F(e.value),children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:(0,C.cn)("space-y-3",!u&&"mt-4"),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-[#A0A0A0]"}),(0,a.jsx)(A.p,{placeholder:"テンプレートを検索...",value:g,onChange:e=>f(e.target.value),className:"pl-10 h-10 md:h-9"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)(j.tU,{value:Q,onValueChange:e=>ee(e),className:"flex-1",children:(0,a.jsxs)(j.j7,{className:"w-full grid grid-cols-2",children:[(0,a.jsxs)(j.Xi,{value:"all",className:"text-xs",children:["すべて (",el.length,")"]}),(0,a.jsxs)(j.Xi,{value:"favorites",className:"text-xs flex items-center gap-1",children:[(0,a.jsx)(I.A,{className:(0,C.cn)("h-3 w-3",X.size>0&&"fill-current")}),"お気に入り (",X.size,")"]})]})}),h&&(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-muted rounded-md p-1",children:[(0,a.jsx)(n.$,{variant:"ghost",size:"sm",className:(0,C.cn)("h-7 px-2 transition-colors","small"===Y&&"bg-[#20B2AA]/20 text-[#20B2AA] hover:bg-[#20B2AA]/30"),onClick:()=>_("small"),title:"小さいプレビュー（3列表示）",children:(0,a.jsx)(R.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",className:(0,C.cn)("h-7 px-2 transition-colors","medium"===Y&&"bg-[#20B2AA]/20 text-[#20B2AA] hover:bg-[#20B2AA]/30"),onClick:()=>_("medium"),title:"中サイズプレビュー（2列表示）",children:(0,a.jsx)(D.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",className:(0,C.cn)("h-7 px-2 transition-colors","large"===Y&&"bg-[#20B2AA]/20 text-[#20B2AA] hover:bg-[#20B2AA]/30"),onClick:()=>_("large"),title:"大きいプレビュー（1列表示）",children:(0,a.jsx)(M.A,{className:"h-3 w-3"})})]})]}),(0,a.jsxs)("div",{className:(0,C.cn)("flex-col md:flex-row gap-2",u?"flex":"hidden"),children:[(0,a.jsxs)(S.l6,{value:v,onValueChange:y,children:[(0,a.jsx)(S.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(S.yv,{placeholder:"カテゴリ"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"すべて"}),(0,a.jsx)(S.eb,{value:"gaming",children:"ゲーム"}),(0,a.jsx)(S.eb,{value:"talk",children:"雑談"}),(0,a.jsx)(S.eb,{value:"singing",children:"歌枠"}),(0,a.jsx)(S.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(S.eb,{value:"event",children:"イベント"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]}),(0,a.jsxs)(S.l6,{value:b,onValueChange:N,children:[(0,a.jsx)(S.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(S.yv,{placeholder:"スタイル"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"すべて"}),(0,a.jsx)(S.eb,{value:"cute",children:"可愛い"}),(0,a.jsx)(S.eb,{value:"cool",children:"クール"}),(0,a.jsx)(S.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(S.eb,{value:"funny",children:"面白い"}),(0,a.jsx)(S.eb,{value:"simple",children:"シンプル"})]})]}),(0,a.jsxs)(S.l6,{value:k,onValueChange:F,children:[(0,a.jsx)(S.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(S.yv,{placeholder:"難易度"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"すべて"}),(0,a.jsx)(S.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(S.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(S.eb,{value:"advanced",children:"上級"})]})]})]})]}),el.length>0?u?(0,a.jsx)("div",{className:(0,C.cn)("grid gap-3",ei),children:el.map(e=>(0,a.jsx)(eS,{template:e,isSelected:s===e.id,isFavorite:X.has(e.id),onSelect:t,onToggleFavorite:er,onDelete:e.isCustom?en:void 0,previewSize:Y},e.id))}):(0,a.jsx)("div",{className:"-mx-2 flex snap-x snap-mandatory gap-3 overflow-x-auto pb-4 px-2 scrollbar-thin",children:el.map(e=>(0,a.jsx)(eS,{template:e,isSelected:s===e.id,isFavorite:X.has(e.id),onSelect:t,onToggleFavorite:er,onDelete:e.isCustom?en:void 0,previewSize:Y,isCompact:!0},e.id))}):(0,a.jsx)("div",{className:"text-center text-sm text-muted-foreground py-8",children:g.trim()?"検索結果が見つかりませんでした":"favorites"===Q?"お気に入りに登録されたテンプレートはありません":"この条件に一致するテンプレートはありません"}),L&&(0,a.jsx)(eC,{onCreateTemplate:e=>{let t=[...O,{id:"custom-".concat(Date.now()),name:e.name||"カスタムテンプレート",description:e.description||"",category:e.category||"custom",style:e.style||"simple",rating:0,preview:e.preview||"",supportedAspectRatios:["16:9","9:16","1:1","4:3"],layout:{background:{type:"color",value:"#FFFFFF"},objects:[{id:"text-main",type:"text",position:{x:340,y:285,width:600,height:150},content:{text:"新しいテキスト",fontSize:"4rem",fontFamily:"Arial, sans-serif",color:"#000000"},zIndex:1,visible:!0}]},colorPalette:{primary:"#000000",secondary:"#333333",accent:"#007bff",background:"#FFFFFF",text:"#000000",light:"#FFFFFF",dark:"#000000",muted:"#6c757d",highlight:"#007bff"},fontSettings:{family:"Arial, sans-serif",size:"4rem",weight:"normal",style:"normal",lineHeight:1.2,letterSpacing:"0.05em",textAlign:"center",textDecoration:"none",textShadow:"none"},settings:{defaultFontSize:"4rem",defaultFontFamily:"Arial, sans-serif",defaultTextColor:"#000000",defaultBackgroundColor:"#FFFFFF",maxObjects:20,minObjectSize:10,maxObjectSize:1e3,allowAnimation:!0,allowEffects:!0,allowVideo:!0,allowGif:!0,exportFormats:["png","jpg","webp","svg","pdf"],defaultExportFormat:"png",exportQuality:"high"},metadata:{version:"1.0.0",author:"User",tags:["custom","user-created"],difficulty:"beginner",estimatedTime:5,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},initialText:"新しいテキスト",initialTextColor:"#000000",initialFontSize:"4rem",isCustom:!0,createdAt:new Date().toISOString()}];P(t),G([...ey.k,...t]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(t)),q.oR.success("カスタムテンプレートを作成しました！"),J(!1)},onClose:()=>J(!1)})]})})]})]}):"manage"===H?(0,a.jsx)(es,{templates:O,onTemplatesChange:ec,onSelectTemplate:t,selectedTemplateId:s}):$.includes("auto-generate")?(0,a.jsx)(ef,{onTemplateGenerated:t,onTemplatesGenerated:e=>{ec([...O,...e])}}):null]})};var eF=s(44647),eL=s(38825),eR=s(15025),eE=s(30417),eT=s(5952),ez=s(58414),eI=s(5081),eD=s(62663);let eM={"youtube-standard":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"youtube",batchExport:!1,batchSizes:[]},"twitter-optimized":{resolution:"custom",customWidth:1200,customHeight:675,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"twitter",batchExport:!1,batchSizes:[]},"instagram-square":{resolution:"custom",customWidth:1080,customHeight:1080,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"instagram",batchExport:!1,batchSizes:[]},"batch-all-platforms":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"general",batchExport:!0,batchSizes:[{name:"YouTube",width:1920,height:1080,platform:"youtube"},{name:"Twitter",width:1200,height:675,platform:"twitter"},{name:"Instagram",width:1080,height:1080,platform:"instagram"},{name:"Facebook",width:1200,height:630,platform:"facebook"}]}},eJ={hd:{width:1280,height:720,label:"HD (1280\xd7720)"},fhd:{width:1920,height:1080,label:"FHD (1920\xd71080)"},"4k":{width:3840,height:2160,label:"4K (3840\xd72160)"},custom:{width:0,height:0,label:"カスタム"}},eO={low:{pixelRatio:1,quality:.6,label:"低品質 (軽量)"},medium:{pixelRatio:1.5,quality:.8,label:"中品質 (バランス)"},high:{pixelRatio:2,quality:.9,label:"高品質 (推奨)"},ultra:{pixelRatio:3,quality:1,label:"最高品質 (重い)"}},eP=e=>{let{onExport:t,isExporting:s}=e,[i,r]=(0,l.useState)(eM["youtube-standard"]),[o,m]=(0,l.useState)({}),[u,p]=(0,l.useState)(!1),[j,f]=(0,l.useState)(!1),[v,y]=(0,l.useState)(""),b=!(0,ej.U)("(min-width: 768px)");l.useEffect(()=>{let e=localStorage.getItem("thumbnailExportPresets");e&&m(JSON.parse(e))},[]);let k=e=>{r(t=>({...t,...e}))},R=e=>{let t=eM[e]||o[e];t&&(r(t),q.oR.success("プリセット「".concat(e,"」を適用しました")))},T=()=>{if(!v.trim())return void q.oR.error("プリセット名を入力してください");let e={...o,[v.trim()]:i};m(e),localStorage.setItem("thumbnailExportPresets",JSON.stringify(e)),q.oR.success("プリセット「".concat(v.trim(),"」を保存しました")),y(""),f(!1)},z=async()=>{try{await t(i)}catch(e){B.vF.error("エクスポート失敗",e,"ExportSettingsPanel")}},I="custom"===i.resolution?{width:i.customWidth||1920,height:i.customHeight||1080}:eJ[i.resolution];return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(F.Zp,{children:[(0,a.jsx)(F.aR,{className:"pb-3",children:(0,a.jsxs)(F.ZB,{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)(ec.A,{className:"h-4 w-4"}),"よく使う設定"]})}),(0,a.jsxs)(F.Wu,{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0] mb-2",children:"ワンクリックで主要プラットフォーム向けにエクスポート"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",size:b?"sm":"default",onClick:async()=>{await t({...i,resolution:"custom",customWidth:1200,customHeight:675,quality:"high",pixelRatio:2,format:"png",optimizeForPlatform:"twitter"})},className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-xs",children:"Twitter投稿"})]}),(0,a.jsxs)(n.$,{variant:"outline",size:b?"sm":"default",onClick:async()=>{await t({...i,resolution:"custom",customWidth:1280,customHeight:720,quality:"high",pixelRatio:2,format:"png",optimizeForPlatform:"youtube"})},className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-xs",children:"YouTubeサムネ"})]}),(0,a.jsxs)(n.$,{variant:"outline",size:b?"sm":"default",onClick:async()=>{await t({...i,resolution:"custom",customWidth:1920,customHeight:1080,quality:"high",pixelRatio:2,format:"png",optimizeForPlatform:"youtube"})},className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-xs",children:"YouTube HD"})]}),(0,a.jsxs)(n.$,{variant:"outline",size:b?"sm":"default",onClick:async()=>{await t({...i,resolution:"custom",customWidth:1080,customHeight:1080,quality:"high",pixelRatio:2,format:"png",optimizeForPlatform:"instagram"})},className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-xs",children:"Instagram"})]})]})]})]}),(0,a.jsxs)(F.Zp,{className:"w-full",children:[(0,a.jsx)(F.aR,{children:(0,a.jsxs)(F.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-5 w-5"}),"エクスポート設定"]})}),(0,a.jsxs)(F.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"プリセット"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(n.$,{variant:"fhd"!==i.resolution||i.batchExport?"outline":"default",size:b?"default":"sm",className:b?"h-10":"",onClick:()=>R("youtube-standard"),children:[(0,a.jsx)(eD.A,{className:"h-4 w-4 mr-1"}),"YouTube"]}),(0,a.jsxs)(n.$,{variant:"twitter"===i.optimizeForPlatform?"default":"outline",size:b?"default":"sm",className:b?"h-10":"",onClick:()=>R("twitter-optimized"),children:[(0,a.jsx)(eD.A,{className:"h-4 w-4 mr-1"}),"Twitter"]}),(0,a.jsxs)(n.$,{variant:"instagram"===i.optimizeForPlatform?"default":"outline",size:b?"default":"sm",className:b?"h-10":"",onClick:()=>R("instagram-square"),children:[(0,a.jsx)(eD.A,{className:"h-4 w-4 mr-1"}),"Instagram"]}),(0,a.jsxs)(n.$,{variant:i.batchExport?"default":"outline",size:b?"default":"sm",className:b?"h-10":"",onClick:()=>R("batch-all-platforms"),children:[(0,a.jsx)(ec.A,{className:"h-4 w-4 mr-1"}),"一括出力"]})]})]}),(0,a.jsx)(ea.w,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"解像度"}),(0,a.jsxs)(S.l6,{value:i.resolution,onValueChange:e=>k({resolution:e}),children:[(0,a.jsx)(S.bq,{className:b?"h-10":"",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"hd",children:"HD (1280\xd7720)"}),(0,a.jsx)(S.eb,{value:"fhd",children:"FHD (1920\xd71080)"}),(0,a.jsx)(S.eb,{value:"4k",children:"4K (3840\xd72160)"}),(0,a.jsx)(S.eb,{value:"custom",children:"カスタム"})]})]}),"custom"===i.resolution&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs",children:"幅 (px)"}),(0,a.jsx)(A.p,{type:"number",inputMode:"numeric",value:i.customWidth||1920,onChange:e=>k({customWidth:Number(e.target.value)}),min:"100",max:"8000",className:b?"h-10":""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs",children:"高さ (px)"}),(0,a.jsx)(A.p,{type:"number",inputMode:"numeric",value:i.customHeight||1080,onChange:e=>k({customHeight:Number(e.target.value)}),min:"100",max:"8000",className:b?"h-10":""})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"品質"}),(0,a.jsxs)(S.l6,{value:i.quality,onValueChange:e=>{let t=eO[e];k({quality:e,pixelRatio:t.pixelRatio})},children:[(0,a.jsx)(S.bq,{className:b?"h-10":"",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"low",children:"低品質 (軽量・1x)"}),(0,a.jsx)(S.eb,{value:"medium",children:"中品質 (バランス・1.5x)"}),(0,a.jsx)(S.eb,{value:"high",children:"高品質 (推奨・2x)"}),(0,a.jsx)(S.eb,{value:"ultra",children:"最高品質 (重い・3x)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"形式"}),(0,a.jsxs)(S.l6,{value:i.format,onValueChange:e=>k({format:e}),children:[(0,a.jsx)(S.bq,{className:b?"h-10":"",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"png",children:"PNG (高品質・透明対応)"}),(0,a.jsx)(S.eb,{value:"jpeg",children:"JPEG (軽量・写真向け)"})]})]})]})]}),i.batchExport&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(ea.w,{}),(0,a.jsx)("h4",{className:"font-medium",children:"バッチエクスポート"}),(0,a.jsx)("div",{className:"space-y-2",children:i.batchSizes.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-[#2D2D2D] rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-sm text-[#A0A0A0] ml-2",children:[e.width,"\xd7",e.height]})]}),(0,a.jsx)(L.E,{variant:"secondary",children:e.platform})]},t))})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(n.$,{variant:"ghost",size:"sm",onClick:()=>p(!u),className:"w-full",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"}),u?"詳細設定を隠す":"詳細設定を表示"]}),u&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-[#2D2D2D] rounded-lg",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"背景色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"color",value:i.backgroundColor||"#ffffff",onChange:e=>k({backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:i.backgroundColor||"#ffffff",onChange:e=>k({backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eI.S,{id:"transparency",checked:i.includeTransparency,onCheckedChange:e=>k({includeTransparency:!!e})}),(0,a.jsx)(w.J,{htmlFor:"transparency",className:"text-sm",children:"透明度を保持する"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(w.J,{className:"text-sm font-medium",children:["ピクセル比: ",i.pixelRatio,"x"]}),(0,a.jsx)(N.A,{value:[i.pixelRatio],onValueChange:e=>{let[t]=e;return k({pixelRatio:t})},min:.5,max:4,step:.5,className:"w-full"})]})]})]}),(0,a.jsx)(ea.w,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"出力情報"}),b?(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"解像度:"}),(0,a.jsxs)("span",{className:"font-medium",children:[I.width,"\xd7",I.height]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"形式:"}),(0,a.jsx)("span",{className:"font-medium",children:i.format.toUpperCase()})]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"解像度:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[I.width,"\xd7",I.height]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"形式:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:i.format.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"品質:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:eO[i.quality].label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#A0A0A0]",children:"ファイル数:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[i.batchExport?i.batchSizes.length:1,"個"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{onClick:z,disabled:s,className:(0,C.cn)("flex-1",b&&"h-11"),children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2 animate-spin"}),"エクスポート中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"エクスポート"]})}),(0,a.jsxs)(H.lG,{open:j,onOpenChange:f,children:[(0,a.jsx)(H.zM,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",disabled:s,className:b?"h-11 px-3":"",children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-1"}),b?"":"保存"]})}),(0,a.jsxs)(H.Cf,{className:"bg-[#2D2D2D] border-[#4A4A4A]",children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{className:"text-[#E0E0E0]",children:"プリセットを保存"}),(0,a.jsx)(H.rr,{className:"text-[#A0A0A0]",children:"現在の設定をプリセットとして保存します"})]}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"preset-name",className:"text-sm text-[#E0E0E0]",children:"プリセット名"}),(0,a.jsx)(A.p,{id:"preset-name",value:v,onChange:e=>y(e.target.value),placeholder:"プリセット名を入力",className:"mt-2 bg-[#1A1A1A] border-[#4A4A4A] text-[#E0E0E0]",onKeyDown:e=>{"Enter"===e.key&&v.trim()&&T()},autoFocus:!0})]})}),(0,a.jsxs)(H.Es,{children:[(0,a.jsx)(n.$,{variant:"outline",onClick:()=>{f(!1),y("")},className:"border-[#4A4A4A] text-[#E0E0E0] hover:bg-[#3A3A3A]",children:"キャンセル"}),(0,a.jsx)(n.$,{onClick:T,disabled:!v.trim(),className:"bg-[#20B2AA] hover:bg-[#20B2AA]/90 text-white",children:"保存"})]})]})]})]})]})]})]})};var eq=s(73308),eB=s(44909),eG=s(65724),e$=s(17550),eU=s(45185),eW=s(20791),eV=s(49752),eH=s(90584),eZ=s(26059);let eX="thumbnail-generator-projects",eK=()=>{try{let e=localStorage.getItem(eX);if(e)return JSON.parse(e)}catch(e){console.error("プロジェクトリストの読み込みに失敗しました:",e)}return{projects:[],lastSavedProjectId:null}},eY=e=>{try{localStorage.setItem(eX,JSON.stringify(e))}catch(e){throw console.error("プロジェクトリストの保存に失敗しました:",e),e}},e_=async function(e,t,s,a,l){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=null;try{let e=document.getElementById("thumbnail-preview");e&&(r=await (0,eZ.$E)(e,{width:320,height:180,pixelRatio:1,cacheBust:!1}))}catch(e){console.error("サムネイル生成に失敗しました:",e)}let n={id:i?"autosave-".concat(Date.now()):"project-".concat(Date.now()),name:e,layers:JSON.parse(JSON.stringify(t)),selectedLayerId:s,templateId:a,aspectRatio:l,thumbnail:r,createdAt:Date.now(),updatedAt:Date.now(),isAutoSave:i},c=eK();if(i){c.projects=c.projects.filter(e=>!e.isAutoSave),c.projects.push(n);let e=c.projects.filter(e=>e.isAutoSave);if(e.length>10){e.sort((e,t)=>e.updatedAt-t.updatedAt);let t=e.slice(0,e.length-10);c.projects=c.projects.filter(e=>!t.includes(e))}}else{let e=c.projects.findIndex(e=>e.id===n.id);e>=0?c.projects[e]=n:c.projects.push(n),c.lastSavedProjectId=n.id}return c.projects.sort((e,t)=>t.updatedAt-e.updatedAt),eY(c),n},eQ=e=>{let t=eK().projects.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null},e0=e=>{let{onLoadProject:t,currentProjectName:s,onProjectSaved:i}=e,[r,c]=(0,l.useState)([]),[o,d]=(0,l.useState)(null),[x,m]=(0,l.useState)(""),[h,u]=(0,l.useState)(""),[p,g]=(0,l.useState)("all"),j=(0,ej.U)("(min-width: 768px)"),f=()=>{c(eK().projects)};(0,l.useEffect)(()=>{f()},[]);let v=(0,l.useMemo)(()=>{let e=r;if("manual"===p?e=e.filter(e=>!e.isAutoSave):"autosave"===p&&(e=e.filter(e=>e.isAutoSave)),h.trim()){let t=h.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t))}return e},[r,p,h]),y=e=>{d(e.id),m(e.name)},b=()=>{d(null),m("")},N=e=>{if(!x.trim())return void q.oR.error("プロジェクト名を入力してください");((e,t)=>{let s=eK(),a=s.projects.find(t=>t.id===e);a&&(a.name=t,a.updatedAt=Date.now(),s.projects.sort((e,t)=>t.updatedAt-e.updatedAt),eY(s))})(e,x.trim()),d(null),m(""),f(),q.oR.success("プロジェクト名を更新しました")},w=(e,t)=>{confirm("プロジェクト「".concat(t,"」を削除しますか？"))&&((e=>{let t=eK();t.projects=t.projects.filter(t=>t.id!==e),t.lastSavedProjectId===e&&(t.lastSavedProjectId=null),eY(t)})(e),f(),q.oR.success("プロジェクトを削除しました"))},S=e=>{let t=(e=>{let t=eQ(e);if(!t)return null;let s={...t,id:"project-".concat(Date.now()),name:"".concat(t.name," (コピー)"),createdAt:Date.now(),updatedAt:Date.now(),isAutoSave:!1},a=eK();return a.projects.push(s),a.projects.sort((e,t)=>t.updatedAt-e.updatedAt),eY(a),s})(e);t&&(f(),q.oR.success("プロジェクト「".concat(t.name,"」を作成しました")))},k=e=>{let s=eQ(e);s?(t(s),q.oR.success("プロジェクト「".concat(s.name,"」を読み込みました"))):q.oR.error("プロジェクトの読み込みに失敗しました")},L=e=>new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),R=e=>{let t=Date.now()-e,s=Math.floor(t/6e4),a=Math.floor(t/36e5),l=Math.floor(t/864e5);return s<1?"たった今":s<60?"".concat(s,"分前"):a<24?"".concat(a,"時間前"):l<7?"".concat(l,"日前"):L(e)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"プロジェクト管理"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(A.p,{placeholder:"プロジェクトを検索...",value:h,onChange:e=>u(e.target.value),className:"h-9"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"all"===p?"default":"outline",size:"sm",onClick:()=>g("all"),className:"flex-1",children:"すべて"}),(0,a.jsx)(n.$,{variant:"manual"===p?"default":"outline",size:"sm",onClick:()=>g("manual"),className:"flex-1",children:"手動保存"}),(0,a.jsx)(n.$,{variant:"autosave"===p?"default":"outline",size:"sm",onClick:()=>g("autosave"),className:"flex-1",children:"自動保存"})]})]}),0===v.length?(0,a.jsx)("div",{className:"text-center text-sm text-muted-foreground py-8",children:h.trim()?"検索結果が見つかりませんでした":"autosave"===p?"自動保存されたプロジェクトはありません":"保存されたプロジェクトはありません"}):(0,a.jsx)(a.Fragment,{children:j?(0,a.jsx)(V.F,{className:"h-[calc(100vh-400px)]",children:(0,a.jsx)("div",{className:"space-y-2",children:v.map(e=>(0,a.jsx)(F.Zp,{className:(0,C.cn)("cursor-pointer hover:border-[#20B2AA] transition-all duration-200 group",s===e.name&&"border-2 border-[#20B2AA]"),onClick:()=>k(e.id),children:(0,a.jsx)(F.Wu,{className:"p-3",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:e.thumbnail?(0,a.jsx)("img",{src:e.thumbnail,alt:e.name,className:"w-16 h-9 object-cover rounded bg-[#2D2D2D]"}):(0,a.jsx)("div",{className:"w-16 h-9 bg-[#2D2D2D] rounded flex items-center justify-center",children:(0,a.jsx)(eB.A,{className:"h-4 w-4 text-[#A0A0A0]"})})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:o===e.id?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(A.p,{value:x,onChange:e=>m(e.target.value),onClick:e=>e.stopPropagation(),onKeyDown:t=>{"Enter"===t.key?N(e.id):"Escape"===t.key&&b()},className:"h-8 text-sm flex-1",autoFocus:!0}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),N(e.id)},className:"h-8 w-8 p-0",children:(0,a.jsx)(e$.A,{className:"h-4 w-4"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:e=>{e.stopPropagation(),b()},className:"h-8 w-8 p-0",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("h4",{className:"font-medium text-sm truncate flex-1",children:[e.name,e.isAutoSave&&(0,a.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(自動保存)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),y(e)},className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(eU.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),S(e.id)},className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(eW.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),w(e.id,e.name)},className:"h-7 w-7 p-0 text-red-400 hover:text-red-300 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(Y.A,{className:"h-3 w-3"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eV.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:L(e.updatedAt)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eH.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:R(e.updatedAt)})]}),(0,a.jsxs)("span",{children:[e.layers.length,"レイヤー"]})]})]})})]})})},e.id))})}):(0,a.jsx)("div",{className:"-mx-2 flex snap-x snap-mandatory gap-3 overflow-x-auto pb-4 px-2 scrollbar-thin",children:v.map(e=>(0,a.jsx)(F.Zp,{className:(0,C.cn)("cursor-pointer hover:border-[#20B2AA] transition-all duration-200 group shrink-0 snap-center",s===e.name&&"border-2 border-[#20B2AA]"),style:{width:"min(85vw, 340px)"},onClick:()=>k(e.id),children:(0,a.jsx)(F.Wu,{className:"p-3 space-y-3",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:e.thumbnail?(0,a.jsx)("img",{src:e.thumbnail,alt:e.name,className:"w-20 h-12 object-cover rounded bg-[#2D2D2D]"}):(0,a.jsx)("div",{className:"w-20 h-12 bg-[#2D2D2D] rounded flex items-center justify-center",children:(0,a.jsx)(eB.A,{className:"h-4 w-4 text-[#A0A0A0]"})})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:o===e.id?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(A.p,{value:x,onChange:e=>m(e.target.value),onClick:e=>e.stopPropagation(),onKeyDown:t=>{"Enter"===t.key?N(e.id):"Escape"===t.key&&b()},className:"h-9 text-sm flex-1",autoFocus:!0}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),N(e.id)},className:"h-9 w-9 p-0",children:(0,a.jsx)(e$.A,{className:"h-4 w-4"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:e=>{e.stopPropagation(),b()},className:"h-9 w-9 p-0",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("h4",{className:"font-medium text-sm truncate flex-1",children:[e.name,e.isAutoSave&&(0,a.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(自動保存)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),y(e)},className:"h-8 w-8 p-0 text-muted-foreground",children:(0,a.jsx)(eU.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),S(e.id)},className:"h-8 w-8 p-0 text-muted-foreground",children:(0,a.jsx)(eW.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.$,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),w(e.id,e.name)},className:"h-8 w-8 p-0 text-red-400 hover:text-red-300",children:(0,a.jsx)(Y.A,{className:"h-3 w-3"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eV.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:L(e.updatedAt)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eH.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:R(e.updatedAt)})]}),(0,a.jsxs)("span",{children:[e.layers.length,"レイヤー"]})]})]})})]})})},e.id))})})]})},e1=e=>{let{isDesktop:t,isSidebarOpen:s,setIsSidebarOpen:i,layers:r,updateLayer:n,removeLayer:c,selectedLayerId:o,setSelectedLayerId:d,reorderLayers:x,duplicateLayer:m,addLayer:h,moveLayerUp:u,moveLayerDown:p,selectedTemplate:g,setSelectedTemplate:f,onShapeSelect:v,onLoadProject:b,currentProjectName:N,onProjectSaved:w}=e,[A,S]=l.useState("templates"),C=(0,a.jsxs)("div",{className:"h-full flex flex-col min-w-0 max-w-full overflow-x-hidden",children:[(0,a.jsx)("div",{className:"p-3 border-b border-[#4A4A4A] min-w-0",children:(0,a.jsx)("h2",{className:"text-base font-semibold text-[#A0A0A0] truncate",children:"素材・レイヤー"})}),(0,a.jsxs)(j.tU,{value:A,onValueChange:S,className:"flex-1 flex flex-col min-w-0",children:[(0,a.jsxs)(j.j7,{className:"grid w-10/12 grid-cols-3 mx-auto mt-4 min-w-0",children:[(0,a.jsxs)(j.Xi,{value:"templates",className:"text-xs p-2 min-w-0 flex-col gap-2 max-w-full",children:[(0,a.jsx)(eB.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"素材"})]}),(0,a.jsxs)(j.Xi,{value:"layers",className:"text-xs p-2 min-w-0 flex-col gap-2 max-w-full",children:[(0,a.jsx)(eG.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"レイヤー"})]}),(0,a.jsxs)(j.Xi,{value:"projects",className:"text-xs p-2 min-w-0 flex-col gap-2 max-w-full",children:[(0,a.jsx)(P.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"プロジェクト"})]})]}),(0,a.jsx)(j.av,{value:"templates",className:"flex-1 px-3 pb-3 pt-2 mt-8 min-w-0 max-w-full overflow-x-hidden overflow-y-auto",children:(0,a.jsx)("div",{className:"min-w-0 max-w-full",children:(0,a.jsx)(ek,{onSelectTemplate:f,selectedTemplateId:(null==g?void 0:g.id)||null})})}),(0,a.jsx)(j.av,{value:"layers",className:"flex-1 px-3 pb-3 pt-2 mt-8 min-w-0 max-w-full overflow-x-hidden overflow-y-auto",children:(0,a.jsx)("div",{className:"min-w-0 max-w-full",children:(0,a.jsx)(ez.G,{context:{layers:r,updateLayer:n,removeLayer:c,selectedLayerId:o,setSelectedLayerId:d,reorderLayers:x,duplicateLayer:m,addLayer:h,moveLayerUp:u,moveLayerDown:p},onShapeSelect:v,showShapeSelector:!0})})}),(0,a.jsx)(j.av,{value:"projects",className:"flex-1 px-3 pb-3 pt-2 mt-8 min-w-0 max-w-full overflow-x-hidden overflow-y-auto",children:(0,a.jsx)("div",{className:"min-w-0 max-w-full",children:(0,a.jsx)(e0,{onLoadProject:b||(()=>{}),currentProjectName:N,onProjectSaved:w})})})]})]});return t?(0,a.jsx)("div",{className:"w-1/5 border-r border-[#4A4A4A] bg-[#1A1A1A] overflow-y-auto overflow-x-hidden",children:C}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.R,{onOpen:()=>i(!0),className:"fixed top-4 left-4 z-40 lg:hidden"}),(0,a.jsx)(y.B,{isOpen:s,onClose:()=>i(!1),title:"素材・レイヤー",children:C})]})},e2=e=>{let{isDesktop:t,isSidebarOpen:s,setIsSidebarOpen:i,isExporting:r,renderToolsPanel:n,handleAdvancedExport:c,handleAddShape:o,selectedTab:d,setSelectedTab:x}=e,[m,h]=l.useState("tools"),u=(0,a.jsxs)("div",{className:"h-full flex flex-col min-w-0 max-w-full overflow-x-hidden",children:[(0,a.jsx)("div",{className:"p-3 border-b border-[#4A4A4A] min-w-0",children:(0,a.jsx)("h2",{className:"text-base font-semibold text-[#A0A0A0] truncate",children:"編集・エクスポート"})}),(0,a.jsxs)(j.tU,{value:null!=d?d:m,onValueChange:null!=x?x:h,className:"flex-1 flex flex-col min-w-0",children:[(0,a.jsxs)(j.j7,{className:"grid w-10/12 grid-cols-2 mx-auto mt-4 min-w-0",children:[(0,a.jsxs)(j.Xi,{value:"tools",className:"text-xs p-2 min-w-0 flex-col gap-2 max-w-full",children:[(0,a.jsx)(E.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"編集"})]}),(0,a.jsxs)(j.Xi,{value:"export",className:"text-xs p-2 min-w-0 flex-col gap-2 max-w-full",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"エクスポート"})]})]}),(0,a.jsx)(j.av,{value:"tools",className:"flex-1 px-3 pb-3 pt-2 mt-8 min-w-0 max-w-full overflow-x-hidden overflow-y-auto",children:(0,a.jsx)("div",{className:"min-w-0 max-w-full",children:n()})}),(0,a.jsx)(j.av,{value:"export",className:"flex-1 px-3 pb-3 pt-2 mt-8 min-w-0 max-w-full overflow-x-hidden overflow-y-auto",children:(0,a.jsx)("div",{className:"min-w-0 max-w-full",children:(0,a.jsx)(eP,{onExport:c,isExporting:r})})})]})]});return t?(0,a.jsx)("div",{className:"w-1/5 border-l border-[#4A4A4A] bg-[#1A1A1A] overflow-y-auto overflow-x-hidden",children:u}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.R,{onOpen:()=>i(!0),className:"fixed top-4 right-4 z-40 lg:hidden"}),(0,a.jsx)(y.B,{isOpen:s,onClose:()=>i(!1),title:"編集・エクスポート",children:u})]})};var e4=s(12786),e3=s(17410),e5=s(40369),e8=s(51431),e6=s(11860);let e9=()=>{let[e,t]=(0,l.useState)("tools"),[s,a]=(0,l.useState)(!1),[i,r]=(0,l.useState)(!1),[n,c]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!0),[x,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(20),[j,f]=(0,l.useState)("rgba(136, 218, 255, 0.25)"),[v,y]=(0,l.useState)(.6),[b,N]=(0,l.useState)(!0),[w,A]=(0,l.useState)(5),[S,C]=(0,l.useState)(!1),[k,F]=(0,l.useState)(8),[L,R]=(0,l.useState)(!1);return{selectedTab:e,setSelectedTab:t,isShiftKeyDown:s,setIsShiftKeyDown:a,isPreviewDedicatedMode:i,setIsPreviewDedicatedMode:r,showGrid:n,setShowGrid:c,showAspectGuide:o,setShowAspectGuide:d,showSafeArea:x,setShowSafeArea:m,showCenterLines:h,setShowCenterLines:u,gridSize:p,setGridSize:g,gridColor:j,setGridColor:f,gridOpacity:v,setGridOpacity:y,showMajorLines:b,setShowMajorLines:N,majorInterval:w,setMajorInterval:A,snapToGrid:S,setSnapToGrid:C,snapStrength:k,setSnapStrength:F,shadowEnabled:L,setShadowEnabled:R}};var e7=s(47739);let te=()=>{let e=(0,i.S)(),[t,s]=(0,l.useState)(1),a=(0,ej.U)("(min-width: 1024px)"),r=(0,l.useRef)({layers:e.layers,selectedLayerId:e.selectedLayerId}),[n,c]=(0,l.useState)([{id:"initial-".concat(Date.now()),timestamp:Date.now(),actionType:"initial",description:"初期状態",layers:e.layers,selectedLayerId:e.selectedLayerId}]),o=(0,l.useRef)(0),[d,x]=(0,l.useState)(0),[m,h]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1),g=(0,l.useRef)(!1),j=(0,l.useRef)(null);console.log("useEditorState initialized:",{historyLength:n.length,historyIndex:o.current,canUndo:m,canRedo:u,layers:e.layers.length});let f=(0,l.useCallback)((e,t)=>{if(g.current)return;console.log("Adding to history:",{layers:e.length,selectedLayerId:t}),j.current&&clearTimeout(j.current);let s=r.current.layers,a=r.current.selectedLayerId,{type:l,description:i}=(0,e7.U)(s,e,a,t),n={id:"".concat(l,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:Date.now(),actionType:l,description:i,layers:[...e],selectedLayerId:t};c(s=>{let a=s.slice(0,o.current+1);return a.push(n),a.length>50?(a.shift(),o.current=Math.max(0,o.current-1)):o.current+=1,x(o.current),h(o.current>0),p(!1),console.log("History updated:",{totalHistory:a.length,currentIndex:o.current,canUndo:o.current>0,canRedo:!1,description:i}),r.current={layers:e,selectedLayerId:t},a})},[]),v=(0,l.useCallback)(t=>{if(t<0||t>=n.length)return void console.error("Invalid history index:",t,"history length:",n.length);let s=n[t];if(!s)return void console.error("History entry not found at index:",t);o.current=t,x(t),g.current=!0,h(t>0),p(t<n.length-1),console.log("Jumping to history index:",t,"layers:",s.layers.length),e.restoreState(s.layers,s.selectedLayerId),r.current={layers:s.layers,selectedLayerId:s.selectedLayerId},setTimeout(()=>{g.current=!1},100)},[n,e]),y=(0,l.useCallback)(()=>{if(console.log("handleUndo called:",{currentIndex:o.current,historyLength:n.length,canUndo:m}),o.current>=n.length&&(console.log("Index out of bounds, adjusting to:",n.length-1),o.current=n.length-1),o.current>0&&o.current<n.length){let t=o.current-1;if(t>=0&&t<n.length){let s=n[t];return s?(o.current=t,x(t),g.current=!0,h(t>0),p(!0),console.log("Undoing to index:",t,"layers:",s.layers.length),e.restoreState(s.layers,s.selectedLayerId),r.current={layers:s.layers,selectedLayerId:s.selectedLayerId},setTimeout(()=>{g.current=!1},100),s):(console.error("History state not found at index:",t,{history:n,newIndex:t,currentIndex:o.current}),null)}console.error("Invalid newIndex:",t,"history length:",n.length)}return null},[n,e,m]),b=(0,l.useCallback)(()=>{if(console.log("handleRedo called:",{currentIndex:o.current,historyLength:n.length,canRedo:u}),o.current>=n.length&&(console.log("Index out of bounds, adjusting to:",n.length-1),o.current=n.length-1),o.current>=0&&o.current<n.length-1){let t=o.current+1;if(t>=0&&t<n.length){let s=n[t];return s?(o.current=t,x(t),g.current=!0,h(!0),p(t<n.length-1),console.log("Redoing to index:",t,"layers:",s.layers.length),e.restoreState(s.layers,s.selectedLayerId),r.current={layers:s.layers,selectedLayerId:s.selectedLayerId},setTimeout(()=>{g.current=!1},100),s):(console.error("History state not found at index:",t,{history:n,newIndex:t,currentIndex:o.current}),null)}console.error("Invalid newIndex:",t,"history length:",n.length)}return null},[n,e]);return{selectedTemplate:e.selectedTemplate,setSelectedTemplate:e.setSelectedTemplate,currentText:e.currentText,setCurrentText:e.setCurrentText,layers:e.layers,addLayer:e.addLayer,removeLayer:e.removeLayer,updateLayer:e.updateLayer,selectedLayerId:e.selectedLayerId,setSelectedLayerId:e.setSelectedLayerId,reorderLayers:e.reorderLayers,duplicateLayer:e.duplicateLayer,moveLayerUp:e.moveLayerUp,moveLayerDown:e.moveLayerDown,handleAddShape:(0,l.useCallback)(t=>{let s=e.layers.filter(e=>"shape"===e.type).length*(a?20:5),l=e.layers.filter(e=>"shape"===e.type&&"shapeType"in e&&e.shapeType===t).length+1,i="",r=a?550:10,n=a?250:10;switch(t){case"rectangle":i="四角 ".concat(l);break;case"circle":i="円 ".concat(l);break;case"line":i="線 ".concat(l);break;case"arrow":i="矢印 ".concat(l)}e.addLayer({type:"shape",shapeType:t,name:i,visible:!0,locked:!1,x:r+s,y:n+s,width:"line"===t||"arrow"===t?a?300:100:a?300:50,height:"line"===t||"arrow"===t?a?5:3:a?300:50,backgroundColor:"#cccccc",borderColor:"#000000",borderWidth:a?2:1})},[e.addLayer,e.layers,a]),aspectRatio:e.aspectRatio,setAspectRatio:e.setAspectRatio,customAspectRatio:e.customAspectRatio,setCustomAspectRatio:e.setCustomAspectRatio,zoom:t,setZoom:s,addToHistory:f,canUndo:m,canRedo:u,handleUndo:y,handleRedo:b,history:n,historyIndex:d,jumpToHistory:v}},tt=[{keys:["Ctrl","Z"],description:"元に戻す",category:"basic"},{keys:["Ctrl","Y"],description:"やり直し",category:"basic"},{keys:["Ctrl","Shift","Z"],description:"やり直し（別パターン）",category:"basic"},{keys:["Ctrl","S"],description:"プロジェクトを保存",category:"basic"},{keys:["?"],description:"ショートカット一覧を表示",category:"basic"},{keys:["Esc"],description:"選択を解除",category:"basic"},{keys:["Delete"],description:"レイヤーを削除",category:"layer"},{keys:["Backspace"],description:"レイヤーを削除（別パターン）",category:"layer"},{keys:["Ctrl","D"],description:"レイヤーを複製",category:"layer"},{keys:["Ctrl","↑"],description:"レイヤーを上に移動",category:"layer"},{keys:["Ctrl","↓"],description:"レイヤーを下に移動",category:"layer"},{keys:["G"],description:"グリッド表示の切り替え",category:"view"},{keys:["S"],description:"セーフエリア表示の切り替え",category:"view"},{keys:["C"],description:"中央線表示の切り替え",category:"view"},{keys:["Ctrl","0"],description:"画面にフィット",category:"view"},{keys:["Ctrl","+"],description:"ズームイン",category:"view"},{keys:["Ctrl","-"],description:"ズームアウト",category:"view"},{keys:["Ctrl",","],description:"ズームをリセット（100%）",category:"view"}],ts={basic:"基本操作",layer:"レイヤー操作",view:"表示設定",export:"エクスポート"},ta={Ctrl:"Ctrl",Shift:"Shift",Alt:"Alt",Meta:"⌘",Esc:"Esc",Delete:"Del",Backspace:"⌫","↑":"↑","↓":"↓","←":"←","→":"→","+":"+","-":"-",0:"0",",":",","?":"?",G:"G",S:"S",C:"C",Z:"Z",Y:"Y",D:"D"},tl=e=>{let{open:t,onOpenChange:s}=e,i=l.useMemo(()=>{let e={basic:[],layer:[],view:[],export:[]};return tt.forEach(t=>{e[t.category].push(t)}),e},[]);return(0,a.jsx)(H.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(H.Cf,{className:"max-w-2xl max-h-[80vh] overflow-y-auto bg-[#1A1A1A] border border-[#4A4A4A]",children:[(0,a.jsx)(H.c7,{children:(0,a.jsx)(H.L3,{className:"text-xl font-semibold text-[#E0E0E0]",children:"キーボードショートカット"})}),(0,a.jsx)("div",{className:"space-y-6 py-4",children:Object.entries(i).map(e=>{let[t,s]=e;return 0===s.length?null:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-[#A0A0A0] mb-3",children:ts[t]}),(0,a.jsx)("div",{className:"space-y-2",children:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded hover:bg-[#2D2D2D] transition-colors",children:[(0,a.jsx)("span",{className:"text-sm text-[#E0E0E0]",children:e.description}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:e.keys.map((t,s)=>(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)(L.E,{variant:"outline",className:(0,C.cn)("text-xs font-mono px-2 py-1 min-w-[32px] text-center","bg-[#2D2D2D] border-[#4A4A4A] text-[#E0E0E0]","font-semibold"),children:(e=>ta[e]||e.toUpperCase())(t)}),s<e.keys.length-1&&(0,a.jsx)("span",{className:"text-[#A0A0A0] text-xs mx-1",children:"+"})]},s))})]},t))}),"export"!==t&&(0,a.jsx)(ea.w,{className:"mt-4 bg-[#4A4A4A]"})]},t)})}),(0,a.jsx)("div",{className:"pt-4 border-t border-[#4A4A4A]",children:(0,a.jsx)("p",{className:"text-xs text-[#A0A0A0] text-center",children:"\uD83D\uDCA1 ヒント: キーボードショートカットで作業効率を向上させましょう"})})]})})},ti="customThumbnailTemplates",tr=[{id:"youtube",label:"YouTube サムネイル",sizeLabel:"1280 \xd7 720 px",description:"16:9 標準 / 推奨解像度",width:1280,height:720,platform:"youtube",Icon:c.A},{id:"youtube-hd",label:"YouTube HD",sizeLabel:"1920 \xd7 1080 px",description:"16:9 高解像度 / プレミア公開に最適",width:1920,height:1080,platform:"youtube",Icon:o.A},{id:"twitter",label:"X（Twitter）投稿",sizeLabel:"1200 \xd7 675 px",description:"16:9 横長 / TLで切れにくいサイズ",width:1200,height:675,platform:"twitter",Icon:d.A},{id:"instagram-square",label:"Instagram 正方形",sizeLabel:"1080 \xd7 1080 px",description:"1:1 / フィード投稿に最適",width:1080,height:1080,platform:"instagram",Icon:x.A},{id:"instagram-story",label:"Instagram ストーリーズ",sizeLabel:"1080 \xd7 1920 px",description:"9:16 縦長 / Reelsにも対応",width:1080,height:1920,platform:"instagram",Icon:m.A}],tn={medium:{label:"標準",description:"容量と画質のバランス",quality:"medium",pixelRatio:1.5},high:{label:"高品質",description:"細部までくっきり",quality:"high",pixelRatio:2}},tc=()=>{var e,t;let r=e9(),o=(()=>{let[e,t]=(0,l.useState)(!1),a=async e=>{try{console.log("handleAdvancedExport called with settings:",e),t(!0);let s=document.getElementById("thumbnail-preview");if(console.log("Found element:",s),!s)return void q.oR.error("プレビュー要素が見つかりません");e.batchExport?(console.log("Executing batch export"),await r(s,e)):(console.log("Executing single export"),await i(s,e))}catch(e){throw console.error("エクスポートエラー:",e),q.oR.error("エクスポートに失敗しました"),e}finally{t(!1)}},i=async(e,t)=>{try{let a,l,i={low:{pixelRatio:1,quality:.6},medium:{pixelRatio:1.5,quality:.8},high:{pixelRatio:2,quality:.9},ultra:{pixelRatio:3,quality:1}}[t.quality],r="custom"===t.resolution?{width:t.customWidth||1920,height:t.customHeight||1080}:({hd:{width:1280,height:720},fhd:{width:1920,height:1080},"4k":{width:3840,height:2160}})[t.resolution],n={cacheBust:!1,pixelRatio:t.pixelRatio||i.pixelRatio,quality:"png"===t.format?1:i.quality,backgroundColor:t.backgroundColor||"#ffffff",width:r.width,height:r.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===t.format)a=await (0,eZ.$E)(e,n),l="thumbnail.png";else if("jpeg"===t.format){let{toJpeg:t}=await Promise.resolve().then(s.bind(s,26059));a=await t(e,n),l="thumbnail.jpg"}else a=await (0,eZ.$E)(e,n),l="thumbnail.png";let c=document.createElement("a");c.download=l,c.href=a,c.click(),q.oR.success("エクスポートが完了しました")}catch(e){throw console.error("単一エクスポートエラー:",e),e}},r=async(e,t)=>{try{if(console.log("handleBatchExport called with settings:",t),t.batchSizes&&t.batchSizes.length>0){console.log("Processing batch sizes:",t.batchSizes);let a=t.batchSizes.map(async(a,l)=>{let i,r;console.log("Processing batch ".concat(l+1,"/").concat(t.batchSizes.length,":"),a);let n={low:{pixelRatio:1,quality:.6},medium:{pixelRatio:1.5,quality:.8},high:{pixelRatio:2,quality:.9},ultra:{pixelRatio:3,quality:1}}[t.quality],c={cacheBust:!1,pixelRatio:t.pixelRatio||n.pixelRatio,quality:"png"===t.format?1:n.quality,backgroundColor:t.backgroundColor||"#ffffff",width:a.width,height:a.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===t.format)console.log("Exporting PNG for ".concat(a.name)),i=await (0,eZ.$E)(e,c),r="thumbnail_".concat(a.name,".png");else if("jpeg"===t.format){console.log("Exporting JPEG for ".concat(a.name));let{toJpeg:t}=await Promise.resolve().then(s.bind(s,26059));i=await t(e,c),r="thumbnail_".concat(a.name,".jpg")}else console.log("Exporting PNG (WebP fallback) for ".concat(a.name)),i=await (0,eZ.$E)(e,c),r="thumbnail_".concat(a.name,".png");console.log("Creating download link for ".concat(r));let o=document.createElement("a");return o.download=r,o.href=i,o.click(),r});console.log("Waiting for all batch exports to complete...");let l=await Promise.all(a);console.log("All batch exports completed:",l),q.oR.success("".concat(l.length,"件のエクスポートが完了しました"))}else{let a=[t.format],l=[t.quality];for(let i of a)for(let a of l){let l,r,n={low:{pixelRatio:1,quality:.6},medium:{pixelRatio:1.5,quality:.8},high:{pixelRatio:2,quality:.9},ultra:{pixelRatio:3,quality:1}}[a],c="custom"===t.resolution?{width:t.customWidth||1920,height:t.customHeight||1080}:({hd:{width:1280,height:720},fhd:{width:1920,height:1080},"4k":{width:3840,height:2160}})[t.resolution],o={cacheBust:!1,pixelRatio:t.pixelRatio||n.pixelRatio,quality:"png"===i?1:n.quality,backgroundColor:t.backgroundColor||"#ffffff",width:c.width,height:c.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===i)l=await (0,eZ.$E)(e,o),r="thumbnail_".concat(a,".png");else if("jpeg"===i){let{toJpeg:t}=await Promise.resolve().then(s.bind(s,26059));l=await t(e,o),r="thumbnail_".concat(a,".jpg")}else l=await (0,eZ.$E)(e,o),r="thumbnail_".concat(a,".png");let d=document.createElement("a");d.download=r,d.href=l,d.click()}console.log("Fallback batch export completed"),q.oR.success("".concat(a.length*l.length,"件のエクスポートが完了しました"))}}catch(e){throw console.error("バッチエクスポートエラー:",e),e}finally{console.log("Batch export completed, resetting isExporting state")}},n=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"high";try{console.log("handleDownloadThumbnail called with quality:",e),t(!0);let s=document.getElementById("thumbnail-preview");if(console.log("Found element for download:",s),!s)return void q.oR.error("プレビュー要素が見つかりません");let a={normal:.8,high:1,super:2};console.log("Starting PNG export with quality:",a[e]);let l=await (0,eZ.$E)(s,{quality:a[e],pixelRatio:a[e],backgroundColor:"#ffffff"});console.log("PNG export completed, creating download link");let i=document.createElement("a");i.download="thumbnail_".concat(e,".png"),i.href=l,i.click(),q.oR.success("".concat(e,"品質でサムネイルをダウンロードしました"))}catch(e){console.error("サムネイルダウンロードエラー:",e),q.oR.error("ダウンロードに失敗しました")}finally{t(!1)}};return{isExporting:e,setIsExporting:t,handleAdvancedExport:a,handleSingleExport:i,handleBatchExport:r,handleDownloadThumbnail:n}})(),F=te(),L=(0,i.S)(),[R,E]=(0,l.useState)(""),[T,z]=(0,l.useState)(!1),[I,D]=(0,l.useState)(""),[M,J]=(0,l.useState)(null),O=(0,l.useRef)(null),[P,G]=(0,l.useState)(!1),[$,U]=(0,l.useState)("templates"),[W,V]=(0,l.useState)(0),[Z,X]=(0,l.useState)(!1),[K,Y]=(0,l.useState)("youtube"),[_,Q]=(0,l.useState)("png"),[ee,et]=(0,l.useState)("high"),[es,ea]=(0,l.useState)(!0),[el,ei]=(0,l.useState)(!1),{isOpen:er,setIsOpen:en,isDesktop:ec}=(0,f.c)({defaultOpen:!1,desktopDefaultOpen:!0}),{isOpen:eo,setIsOpen:ed}=(0,f.c)({defaultOpen:!1,desktopDefaultOpen:!0}),ex=l.useMemo(()=>!!ec||!P,[ec,P]),em=l.useMemo(()=>[...F.layers].sort((e,t)=>{var s,a;let l=null!=(s=e.zIndex)?s:0,i=null!=(a=t.zIndex)?a:0;return l===i?F.layers.indexOf(e)-F.layers.indexOf(t):l-i}),[F.layers]),eh=l.useMemo(()=>{var e;return null!=(e=tr.find(e=>e.id===K))?e:tr[0]},[K]),eu=l.useMemo(()=>tn[ee],[ee]),{handleAsyncError:ep}=(0,v.u)(),eg=F.layers.find(e=>e.id===F.selectedLayerId),ej=(0,l.useRef)(F.layers);(0,l.useEffect)(()=>{let e=F.layers,t=ej.current;console.log("=== LAYERS EFFECT TRIGGERED ==="),console.log("Layers effect triggered:",{prev:t.length,current:e.length,selectedLayerId:F.selectedLayerId,canUndo:F.canUndo,canRedo:F.canRedo,prevLayers:t.map(e=>({id:e.id,type:e.type})),currentLayers:e.map(e=>({id:e.id,type:e.type}))}),e.length!==t.length?(console.log("*** LAYERS COUNT CHANGED ***"),console.log("Layers count changed, saving to history:",{prev:t.length,current:e.length,selectedLayerId:F.selectedLayerId}),setTimeout(()=>{console.log("*** EXECUTING DELAYED HISTORY SAVE ***"),F.addToHistory(F.layers,F.selectedLayerId)},100)):console.log("Layers count unchanged, skipping history save"),ej.current=e,console.log("=== END LAYERS EFFECT ===")},[F.layers,F.selectedLayerId,F.addToHistory,F.canUndo,F.canRedo]);let[ev,ey]=l.useState(!1),[eb,eN]=l.useState(!1),[ew,eA]=l.useState("#ff0000"),[eS,eC]=l.useState("#0000ff"),[eI,eD]=l.useState(90),[eM,eJ]=l.useState(!1);l.useEffect(()=>{if(eg&&(0,e6.Nt)(eg))if(eg.textShadow&&"none"!==eg.textShadow?r.setShadowEnabled(!0):r.setShadowEnabled(!1),eg.textStrokeWidth&&"0px"!==eg.textStrokeWidth?eN(!0):eN(!1),eg.textGradient){ey(!0);let e=(e=>{let t=e.match(/linear-gradient\((\d+)deg,\s*(#[0-9a-fA-F]+),\s*(#[0-9a-fA-F]+)\)/);return t?{angle:parseInt(t[1]),color1:t[2],color2:t[3]}:{angle:90,color1:"#ff0000",color2:"#0000ff"}})(eg.textGradient);eA(e.color1),eC(e.color2),eD(e.angle)}else ey(!1);else r.setShadowEnabled(!1),eN(!1),ey(!1)},[eg,r]);let eO={ultraWide:.96,wide16_9:.96,wide4_3:.95,square:.9,portrait:.5,ultraPortrait:.9},eB=l.useCallback(e=>e>=2?eO.ultraWide:e>=1.5?eO.wide16_9:e>=1.2?eO.wide4_3:e>=.9?eO.square:e>=.6?eO.portrait:eO.ultraPortrait,[]),eG=l.useRef(400),[,e$]=l.useReducer(e=>e+1,0),eU=l.useCallback(()=>{let e,t,s,a=document.querySelector('[data-preview-container="true"]');if(!a)return 400;let l=a.getBoundingClientRect();if(l.width<=0||l.height<=0)return eG.current;if("custom"===F.aspectRatio)e=F.customAspectRatio.width/F.customAspectRatio.height;else{let[t,s]=(F.aspectRatio||"16:9").split(":").map(Number);e=t/s}let i=eB(e),r=Math.max((l.width-12)*i,200),n=Math.max((l.height-12)*i,150),c=r/e,o=n*e;return c<=n?(t=r,s=c):(t=o,s=n),B.vF.info("基準サイズ計算完了",{aspectRatio:F.aspectRatio,aspectRatioValue:e.toFixed(2),optimalSize:{width:t.toFixed(1),height:s.toFixed(1)},calculatedBaseSize:t.toFixed(1)},"calculateBaseSize"),t},[F.aspectRatio,F.customAspectRatio,ec,eB]);l.useEffect(()=>{eG.current=eU(),F.setZoom(1)},[F.aspectRatio,F.customAspectRatio,eU,F.setZoom]),l.useEffect(()=>{let e=0,t=()=>{if(e>=20)return void B.vF.warn("基準サイズの計算がタイムアウトしました",{},"updateBaseSizeWhenReady");let s=document.querySelector('[data-preview-container="true"]');if(!s){e++,setTimeout(t,50);return}let a=s.getBoundingClientRect();if(a.width<=0||a.height<=0){e++,setTimeout(t,50);return}let l=eU(),i=eG.current;(l>400||400===i)&&(eG.current=l,F.setZoom(1),e$(),B.vF.info("初期基準サイズを更新しました",{baseSize:l,previousSize:i,containerSize:{width:a.width,height:a.height},aspectRatio:F.aspectRatio},"updateBaseSizeWhenReady"))},s=setTimeout(t,100);return()=>{clearTimeout(s)}},[eU,F.setZoom,er,eo,r.isPreviewDedicatedMode]),l.useEffect(()=>{let e,t=()=>{eG.current=eU(),F.setZoom(1)},s=()=>{clearTimeout(e),e=setTimeout(t,150)};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),clearTimeout(e)}},[eU,F.setZoom]);let eW=l.useCallback(()=>{F.setZoom(1)},[F.setZoom]);l.useEffect(()=>{let e=e=>{if(e.ctrlKey||e.metaKey){e.preventDefault();let t=e.deltaY>0?"out":"in",s=[.1,.25,.5,.75,1,1.5,2,3],a=(e,t)=>"in"===t?s.find(t=>t>e)||Math.min(e+.25,3):[...s].reverse().find(t=>t<e)||Math.max(e-.25,.1),l=document.querySelector('[data-preview-container="true"]'),i=document.getElementById("thumbnail-preview");l&&i&&eG.current>0?F.setZoom(s=>{let r,n=a(s,t),c=e.clientX,o=e.clientY,d=l.getBoundingClientRect(),x=l.scrollLeft,m=l.scrollTop,h=c-d.left+x,u=o-d.top+m,p=i.getBoundingClientRect(),g=p.left-d.left+x,j=p.top-d.top+m,f=n/s,v=eG.current*s,y=eG.current*n;if("custom"===F.aspectRatio)r=F.customAspectRatio.width/F.customAspectRatio.height;else{let[e,t]=(F.aspectRatio||"16:9").split(":").map(Number);r=e/t}let b=v/r,N=y/r,w=g-(y-v)/2+(h-g)*f-(c-d.left),A=j-(N-b)/2+(u-j)*f-(o-d.top);return requestAnimationFrame(()=>{requestAnimationFrame(()=>{l&&(l.scrollLeft=Math.max(0,w),l.scrollTop=Math.max(0,A))})}),n}):F.setZoom(e=>a(e,t))}},t=document.getElementById("thumbnail-preview");if(t)return t.addEventListener("wheel",e,{passive:!1}),()=>{t.removeEventListener("wheel",e)}},[F.setZoom,F.aspectRatio,F.customAspectRatio]),l.useCallback(()=>{if(!ec)return r.isPreviewDedicatedMode?{width:"98vw",maxWidth:"none"}:{width:"90vw",maxWidth:"none"};if(r.isPreviewDedicatedMode){let e=Math.min(.95*window.innerWidth,2400),t=Math.min(.85*window.innerHeight,1600);return{width:"".concat(e,"px"),maxWidth:"none",maxHeight:"".concat(t,"px")}}return er||eo?{width:"min(1600px, 80vw)",maxWidth:"none"}:{width:"min(1800px, 90vw)",maxWidth:"none"}},[ec,r.isPreviewDedicatedMode,er,eo]),l.useEffect(()=>{ec?(en(!0),ed(!0)):(en(!1),ed(!1))},[ec]);let eV=l.useCallback((e,t,s)=>{F.addToHistory(F.layers,F.selectedLayerId);let a=s.x,l=s.y;if(r.snapToGrid){let e=r.gridSize,t=Math.round(a/e)*e,s=Math.round(l/e)*e;Math.abs(t-a)<=r.snapStrength&&(a=t),Math.abs(s-l)<=r.snapStrength&&(l=s)}F.updateLayer(e,{x:a,y:l})},[F.updateLayer,F.addToHistory,F.layers,F.selectedLayerId,r.snapToGrid,r.gridSize,r.snapStrength]),eH=l.useCallback((e,t,s,a,l)=>{F.addToHistory(F.layers,F.selectedLayerId);let i=l.x,n=l.y;if(r.snapToGrid){let e=r.gridSize,t=Math.round(i/e)*e,s=Math.round(n/e)*e;Math.abs(t-i)<=r.snapStrength&&(i=t),Math.abs(s-n)<=r.snapStrength&&(n=s)}F.updateLayer(e,{width:s.offsetWidth,height:s.offsetHeight,x:i,y:n})},[F.updateLayer,F.addToHistory,F.layers,F.selectedLayerId,r.snapToGrid,r.gridSize,r.snapStrength]);l.useCallback((e,t,s,a,l)=>{F.addToHistory(F.layers,F.selectedLayerId);let i=l.x,n=l.y;if(r.snapToGrid){let e=r.gridSize,t=Math.round(i/e)*e,s=Math.round(n/e)*e;Math.abs(t-i)<=r.snapStrength&&(i=t),Math.abs(s-n)<=r.snapStrength&&(n=s)}F.updateLayer(e,{width:s.offsetWidth,height:s.offsetHeight,x:i,y:n})},[F.updateLayer,F.addToHistory,F.layers,F.selectedLayerId,r.snapToGrid,r.gridSize,r.snapStrength]);let eX=e=>{let t=F.layers.filter(e=>"shape"===e.type).length*(ec?20:5),s=F.layers.filter(t=>"shape"===t.type&&"shapeType"in t&&t.shapeType===e).length+1,a="",l=ec?550:10,i=ec?250:10,r=ec?300:50,n=ec?300:50,c=ec?2:1,o=ec?300:100,d=ec?5:3;switch(e){case"rectangle":a="四角 ".concat(s);break;case"circle":a="円 ".concat(s);break;case"triangle":a="三角 ".concat(s);break;case"line":a="線 ".concat(s);break;case"arrow":a="矢印 ".concat(s);break;case"star":a="星 ".concat(s);break;case"polygon":a="多角形 ".concat(s);break;case"heart":a="ハート ".concat(s);break;case"diamond":a="ダイヤ ".concat(s);break;case"dashed-line":case"dotted-line":a="点線 ".concat(s);break;case"wavy-line":a="波線 ".concat(s);break;case"speech-bubble-round":a="吹き出し ".concat(s);break;case"speech-bubble-square":a="吹き出し(角) ".concat(s);break;case"thought-bubble":a="思考バブル ".concat(s);break;case"badge":a="バッジ ".concat(s);break;case"ribbon":a="リボン ".concat(s);break;default:a="図形 ".concat(s)}let x="line"===e||"arrow"===e||"dashed-line"===e||"dotted-line"===e||"wavy-line"===e;F.addLayer({type:"shape",shapeType:e,name:a,visible:!0,locked:!1,x:l+t,y:i+t,width:x?o:r,height:x?d:n,backgroundColor:"#cccccc",borderColor:"#000000",borderWidth:c}),F.addToHistory(F.layers,F.selectedLayerId)},eK=l.useCallback(e=>{try{let t=window.localStorage.getItem(ti),s=t?JSON.parse(t):[],a=e(s);return window.localStorage.setItem(ti,JSON.stringify(a)),V(e=>e+1),a}catch(e){return B.vF.error("カスタムテンプレートの更新に失敗しました",e,"EditorUI:persistCustomTemplates"),q.oR.error("カスタムテンプレートの保存に失敗しました"),[]}},[]),eY=l.useCallback(e=>{eK(t=>{let s=[...t],a=s.findIndex(t=>t.id===e.id);return a>=0?s[a]=e:s.push(e),s}),F.setSelectedTemplate(e),q.oR.success("テンプレートを追加しました！")},[F,eK]),eQ=l.useCallback(e=>{0!==e.length&&(eK(t=>{let s=[...t],a=new Map(s.map((e,t)=>[e.id,t]));return e.forEach(e=>{let t=a.get(e.id);void 0!==t?s[t]=e:(a.set(e.id,s.length),s.push(e))}),s}),F.setSelectedTemplate(e[e.length-1]),q.oR.success("".concat(e.length,"件のテンプレートを追加しました！")))},[F,eK]);if(!F.selectedTemplate)return(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(h.A,{className:"w-16 h-16 text-[#A0A0A0] mb-4 animate-spin mx-auto","aria-hidden":"true"}),(0,a.jsx)("p",{className:"text-[#E0E0E0] text-lg font-semibold",children:"テンプレートを読み込み中..."}),(0,a.jsx)("p",{className:"text-[#A0A0A0] mt-2",children:"しばらくお待ちください。"})]})});let e7=l.useCallback(async e=>{try{let t=F.selectedTemplate,s=await e_(e,F.layers,F.selectedLayerId,(null==t?void 0:t.id)||null,(null==t?void 0:t.aspectRatio)||"16:9",!1);E(e),J(s),z(!1),q.oR.success("プロジェクト「".concat(e,"」を保存しました"))}catch(e){console.error("プロジェクト保存エラー:",e),q.oR.error("プロジェクトの保存に失敗しました")}},[F.layers,F.selectedLayerId,F.selectedTemplate]),tt=l.useCallback(()=>{R?e7(R):(D(""),z(!0))},[R,e7]),ts=l.useCallback(async()=>{let e=I.trim();if(!e)return void q.oR.error("プロジェクト名を入力してください");await e7(e)},[I,e7]),ta=l.useCallback(e=>{try{L.restoreState(e.layers,e.selectedLayerId),E(e.name),J(e),q.oR.success("プロジェクト「".concat(e.name,"」を読み込みました"))}catch(e){console.error("プロジェクト読み込みエラー:",e),q.oR.error("プロジェクトの読み込みに失敗しました")}},[L]);(0,l.useEffect)(()=>(O.current&&clearTimeout(O.current),F.layers.length>0&&(O.current=setTimeout(async()=>{try{let e=F.selectedTemplate;await e_(R||"自動保存",F.layers,F.selectedLayerId,(null==e?void 0:e.id)||null,(null==e?void 0:e.aspectRatio)||"16:9",!0)}catch(e){console.error("自動保存エラー:",e)}},3e4)),()=>{O.current&&clearTimeout(O.current)}),[F.layers,F.selectedLayerId,R,F.selectedTemplate]);let{isShiftKeyDown:tc}=(e=>{console.log("useKeyboardShortcuts hook called");let t=te();console.log("editorState updated:",{canUndo:t.canUndo,canRedo:t.canRedo,selectedLayerId:t.selectedLayerId});let[s,a]=(0,l.useState)(!1),{selectedLayerId:i,setSelectedLayerId:r,removeLayer:n,duplicateLayer:c,handleUndo:o,handleRedo:d}=t;console.log("Keyboard shortcuts state:",{canUndo:t.canUndo,canRedo:t.canRedo,selectedLayerId:i,editorStateCanUndo:t.canUndo,editorStateCanRedo:t.canRedo});let x=e9(),{onSave:m,onOpenShortcuts:h,zoom:u=1,setZoom:p,onFitToScreen:g,moveLayerUp:j,moveLayerDown:f}=e||{},v=(0,l.useCallback)(e=>{var s,l;if("Shift"===e.key)return void a(!0);let v=t.canUndo,y=t.canRedo;if(e.ctrlKey||e.metaKey)switch(e.key){case"z":e.preventDefault(),console.log("Ctrl+Z pressed",{canUndo:v,canRedo:y,shiftKey:e.shiftKey}),e.shiftKey?y?(console.log("Executing redo"),d(),q.oR.success("やり直しました")):console.log("Cannot redo"):v?(console.log("Executing undo"),o(),q.oR.success("元に戻しました")):console.log("Cannot undo");break;case"y":e.preventDefault(),console.log("Ctrl+Y pressed",{canRedo:y}),y?(console.log("Executing redo"),d(),q.oR.success("やり直しました")):console.log("Cannot redo");break;case"d":e.preventDefault(),i&&(c(i),q.oR.success("レイヤーを複製しました"));break;case"Delete":case"Backspace":e.preventDefault(),i&&(n(i),q.oR.success("レイヤーを削除しました"));break;case"s":case"S":e.preventDefault(),m&&m();break;case"0":e.preventDefault(),g?g():p&&p(1);break;case"=":case"+":e.preventDefault(),p&&u<3&&p(Math.min(u+.25,3));break;case"-":e.preventDefault(),p&&u>.1&&p(Math.max(u-.25,.1));break;case",":e.preventDefault(),p&&p(1);break;case"ArrowUp":e.preventDefault(),i&&j&&j(i);break;case"ArrowDown":e.preventDefault(),i&&f&&f(i)}switch((null==(s=document.activeElement)?void 0:s.tagName)!=="INPUT"&&(null==(l=document.activeElement)?void 0:l.tagName)!=="TEXTAREA"&&"?"===e.key&&h&&(e.preventDefault(),h()),e.key){case"Delete":case"Backspace":!i||e.ctrlKey||e.metaKey||(n(i),q.oR.success("レイヤーを削除しました"));break;case"Escape":i&&r(null);break;case"g":case"G":if(null==x?void 0:x.setShowGrid){let e=document.querySelector('[aria-label*="グリッド"]');e?e.click():x.setShowGrid(!x.showGrid)}break;case"s":case"S":if(!e.ctrlKey&&!e.metaKey&&(null==x?void 0:x.setShowSafeArea)){let e=document.querySelector('[aria-label*="セーフエリア"]');e?e.click():x.setShowSafeArea(!x.showSafeArea)}break;case"c":case"C":if(!e.ctrlKey&&!e.metaKey&&(null==x?void 0:x.setShowCenterLines)){let e=document.querySelector('[aria-label*="中央線"]');e?e.click():x.setShowCenterLines(!x.showCenterLines)}}},[t,i,r,n,c,o,d,a,x,m,h,u,p,g,j,f]),y=(0,l.useCallback)(e=>{"Shift"===e.key&&a(!1)},[a]);return(0,l.useEffect)(()=>(window.addEventListener("keydown",v),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",v),window.removeEventListener("keyup",y)}),[v,y]),{isShiftKeyDown:s}})({onSave:tt,onOpenShortcuts:()=>ei(!0),zoom:F.zoom,setZoom:F.setZoom,onFitToScreen:eW,moveLayerUp:F.moveLayerUp,moveLayerDown:F.moveLayerDown}),to=l.useCallback(()=>{console.log("Toolbar undo button clicked"),F.handleUndo()?q.oR.success("元に戻しました"):console.log("Undo failed - no history to undo")},[F.handleUndo]),td=l.useCallback(()=>{console.log("Toolbar redo button clicked"),F.handleRedo()?q.oR.success("やり直しました"):console.log("Redo failed - no history to redo")},[F.handleRedo]),tx=l.useCallback(async e=>{if(!document.getElementById("thumbnail-preview"))return void q.oR.error("プレビューエリアが見つかりません");try{let t={"twitter-post":{width:1200,height:675,pixelRatio:2,format:"png"},"twitter-header":{width:1500,height:500,pixelRatio:2,format:"png"},"youtube-thumbnail":{width:1280,height:720,pixelRatio:2,format:"png"},"youtube-thumbnail-hd":{width:1920,height:1080,pixelRatio:2,format:"png"},"instagram-post":{width:1080,height:1080,pixelRatio:2,format:"png"},"instagram-story":{width:1080,height:1920,pixelRatio:2,format:"png"}}[e],s={resolution:"custom",customWidth:t.width,customHeight:t.height,quality:"high",format:t.format,pixelRatio:t.pixelRatio,backgroundColor:"#ffffff",includeTransparency:!1,optimizeForPlatform:e.startsWith("twitter")?"twitter":e.startsWith("youtube")?"youtube":"instagram",batchExport:!1,batchSizes:[]};await o.handleAdvancedExport(s),q.oR.success("".concat("twitter-post"===e?"Twitter投稿":"twitter-header"===e?"Twitterヘッダー":"youtube-thumbnail"===e?"YouTubeサムネイル":"youtube-thumbnail-hd"===e?"YouTubeサムネイルHD":"instagram-post"===e?"Instagram投稿":"Instagramストーリー","形式でエクスポートしました"))}catch(e){B.vF.error("Quick export failed",e,"ThumbnailGenerator")}},[o]),tm=l.useCallback(async()=>{let e={resolution:"custom",customWidth:eh.width,customHeight:eh.height,quality:eu.quality,format:_,pixelRatio:eu.pixelRatio,backgroundColor:"png"===_&&es?void 0:"#ffffff",includeTransparency:"png"===_&&es,optimizeForPlatform:eh.platform,batchExport:!1,batchSizes:[]};try{await o.handleAdvancedExport(e),q.oR.success("".concat(eh.label,"をエクスポートしました")),X(!1)}catch(e){B.vF.error("Mobile quick export failed",e,"ThumbnailGenerator")}},[eh,eu,o,_,es]),th=l.useCallback(()=>{r.setSelectedTab("export"),ed(!0),setTimeout(()=>{let e=document.querySelector('[value="export"]');e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100)},[r,ed]),tu=()=>{var e,t,s,l,i,c,o,d,x,m,h,u,p,g,j,f,v,y,k,L,R,E,T,z,I,D,M,J,O,P,q,B;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本情報"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"レイヤー名"}),(0,a.jsx)(A.p,{value:(null==eg?void 0:eg.name)||"",onChange:e=>eg&&F.updateLayer(eg.id,{name:e.target.value}),className:"mt-1",placeholder:"レイヤー名を入力",disabled:!eg})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"X座標"}),(0,a.jsx)(A.p,{type:"number",value:(null==eg?void 0:eg.x)||0,onChange:e=>eg&&F.updateLayer(eg.id,{x:Number(e.target.value)}),className:"mt-1",disabled:!eg})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"Y座標"}),(0,a.jsx)(A.p,{type:"number",value:(null==eg?void 0:eg.y)||0,onChange:e=>eg&&F.updateLayer(eg.id,{y:Number(e.target.value)}),className:"mt-1",disabled:!eg})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"幅"}),(0,a.jsx)(A.p,{type:"number",value:(null==eg?void 0:eg.width)||0,onChange:e=>eg&&F.updateLayer(eg.id,{width:Number(e.target.value)}),className:"mt-1",disabled:!eg})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"高さ"}),(0,a.jsx)(A.p,{type:"number",value:(null==eg?void 0:eg.height)||0,onChange:e=>eg&&F.updateLayer(eg.id,{height:Number(e.target.value)}),className:"mt-1",disabled:!eg})]})]})]})]}),eg&&(0,e6.Nt)(eg)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"テキスト"}),(0,a.jsx)(b.T,{value:eg.text||"",onChange:e=>F.updateLayer(eg.id,{text:e.target.value}),className:"mt-1 min-h-[80px] resize-none",placeholder:"テキストを入力してください"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"フォントサイズ"}),(0,a.jsx)(N.A,{value:[parseFloat((null==(e=eg.fontSize)?void 0:e.replace("rem",""))||"2")],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{fontSize:"".concat(t,"rem")})},min:.5,max:8,step:.1,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:eg.fontSize||"2rem"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-[#E0E0E0]",children:"フォント設定"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"フォントファミリー"}),(0,a.jsx)(e5.R,{value:eg.fontFamily||"Arial, sans-serif",onValueChange:e=>F.updateLayer(eg.id,{fontFamily:e})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"フォントウェイト"}),(0,a.jsxs)(S.l6,{value:eg.fontWeight||"normal",onValueChange:e=>F.updateLayer(eg.id,{fontWeight:e}),children:[(0,a.jsx)(S.bq,{className:"h-8 text-xs",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"normal",children:"通常"}),(0,a.jsx)(S.eb,{value:"bold",children:"太字"}),(0,a.jsx)(S.eb,{value:"lighter",children:"細字"}),(0,a.jsx)(S.eb,{value:"100",children:"100"}),(0,a.jsx)(S.eb,{value:"300",children:"300"}),(0,a.jsx)(S.eb,{value:"400",children:"400"}),(0,a.jsx)(S.eb,{value:"500",children:"500"}),(0,a.jsx)(S.eb,{value:"600",children:"600"}),(0,a.jsx)(S.eb,{value:"700",children:"700"}),(0,a.jsx)(S.eb,{value:"800",children:"800"}),(0,a.jsx)(S.eb,{value:"900",children:"900"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"フォントスタイル"}),(0,a.jsxs)(S.l6,{value:eg.fontStyle||"normal",onValueChange:e=>F.updateLayer(eg.id,{fontStyle:e}),children:[(0,a.jsx)(S.bq,{className:"h-8 text-xs",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"normal",children:"通常"}),(0,a.jsx)(S.eb,{value:"italic",children:"イタリック"}),(0,a.jsx)(S.eb,{value:"oblique",children:"斜体"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"文字装飾"}),(0,a.jsxs)(S.l6,{value:eg.textDecoration||"none",onValueChange:e=>F.updateLayer(eg.id,{textDecoration:e}),children:[(0,a.jsx)(S.bq,{className:"h-8 text-xs",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"none",children:"なし"}),(0,a.jsx)(S.eb,{value:"underline",children:"下線"}),(0,a.jsx)(S.eb,{value:"line-through",children:"取り消し線"}),(0,a.jsx)(S.eb,{value:"overline",children:"上線"})]})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"文字間隔"}),(0,a.jsx)(N.A,{value:[parseFloat((null==(t=eg.letterSpacing)?void 0:t.replace("px",""))||"0")],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{letterSpacing:"".concat(t,"px")})},min:-10,max:20,step:.5,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:eg.letterSpacing||"0px"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2 border-t border-[#4A4A4A]",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-[#E0E0E0]",children:"色・効果"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"グラデーション"}),(0,a.jsx)(n.$,{size:"sm",variant:ev?"default":"outline",onClick:()=>{let e=!ev;ey(e),e?F.updateLayer(eg.id,{textGradient:"linear-gradient(90deg, #ff0000, #0000ff)"}):F.updateLayer(eg.id,{textGradient:void 0})},className:"h-6 px-3 text-xs",children:ev?"ON":"OFF"})]}),ev&&(0,a.jsxs)("div",{className:"pl-2 border-l-2 border-[#4A4A4A] space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"プリセット"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2 mt-2",children:[{name:"虹",gradient:"linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3)"},{name:"金",gradient:"linear-gradient(135deg, #ffd700, #ffed4e)"},{name:"銀",gradient:"linear-gradient(135deg, #c0c0c0, #ffffff)"},{name:"紅白",gradient:"linear-gradient(90deg, #ff6b9d, #ffffff)"},{name:"青→白",gradient:"linear-gradient(90deg, #4169e1, #87ceeb)"},{name:"紫→ピンク",gradient:"linear-gradient(90deg, #9b59b6, #e91e63)"},{name:"オレンジ→ピンク",gradient:"linear-gradient(90deg, #ff8c00, #ff69b4)"},{name:"緑→青",gradient:"linear-gradient(90deg, #00ff7f, #00ced1)"}].map(e=>(0,a.jsx)("button",{onClick:()=>{F.updateLayer(eg.id,{textGradient:e.gradient}),eJ(!1)},className:"h-8 rounded border border-[#4A4A4A] hover:border-[#808080] transition-colors text-[10px] relative overflow-hidden group",style:{background:e.gradient},title:e.name,children:(0,a.jsx)("span",{className:"relative z-10 text-white",style:{textShadow:"0 1px 2px rgba(0,0,0,0.8)"},children:e.name})},e.name))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"カスタム"}),(0,a.jsx)(n.$,{size:"sm",variant:eM?"default":"outline",onClick:()=>eJ(!eM),className:"h-6 px-3 text-xs",children:eM?"閉じる":"開く"})]}),eM&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"開始色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("input",{type:"color",value:ew,onChange:e=>{eA(e.target.value),F.updateLayer(eg.id,{textGradient:"linear-gradient(".concat(eI,"deg, ").concat(e.target.value,", ").concat(eS,")")})},className:"w-8 h-7 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:ew,onChange:e=>{eA(e.target.value),F.updateLayer(eg.id,{textGradient:"linear-gradient(".concat(eI,"deg, ").concat(e.target.value,", ").concat(eS,")")})},className:"flex-1 h-7 text-xs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"終了色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("input",{type:"color",value:eS,onChange:e=>{eC(e.target.value),F.updateLayer(eg.id,{textGradient:"linear-gradient(".concat(eI,"deg, ").concat(ew,", ").concat(e.target.value,")")})},className:"w-8 h-7 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:eS,onChange:e=>{eC(e.target.value),F.updateLayer(eg.id,{textGradient:"linear-gradient(".concat(eI,"deg, ").concat(ew,", ").concat(e.target.value,")")})},className:"flex-1 h-7 text-xs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"方向"}),(0,a.jsxs)(S.l6,{value:eI.toString(),onValueChange:e=>{let t=parseInt(e);eD(t),F.updateLayer(eg.id,{textGradient:"linear-gradient(".concat(t,"deg, ").concat(ew,", ").concat(eS,")")})},children:[(0,a.jsx)(S.bq,{className:"h-7 text-xs",children:(0,a.jsx)(S.yv,{})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"0",children:"→ 横"}),(0,a.jsx)(S.eb,{value:"90",children:"↓ 縦"}),(0,a.jsx)(S.eb,{value:"135",children:"↘ 斜め右下"}),(0,a.jsx)(S.eb,{value:"45",children:"↗ 斜め右上"})]})]})]})]})]}),(0,a.jsxs)("details",{className:"text-xs",children:[(0,a.jsx)("summary",{className:"text-[#A0A0A0] cursor-pointer hover:text-[#E0E0E0]",children:"詳細設定（CSS手入力）"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(A.p,{value:eg.textGradient||"",onChange:e=>F.updateLayer(eg.id,{textGradient:e.target.value}),className:"h-7 text-xs",placeholder:"linear-gradient(90deg, #ff0000, #0000ff)"}),(0,a.jsx)("div",{className:"text-[10px] text-[#808080] mt-1",children:"例: linear-gradient(90deg, #ff0000, #0000ff)"})]})]})]})]}),!ev&&(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eg.color||"#ffffff",onChange:e=>F.updateLayer(eg.id,{color:e.target.value}),className:"w-8 h-8 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:eg.color||"#ffffff",onChange:e=>F.updateLayer(eg.id,{color:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 pt-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"アウトライン"}),(0,a.jsx)(n.$,{size:"sm",variant:eb?"default":"outline",onClick:()=>{let e=!eb;eN(e),e?F.updateLayer(eg.id,{textStrokeWidth:"2px",textStrokeColor:"#000000"}):F.updateLayer(eg.id,{textStrokeWidth:"0px"})},className:"h-6 px-3 text-xs",children:eb?"ON":"OFF"})]}),eb&&(0,a.jsxs)("div",{className:"space-y-2 pl-2 border-l-2 border-[#4A4A4A]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"太さ"}),(0,a.jsx)(N.A,{value:[parseFloat((null==(s=eg.textStrokeWidth)?void 0:s.replace("px",""))||"2")],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{textStrokeWidth:"".concat(t,"px")})},min:.5,max:20,step:.5,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:eg.textStrokeWidth||"2px"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eg.textStrokeColor||"#000000",onChange:e=>F.updateLayer(eg.id,{textStrokeColor:e.target.value}),className:"w-8 h-7 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:eg.textStrokeColor||"#000000",onChange:e=>F.updateLayer(eg.id,{textStrokeColor:e.target.value}),className:"flex-1 h-7 text-xs"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2 border-t border-[#4A4A4A]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"文字シャドウ"}),(0,a.jsx)(n.$,{size:"sm",variant:r.shadowEnabled?"default":"outline",onClick:()=>{let e=!r.shadowEnabled;r.setShadowEnabled(e),e?F.updateLayer(eg.id,{textShadow:"2px 2px 4px rgba(0,0,0,0.5)"}):F.updateLayer(eg.id,{textShadow:"none"})},className:"h-6 px-3 text-xs",children:r.shadowEnabled?"ON":"OFF"})]}),r.shadowEnabled&&(()=>{let e=(0,e4.T)(eg.textShadow),t=(e,t)=>{let s={...(0,e4.T)(eg.textShadow),[e]:t},a=(0,e4.A)(s.x,s.y,s.blur,s.color,s.opacity);F.updateLayer(eg.id,{textShadow:a})};return(0,a.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-[#4A4A4A]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"水平位置（X）"}),(0,a.jsx)(N.A,{value:[e.x],onValueChange:e=>{let[s]=e;return t("x",s)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[e.x,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"垂直位置（Y）"}),(0,a.jsx)(N.A,{value:[e.y],onValueChange:e=>{let[s]=e;return t("y",s)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[e.y,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"ぼかし"}),(0,a.jsx)(N.A,{value:[e.blur],onValueChange:e=>{let[s]=e;return t("blur",s)},min:0,max:30,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[e.blur,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"影の色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:e.color,onChange:e=>t("color",e.target.value),className:"w-10 h-8 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:e.color,onChange:e=>t("color",e.target.value),className:"h-8 text-xs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"不透明度"}),(0,a.jsx)(N.A,{value:[100*e.opacity],onValueChange:e=>{let[s]=e;return t("opacity",s/100)},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[Math.round(100*e.opacity),"%"]})]})]})})()]})]}),eg&&(0,e6.pz)(eg)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"画像設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"画像を変更"}),(0,a.jsx)(A.p,{type:"file",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){let e=URL.createObjectURL(s);F.updateLayer(eg.id,{src:e})}},className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"不透明度"}),(0,a.jsx)(N.A,{value:[eg.opacity||100],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{opacity:t})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[eg.opacity||100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"回転角度"}),(0,a.jsx)(N.A,{value:[eg.rotation||0],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{rotation:t})},min:-180,max:180,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[eg.rotation||0,"\xb0"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2 border-t border-[#4A4A4A]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"フィルター・エフェクト"}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",className:"h-7 text-xs text-[#A0A0A0] hover:text-[#E0E0E0]",onClick:()=>{let e=eg.imageFilters;(null==e?void 0:e.enabled)?F.updateLayer(eg.id,{imageFilters:{...e,enabled:!1}}):F.updateLayer(eg.id,{imageFilters:e?{...e,enabled:!0}:{brightness:100,contrast:100,saturate:100,hueRotate:0,sepia:0,grayscale:0,blur:0,enabled:!0}})},children:(null==(l=eg.imageFilters)?void 0:l.enabled)?"OFF":"ON"})]}),(null==(i=eg.imageFilters)?void 0:i.enabled)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0] mb-2 block",children:"雰囲気プリセット"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(e3.Su).filter(e=>"none"!==e).map(e=>{var t;e3.Su[e];let s=(null==(t=eg.imageFilters)?void 0:t.preset)===e;return(0,a.jsx)("button",{type:"button",onClick:()=>{let t=(0,e3.Ur)(e);F.updateLayer(eg.id,{imageFilters:t})},className:(0,C.cn)("px-2 py-1.5 text-xs rounded border transition-colors",s?"bg-[#20B2AA]/20 border-[#20B2AA] text-[#E0E0E0]":"bg-[#2D2D2D] border-[#4A4A4A] text-[#A0A0A0] hover:bg-[#3A3A3A]"),title:"soft"===e?"ソフト":"cool"===e?"クール":"pop"===e?"ポップ":"monochrome"===e?"モノクロ":"sepia"===e?"セピア":e,children:"soft"===e?"ソフト":"cool"===e?"クール":"pop"===e?"ポップ":"monochrome"===e?"モノクロ":"sepia"===e?"セピア":e},e)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"基本調整"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"明るさ"}),(0,a.jsx)(N.A,{value:[null!=(L=null==(c=eg.imageFilters)?void 0:c.brightness)?L:100],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,brightness:t,enabled:!0,preset:"custom"}})},min:0,max:200,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(R=null==(o=eg.imageFilters)?void 0:o.brightness)?R:100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"コントラスト"}),(0,a.jsx)(N.A,{value:[null!=(E=null==(d=eg.imageFilters)?void 0:d.contrast)?E:100],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,contrast:t,enabled:!0,preset:"custom"}})},min:0,max:200,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(T=null==(x=eg.imageFilters)?void 0:x.contrast)?T:100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"彩度"}),(0,a.jsx)(N.A,{value:[null!=(z=null==(m=eg.imageFilters)?void 0:m.saturate)?z:100],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,saturate:t,enabled:!0,preset:"custom"}})},min:0,max:200,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(I=null==(h=eg.imageFilters)?void 0:h.saturate)?I:100,"%"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"雰囲気調整"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"色相"}),(0,a.jsx)(N.A,{value:[null!=(D=null==(u=eg.imageFilters)?void 0:u.hueRotate)?D:0],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,hueRotate:t,enabled:!0,preset:"custom"}})},min:0,max:360,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(M=null==(p=eg.imageFilters)?void 0:p.hueRotate)?M:0,"\xb0"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"セピア"}),(0,a.jsx)(N.A,{value:[null!=(J=null==(g=eg.imageFilters)?void 0:g.sepia)?J:0],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,sepia:t,enabled:!0,preset:"custom"}})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(O=null==(j=eg.imageFilters)?void 0:j.sepia)?O:0,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"モノクロ"}),(0,a.jsx)(N.A,{value:[null!=(P=null==(f=eg.imageFilters)?void 0:f.grayscale)?P:0],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,grayscale:t,enabled:!0,preset:"custom"}})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[null!=(q=null==(v=eg.imageFilters)?void 0:v.grayscale)?q:0,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-[#A0A0A0]",children:"ぼかし"}),(0,a.jsx)(N.A,{value:[null!=(B=null==(y=eg.imageFilters)?void 0:y.blur)?B:0],onValueChange:e=>{let[t]=e,s=eg.imageFilters||{};F.updateLayer(eg.id,{imageFilters:{...s,blur:t,enabled:!0,preset:"custom"}})},min:0,max:10,step:.1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[(null==(k=eg.imageFilters)?void 0:k.blur)?eg.imageFilters.blur.toFixed(1):"0.0","px"]})]})]}),(0,a.jsx)(n.$,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:()=>{F.updateLayer(eg.id,{imageFilters:e3.Su.none})},children:"リセット"})]})]})]}),eg&&(0,e6.jS)(eg)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"図形設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"図形の種類"}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(e8.X,{value:eg.shapeType||"rectangle",onChange:e=>F.updateLayer(eg.id,{shapeType:e})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"塗りつぶし色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eg.backgroundColor||"#000000",onChange:e=>F.updateLayer(eg.id,{backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:eg.backgroundColor||"#000000",onChange:e=>F.updateLayer(eg.id,{backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"境界線色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eg.borderColor||"#000000",onChange:e=>F.updateLayer(eg.id,{borderColor:e.target.value}),className:"w-8 h-8 rounded border border-[#4A4A4A]"}),(0,a.jsx)(A.p,{value:eg.borderColor||"#000000",onChange:e=>F.updateLayer(eg.id,{borderColor:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-sm font-medium",children:"境界線の太さ"}),(0,a.jsx)(N.A,{value:[eg.borderWidth||0],onValueChange:e=>{let[t]=e;return F.updateLayer(eg.id,{borderWidth:t})},min:0,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-[#A0A0A0] text-center mt-1",children:[eg.borderWidth||0,"px"]})]})]})]}),!eg&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"レイヤーを選択してください"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"レイヤーパネルからレイヤーを選択すると、ここで詳細設定ができます"})]}),(0,a.jsxs)("div",{className:"space-y-4 pt-2 border-t border-[#4A4A4A]",id:"grid-settings",children:[(0,a.jsx)("h4",{className:"font-medium",children:"プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"グリッド表示"}),(0,a.jsx)(n.$,{size:"sm",variant:r.showGrid?"default":"outline",onClick:()=>r.setShowGrid(!r.showGrid),className:"h-7 px-3 text-xs",children:r.showGrid?"ON":"OFF"})]}),r.showGrid&&(0,a.jsxs)("div",{className:"space-y-3 pl-2 border-l",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"グリッドサイズ"}),(0,a.jsx)("div",{className:"flex gap-1",children:[10,20,40].map(e=>(0,a.jsxs)(n.$,{size:"sm",variant:r.gridSize===e?"default":"outline",onClick:()=>r.setGridSize(e),className:"h-7 px-2 text-xs",children:[e,"px"]},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground w-20",children:"色"}),(0,a.jsx)("input",{type:"color",value:function(){try{let e=r.gridColor.match(/rgba\((\d+),\s*(\d+),\s*(\d+),/);if(e){let t=parseInt(e[1],10),s=parseInt(e[2],10),a=parseInt(e[3],10),l=e=>e.toString(16).padStart(2,"0");return"#".concat(l(t)).concat(l(s)).concat(l(a))}}catch(e){}return"#88daff"}(),onChange:e=>{let t=e.target.value,s=parseInt(t.slice(1,3),16),a=parseInt(t.slice(3,5),16),l=parseInt(t.slice(5,7),16);r.setGridColor("rgba(".concat(s,", ").concat(a,", ").concat(l,", ").concat(Math.max(0,Math.min(1,r.gridOpacity)),")"))},className:"w-8 h-7 rounded border"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"不透明度"}),(0,a.jsx)(N.A,{value:[Math.round(100*r.gridOpacity)],onValueChange:e=>{let[t]=e;return r.setGridOpacity(t/100)},min:10,max:100,step:5,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-center mt-1",children:[Math.round(100*r.gridOpacity),"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"主要線"}),(0,a.jsx)(n.$,{size:"sm",variant:r.showMajorLines?"default":"outline",onClick:()=>r.setShowMajorLines(!r.showMajorLines),className:"h-7 px-3 text-xs",children:r.showMajorLines?"ON":"OFF"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"主要線の間隔"}),(0,a.jsx)("div",{className:"flex gap-1 mt-1",children:[3,5,10].map(e=>(0,a.jsx)(n.$,{size:"sm",variant:r.majorInterval===e?"default":"outline",onClick:()=>r.setMajorInterval(e),className:"h-7 px-2 text-xs",children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"スナップ"}),(0,a.jsx)(n.$,{size:"sm",variant:r.snapToGrid?"default":"outline",onClick:()=>r.setSnapToGrid(!r.snapToGrid),className:"h-7 px-3 text-xs",children:r.snapToGrid?"ON":"OFF"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"スナップ強度"}),(0,a.jsx)("div",{className:"flex gap-1 mt-1",children:[0,4,8,16].map(e=>(0,a.jsxs)(n.$,{size:"sm",variant:r.snapStrength===e?"default":"outline",onClick:()=>r.setSnapStrength(e),className:"h-7 px-2 text-xs",children:[e,"px"]},e))})]})]})]})]})]})};return(0,a.jsxs)("div",{className:"flex flex-col lg:h-screen lg:overflow-hidden",children:[!ec&&!r.isPreviewDedicatedMode&&(0,a.jsxs)(a.Fragment,{children:[P&&(0,a.jsx)("div",{className:"fixed inset-0 z-30 bg-background/80 backdrop-blur-sm lg:hidden",onClick:()=>G(!1)}),(0,a.jsx)(y.R,{onOpen:()=>{U("templates"),G(!0)},position:"right",className:"top-20 right-4 z-40 lg:hidden"}),(0,a.jsx)(y.B,{isOpen:P,onClose:()=>G(!1),title:"templates"===$?"テンプレート":"projects"===$?"プロジェクト":"エクスポート",className:"z-40 lg:hidden",children:(0,a.jsxs)(j.tU,{value:$,onValueChange:e=>U(e),className:"flex h-full flex-col",children:[(0,a.jsxs)(j.j7,{className:"grid w-full grid-cols-3 h-12",children:[(0,a.jsx)(j.Xi,{value:"templates",className:"text-xs",children:"テンプレート"}),(0,a.jsx)(j.Xi,{value:"projects",className:"text-xs",children:"プロジェクト"}),(0,a.jsx)(j.Xi,{value:"export",className:"text-xs",children:"エクスポート"})]}),(0,a.jsx)(j.av,{value:"templates",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(ek,{onSelectTemplate:e=>{F.setSelectedTemplate(e),G(!1)},selectedTemplateId:null!=(t=null==(e=F.selectedTemplate)?void 0:e.id)?t:null,availableTabs:["browse","manage"],defaultTab:"browse"},"mobile-template-selector-".concat(W))}),(0,a.jsx)(j.av,{value:"projects",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(e0,{onLoadProject:e=>{ta(e),G(!1)},currentProjectName:R,onProjectSaved:e=>{E(e.name),J(e),G(!1)}})}),(0,a.jsx)(j.av,{value:"export",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(eP,{onExport:o.handleAdvancedExport,isExporting:o.isExporting})})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:h-full lg:overflow-hidden",children:[!r.isPreviewDedicatedMode&&ec&&(0,a.jsx)(e1,{isDesktop:ec,isSidebarOpen:er,setIsSidebarOpen:en,layers:F.layers,updateLayer:F.updateLayer,removeLayer:F.removeLayer,selectedLayerId:F.selectedLayerId,setSelectedLayerId:F.setSelectedLayerId,reorderLayers:F.reorderLayers,duplicateLayer:F.duplicateLayer,addLayer:F.addLayer,moveLayerUp:F.moveLayerUp,moveLayerDown:F.moveLayerDown,selectedTemplate:F.selectedTemplate,setSelectedTemplate:F.setSelectedTemplate,onShapeSelect:e=>eX(e),onLoadProject:ta,currentProjectName:R,onProjectSaved:e=>{E(e.name),J(e)}},"desktop-sidebar-".concat(W)),(0,a.jsxs)("main",{className:r.isPreviewDedicatedMode?"w-full flex flex-col min-w-0 overflow-hidden":"w-full lg:w-3/5 flex flex-col min-w-0 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex-1 flex flex-col min-h-0 ".concat(ec?"p-6":"p-2 pt-16"),children:(0,a.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:(0,a.jsxs)(a.Fragment,{children:[ec&&(0,a.jsx)(eq.M,{zoom:F.zoom,setZoom:F.setZoom,onFitToScreen:eW,onUndo:to,onRedo:td,onSave:tt,onDownload:o.handleDownloadThumbnail,onQuickExport:tx,onOpenExportSettings:th,canUndo:F.canUndo,canRedo:F.canRedo,isPreviewDedicatedMode:r.isPreviewDedicatedMode,onTogglePreviewMode:()=>r.setIsPreviewDedicatedMode(!r.isPreviewDedicatedMode),showGrid:r.showGrid,setShowGrid:r.setShowGrid,showAspectGuide:r.showAspectGuide,setShowAspectGuide:r.setShowAspectGuide,showSafeArea:r.showSafeArea,setShowSafeArea:r.setShowSafeArea,showCenterLines:r.showCenterLines,setShowCenterLines:r.setShowCenterLines,history:F.history,historyIndex:F.historyIndex,onJumpToHistory:F.jumpToHistory,onOpenShortcuts:()=>ei(!0)}),!ec&&r.isPreviewDedicatedMode&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-20",children:(0,a.jsxs)(n.$,{size:"sm",variant:"outline",onClick:()=>r.setIsPreviewDedicatedMode(!1),className:"bg-background/90 backdrop-blur-sm shadow-lg",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"通常表示に戻る"]})}),(0,a.jsx)("div",{className:"flex-1 min-h-0 overflow-auto bg-[#1A1A1A] relative custom-scrollbar","data-preview-container":"true",children:(0,a.jsx)("div",{className:"flex items-start justify-center p-4 lg:p-8",children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("div",{id:"thumbnail-preview",style:{width:"".concat(eG.current*F.zoom,"px"),aspectRatio:"custom"===F.aspectRatio?"".concat(F.customAspectRatio.width,"/").concat(F.customAspectRatio.height):(F.aspectRatio||"16:9").replace(":","/"),margin:"0 auto",transition:"width 0.2s ease-in-out"},className:"bg-card relative border rounded-md shadow-lg",children:(0,a.jsxs)("div",{id:"download-target",className:"w-full h-full relative overflow-visible",children:[em.map(e=>{let t=e.id===F.selectedLayerId,s=t&&!e.locked,l=t&&!e.locked;return e.visible?"image"===e.type?(0,a.jsx)(eL.A,{id:e.id,isSelected:t,src:e.src||"",alt:e.name,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(t,s)=>eV(e.id,t,s),onResize:(t,s,a,l,i)=>eH(e.id,s,a,l,i),onResizeStop:(t,s,a,l,i)=>eH(e.id,s,a,l,i),lockAspectRatio:tc,enableResizing:l,disableDragging:!s,onSelect:()=>F.setSelectedLayerId(e.id),isDraggable:s,isLocked:e.locked,onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},updateLayer:F.updateLayer,imageFilters:e.imageFilters,showRotationHandle:ex},e.id):"text"===e.type?(0,a.jsx)(eF.A,{id:e.id,isSelected:t,text:e.text||"",color:e.color,fontSize:e.fontSize,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle,textDecoration:e.textDecoration,textShadow:e.textShadow,letterSpacing:e.letterSpacing,textStrokeWidth:e.textStrokeWidth,textStrokeColor:e.textStrokeColor,textGradient:e.textGradient,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(t,s)=>eV(e.id,t,s),onResizeStop:(t,s,a,l,i)=>eH(e.id,s,a,l,i),enableResizing:l,disableDragging:!s,onSelect:()=>F.setSelectedLayerId(e.id),isLocked:e.locked,isDraggable:s,updateLayer:F.updateLayer,showRotationHandle:ex},e.id):"shape"===e.type?(0,a.jsx)(eR.A,{id:e.id,isSelected:t,shapeType:e.shapeType,backgroundColor:e.backgroundColor||"#cccccc",borderColor:e.borderColor||"#000000",borderWidth:e.borderWidth||2,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(t,s)=>eV(e.id,t,s),onResize:(t,s,a,l,i)=>eH(e.id,s,a,l,i),onResizeStop:(t,s,a,l,i)=>eH(e.id,s,a,l,i),lockAspectRatio:tc,enableResizing:l,disableDragging:!s,onSelect:()=>F.setSelectedLayerId(e.id),isLocked:e.locked,isDraggable:s,updateLayer:F.updateLayer,showRotationHandle:ex},e.id):null:null}),(0,a.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[r.showGrid&&(0,a.jsx)("div",{className:"absolute inset-0",style:{opacity:r.gridOpacity,backgroundImage:(()=>{r.gridSize,F.zoom;let e="linear-gradient(".concat(r.gridColor," 1px, transparent 1px), linear-gradient(90deg, ").concat(r.gridColor," 1px, transparent 1px)");if(!r.showMajorLines)return e;let t=r.gridColor;try{let e=r.gridColor.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([0-9.]+)\)/);if(e){let s=e[1],a=e[2],l=e[3];t="rgba(".concat(s,", ").concat(a,", ").concat(l,", ").concat(Math.min(1,Number(e[4])+.2),")")}}catch(e){}let s="linear-gradient(".concat(t," 1px, transparent 1px), linear-gradient(90deg, ").concat(t," 1px, transparent 1px)");return"".concat(e,", ").concat(s)})(),backgroundSize:(()=>{let e=r.gridSize*F.zoom;if(!r.showMajorLines)return"".concat(e,"px ").concat(e,"px");let t=e*Math.max(1,r.majorInterval);return"".concat(e,"px ").concat(e,"px, ").concat(t,"px ").concat(t,"px")})(),backgroundPosition:"0 0, 0 0"},"aria-hidden":"true"}),r.showAspectGuide&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("div",{className:"border-2 border-dashed border-cyan-400/80 bg-cyan-400/10 rounded shadow-lg",style:{width:"90%",height:"90%",aspectRatio:"custom"===F.aspectRatio?"".concat(F.customAspectRatio.width,"/").concat(F.customAspectRatio.height):F.aspectRatio||"16:9"},"aria-hidden":"true"})}),r.showSafeArea&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("div",{className:"border-2 border-dashed border-emerald-400/85 bg-emerald-400/10 rounded shadow-lg",style:{width:"95%",height:"95%",aspectRatio:"custom"===F.aspectRatio?"".concat(F.customAspectRatio.width,"/").concat(F.customAspectRatio.height):F.aspectRatio||"16:9"},"aria-hidden":"true"})}),r.showCenterLines&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-full h-0.5 bg-rose-400/85 shadow-sm","aria-hidden":"true"})}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("div",{className:"h-full w-0.5 bg-rose-400/85 shadow-sm","aria-hidden":"true"})})]})]})]})})})})})]})})}),!ec&&!r.isPreviewDedicatedMode&&(0,a.jsxs)("div",{className:"border-t bg-background/95 backdrop-blur-sm max-h-[50vh] overflow-y-auto flex-shrink-0",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"\uD83D\uDCA1 ヒント: サイドパネルからテンプレート・プロジェクト・エクスポート設定を開けます。"})}),(0,a.jsxs)("div",{className:"p-2 lg:p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-[#3A3A3A] bg-[#1F1F1F] p-3 flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"エクスポート設定ショートカット"}),(0,a.jsx)("p",{className:"text-sm font-medium text-foreground",children:"主要パラメータを素早く変更できます"})]}),(0,a.jsxs)(n.$,{variant:"default",size:"sm",onClick:()=>X(!0),className:"flex items-center gap-1",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),"開く"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"ワンタップエクスポート"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",className:"h-10 text-xs flex items-center justify-center gap-2",onClick:()=>tx("youtube-thumbnail"),children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"YouTube"]}),(0,a.jsxs)(n.$,{variant:"outline",className:"h-10 text-xs flex items-center justify-center gap-2",onClick:()=>tx("twitter-post"),children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"X投稿"]}),(0,a.jsxs)(n.$,{variant:"outline",className:"h-10 text-xs flex items-center justify-center gap-2",onClick:()=>tx("instagram-post"),children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),"Instagram"]}),(0,a.jsxs)(n.$,{variant:"outline",className:"h-10 text-xs flex items-center justify-center gap-2",onClick:()=>tx("instagram-story"),children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),"ストーリー"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"クイックアクセス"}),(0,a.jsxs)(j.tU,{value:r.selectedTab,onValueChange:r.setSelectedTab,className:"w-full max-h-[50vh] flex flex-col",children:[(0,a.jsxs)(j.j7,{className:"w-full items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground flex flex-wrap gap-1",children:[(0,a.jsx)(j.Xi,{value:"tools",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"ツール設定"}),(0,a.jsx)(j.Xi,{value:"layers",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー管理"}),(0,a.jsx)(j.Xi,{value:"edit",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"編集"}),(0,a.jsx)(j.Xi,{value:"display",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"表示設定"}),(0,a.jsx)(j.Xi,{value:"ai",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"AI生成"})]}),(0,a.jsx)(j.av,{value:"tools",className:"mt-4 flex-1 overflow-y-auto",children:tu()}),(0,a.jsx)(j.av,{value:"layers",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(ez.G,{context:{layers:F.layers,updateLayer:F.updateLayer,removeLayer:F.removeLayer,selectedLayerId:F.selectedLayerId,setSelectedLayerId:F.setSelectedLayerId,reorderLayers:F.reorderLayers,duplicateLayer:F.duplicateLayer,addLayer:F.addLayer,moveLayerUp:F.moveLayerUp,moveLayerDown:F.moveLayerDown},onShapeSelect:e=>F.handleAddShape(e),showShapeSelector:!0})}),(0,a.jsx)(j.av,{value:"edit",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー操作"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>F.duplicateLayer(F.selectedLayerId),children:"複製"}),(0,a.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>F.removeLayer(F.selectedLayerId),children:"削除"}),(0,a.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>F.moveLayerUp(F.selectedLayerId),children:"最前面"}),(0,a.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>F.moveLayerDown(F.selectedLayerId),children:"最背面"})]})]}),(0,a.jsx)(eE.p,{selectedLayer:F.layers.find(e=>e.id===F.selectedLayerId)||null,onUpdateLayer:(e,t)=>F.updateLayer(e,t),className:"mt-4"})]})}),(0,a.jsx)(j.av,{value:"display",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(eT.a,{zoom:F.zoom,onZoomChange:F.setZoom,showGrid:r.showGrid,onShowGridChange:r.setShowGrid,showGuides:r.showCenterLines,onShowGuidesChange:r.setShowCenterLines,showSafeArea:r.showSafeArea,onShowSafeAreaChange:r.setShowSafeArea,showAspectGuide:r.showAspectGuide,onShowAspectGuideChange:r.setShowAspectGuide,gridSize:r.gridSize,onGridSizeChange:r.setGridSize})}),(0,a.jsx)(j.av,{value:"ai",className:"mt-4 flex-1 overflow-y-auto",children:(0,a.jsx)(ef,{onTemplateGenerated:eY,onTemplatesGenerated:eQ})})]})]})]})]})]}),!r.isPreviewDedicatedMode&&ec&&(0,a.jsx)(e2,{isDesktop:ec,isSidebarOpen:eo,setIsSidebarOpen:ed,isExporting:o.isExporting,renderToolsPanel:tu,handleAdvancedExport:o.handleAdvancedExport,handleAddShape:eX,selectedTab:r.selectedTab,setSelectedTab:r.setSelectedTab})]}),(0,a.jsx)(H.lG,{open:Z,onOpenChange:e=>X(e),children:(0,a.jsxs)(H.Cf,{className:"sm:max-w-md p-0 overflow-hidden",children:[(0,a.jsxs)(H.c7,{className:"px-4 pt-4 pb-2",children:[(0,a.jsx)(H.L3,{className:"text-lg font-semibold",children:"クイックエクスポート"}),(0,a.jsx)(H.rr,{className:"text-xs text-muted-foreground",children:"よく使うプラットフォーム向けにサイズ・形式を素早く切り替えられます。"})]}),(0,a.jsxs)("div",{className:"px-4 pb-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"プラットフォーム別プリセット"}),(0,a.jsx)("div",{className:"space-y-2",children:tr.map(e=>{let t=e.Icon,s=K===e.id;return(0,a.jsxs)("button",{type:"button",onClick:()=>Y(e.id),className:(0,C.cn)("flex w-full items-center gap-3 rounded-md border px-3 py-3 text-left transition",s?"border-primary bg-primary/10 shadow-sm":"border-[#333333] bg-[#1B1B1B] hover:border-primary/40"),children:[(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-[#262626]",children:(0,a.jsx)(t,{className:"h-5 w-5 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-foreground",children:e.label}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.sizeLabel," ・ ",e.description]})]}),s&&(0,a.jsx)("span",{className:"rounded-full bg-primary/20 px-2 py-1 text-[10px] font-medium text-primary",children:"選択中"})]},e.id)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"出力形式"}),(0,a.jsxs)(S.l6,{value:_,onValueChange:e=>{Q(e),"jpeg"===e&&ea(!1)},children:[(0,a.jsx)(S.bq,{className:"h-10",children:(0,a.jsx)(S.yv,{placeholder:"形式を選択"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"png",children:"PNG（透過対応）"}),(0,a.jsx)(S.eb,{value:"jpeg",children:"JPEG（軽量）"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(w.J,{className:"text-xs text-muted-foreground",children:"品質"}),(0,a.jsxs)(S.l6,{value:ee,onValueChange:e=>et(e),children:[(0,a.jsx)(S.bq,{className:"h-10",children:(0,a.jsx)(S.yv,{placeholder:"品質を選択"})}),(0,a.jsx)(S.gC,{children:Object.entries(tn).map(e=>{let[t,s]=e;return(0,a.jsxs)(S.eb,{value:t,children:[s.label,"（",s.description,"）"]},t)})})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[#333333] bg-[#1B1B1B] px-3 py-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground",children:"透過背景"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG形式のみ利用できます"})]}),(0,a.jsx)(k.d,{checked:es&&"png"===_,disabled:"png"!==_,onCheckedChange:e=>ea(e)})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-[#333333] bg-[#1B1B1B] px-3 py-2 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"出力サイズ"}),(0,a.jsxs)("span",{children:[eh.width," \xd7 ",eh.height," px"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"用途"}),(0,a.jsx)("span",{children:eh.label})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"品質"}),(0,a.jsx)("span",{children:eu.label})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"形式"}),(0,a.jsx)("span",{children:_.toUpperCase()})]})]})]}),(0,a.jsxs)(H.Es,{className:"px-4 pb-4 pt-0 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)(n.$,{variant:"ghost",className:"w-full sm:w-auto",onClick:()=>{X(!1),th()},children:"詳細設定を開く"}),(0,a.jsxs)(n.$,{onClick:tm,disabled:o.isExporting,className:"w-full sm:w-auto flex items-center justify-center gap-2",children:[o.isExporting?(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(g.A,{className:"h-4 w-4"}),"エクスポートする"]})]})]})}),(0,a.jsx)(H.lG,{open:T,onOpenChange:z,children:(0,a.jsxs)(H.Cf,{children:[(0,a.jsx)(H.c7,{children:(0,a.jsx)(H.L3,{children:"プロジェクトを保存"})}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(w.J,{htmlFor:"project-name",children:"プロジェクト名"}),(0,a.jsx)(A.p,{id:"project-name",value:I,onChange:e=>D(e.target.value),placeholder:"プロジェクト名を入力",onKeyDown:e=>{"Enter"===e.key&&ts()},autoFocus:!0})]})}),(0,a.jsxs)(H.Es,{children:[(0,a.jsx)(n.$,{variant:"outline",onClick:()=>z(!1),children:"キャンセル"}),(0,a.jsx)(n.$,{onClick:ts,disabled:!I.trim(),children:"保存"})]})]})}),(0,a.jsx)(tl,{open:el,onOpenChange:ei})]})};function to(){return(0,a.jsx)(r.z,{children:(0,a.jsx)(i.U,{children:(0,a.jsx)(tc,{})})})}},79888:(e,t,s)=>{Promise.resolve().then(s.bind(s,45963))}},e=>{e.O(0,[96,76,358],()=>e(e.s=79888)),_N_E=e.O()}]);