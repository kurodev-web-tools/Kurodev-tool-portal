(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{1207:(e,s,t)=>{Promise.resolve().then(t.bind(t,89066))},89066:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>Y});var a=t(24520),i=t(70404),n=t(79419),l=t(8857),r=t(5344),c=t(72103),o=t(30621),d=t(26357),x=t(99938),m=t(76996),h=t(32651),u=t(15060),p=t(4429),g=t(6690),v=t(22747),f=t(14858),j=t(75628),b=t(76856),N=t(58561),y=t(83200),w=t(78708),C=t(21023),k=t(80472);let S=i.memo(e=>{let{id:s,isSelected:t,text:n,color:l="white",fontSize:r="2rem",fontFamily:c,fontWeight:o,fontStyle:d,textDecoration:x,textShadow:m,className:h,x:u,y:p,width:g,height:v,rotation:f,zIndex:j=0,onDragStop:b,onResizeStop:y,enableResizing:S,disableDragging:z,onSelect:E,isLocked:R,isDraggable:D,onRotateStart:J,onRotate:M,onRotateStop:L}=e,{updateLayer:P}=(0,N.S)(),[A,$]=(0,i.useState)({x:u,y:p}),[F,I]=(0,i.useState)(!1),T=(0,i.useRef)(null),W=(0,i.useRef)(null);(0,i.useEffect)(()=>{$({x:u,y:p})},[u,p]);let q=(0,i.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),I(!0);let a=null==(t=T.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+A.x+g/2,r=n.top+A.y+v/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-l;P(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},o=()=>{I(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[s,P,A.x,A.y,g,v]);return(0,i.useEffect)(()=>{let e=W.current;if(e)return e.addEventListener("touchstart",q,{passive:!1}),()=>{e.removeEventListener("touchstart",q)}},[q]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.p,{ref:T,size:{width:g,height:v},position:A,onDragStart:()=>{if(F)return!1;null==E||E()},onDrag:(e,s)=>{F||$({x:s.x,y:s.y})},onDragStop:b,onResizeStop:y,minWidth:50,minHeight:20,enableResizing:S,disableDragging:z||F,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{display:"flex",alignItems:"center",justifyContent:"center",zIndex:j},children:(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",style:{transform:"rotate(".concat(f,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("p",{className:(0,C.cn)("cursor-move",h),style:{color:l,fontSize:r,fontFamily:c,fontWeight:o,fontStyle:d,textDecoration:x,textShadow:m,lineHeight:1,whiteSpace:"pre-wrap"},children:n})})}),t&&(0,a.jsx)("div",{ref:W,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),I(!0);let a=null==(t=T.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+A.x+g/2,r=n.top+A.y+v/2,c=e=>{let t=e.clientX-l;P(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},o=()=>{I(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:A.x+g/2,top:A.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})}),z=i.memo(e=>{let{id:s,isSelected:t,src:n,alt:l,x:r,y:c,width:o,height:d,rotation:x,zIndex:m=0,onDragStop:h,onResize:u,onResizeStop:p,onSelect:g,isLocked:v,isDraggable:f,lockAspectRatio:j,enableResizing:b,disableDragging:y,onRotateStart:C,onRotate:S,onRotateStop:z}=e,{updateLayer:E}=(0,N.S)(),[R,D]=(0,i.useState)({x:r,y:c}),[J,M]=(0,i.useState)(!1),L=(0,i.useRef)(null),P=(0,i.useRef)(null);(0,i.useEffect)(()=>{D({x:r,y:c})},[r,c]);let A=(0,i.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),M(!0);let a=null==(t=L.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+R.x+o/2,r=n.top+R.y+d/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-l;E(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},x=()=>{M(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",x)};window.addEventListener("touchmove",c),window.addEventListener("touchend",x)},[s,E,R.x,R.y,o,d]);return(0,i.useEffect)(()=>{let e=P.current;if(e)return e.addEventListener("touchstart",A,{passive:!1}),()=>{e.removeEventListener("touchstart",A)}},[A]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.p,{ref:L,size:{width:o,height:d},position:R,onDragStart:()=>{if(J)return!1},onDrag:(e,s)=>{J||D({x:s.x,y:s.y})},onDragStop:h,onResize:u,onResizeStop:p,lockAspectRatio:j,enableResizing:b,disableDragging:y||J,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{zIndex:m},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(x,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundImage:n?"url(".concat(n,")"):"none",backgroundSize:"cover",backgroundPosition:"center"}})})}),t&&(0,a.jsx)("div",{ref:P,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),M(!0);let a=null==(t=L.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+R.x+o/2,r=n.top+R.y+d/2,c=e=>{let t=e.clientX-l;E(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},x=()=>{M(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",x)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",x)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:R.x+o/2,top:R.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})}),E=e=>{let{id:s,isSelected:t,shapeType:n,backgroundColor:l,borderColor:r,borderWidth:c,rotation:o,zIndex:d=0,onDragStop:x,onResize:m,onResizeStop:h,lockAspectRatio:u,enableResizing:p,disableDragging:g,x:v,y:f,width:j,height:b,onSelect:y,isLocked:C,isDraggable:S,onRotateStart:z,onRotate:E,onRotateStop:R}=e,{updateLayer:D}=(0,N.S)(),[J,M]=(0,i.useState)({x:v||0,y:f||0}),[L,P]=(0,i.useState)(!1),A=(0,i.useRef)(null),$=(0,i.useRef)(null);(0,i.useEffect)(()=>{M({x:v||0,y:f||0})},[v,f]);let F=(0,i.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),P(!0);let a=null==(t=A.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+J.x+j/2,r=n.top+J.y+b/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-l;D(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},o=()=>{P(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[s,D,J.x,J.y,j,b]);return(0,i.useEffect)(()=>{let e=$.current;if(e)return e.addEventListener("touchstart",F,{passive:!1}),()=>{e.removeEventListener("touchstart",F)}},[F]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.p,{ref:A,size:{width:j,height:b},position:J,onDragStart:()=>{if(L)return!1;null==y||y()},onDrag:(e,s)=>{L||M({x:s.x,y:s.y})},onDragStop:x,onResize:m,onResizeStop:h,lockAspectRatio:u,enableResizing:p,disableDragging:g||L,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{zIndex:d},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(o,"deg)"),transformOrigin:"center"},children:(()=>{let e={width:"100%",height:"100%",style:{overflow:"visible"}};switch(n){case"line":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("line",{x1:0,y1:b/2,x2:j,y2:b/2,stroke:r,strokeWidth:c})});case"arrow":return(0,a.jsxs)("svg",{...e,children:[(0,a.jsx)("defs",{children:(0,a.jsx)("marker",{id:"arrowhead-".concat(s),markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",fill:r,children:(0,a.jsx)("polygon",{points:"0 0, 10 3.5, 0 7"})})}),(0,a.jsx)("line",{x1:0,y1:b/2,x2:j-10,y2:b/2,stroke:r,strokeWidth:c,markerEnd:"url(#arrowhead-".concat(s,")")})]});case"triangle":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(j/2,",0 0,").concat(b," ").concat(j,",").concat(b),fill:l,stroke:r,strokeWidth:c})});case"star":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*j,",0 ").concat(.618*j,",").concat(.382*b," ").concat(j,",").concat(.382*b," ").concat(.691*j,",").concat(.618*b," ").concat(.809*j,",").concat(b," ").concat(.5*j,",").concat(.764*b," ").concat(.191*j,",").concat(b," ").concat(.309*j,",").concat(.618*b," 0,").concat(.382*b," ").concat(.382*j,",").concat(.382*b),fill:l,stroke:r,strokeWidth:c})});case"heart":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("path",{d:"M".concat(.5*j,",").concat(.9*b," C").concat(.5*j,",").concat(.9*b," ").concat(.1*j,",").concat(.5*b," ").concat(.1*j,",").concat(.3*b," C").concat(.1*j,",").concat(.15*b," ").concat(.25*j,",").concat(.1*b," ").concat(.4*j,",").concat(.1*b," C").concat(.5*j,",").concat(.1*b," ").concat(.5*j,",").concat(.2*b," ").concat(.5*j,",").concat(.2*b," C").concat(.5*j,",").concat(.2*b," ").concat(.5*j,",").concat(.1*b," ").concat(.6*j,",").concat(.1*b," C").concat(.75*j,",").concat(.1*b," ").concat(.9*j,",").concat(.15*b," ").concat(.9*j,",").concat(.3*b," C").concat(.9*j,",").concat(.5*b," ").concat(.5*j,",").concat(.9*b," ").concat(.5*j,",").concat(.9*b," Z"),fill:l,stroke:r,strokeWidth:c})});case"diamond":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(j/2,",0 ").concat(j,",").concat(b/2," ").concat(j/2,",").concat(b," 0,").concat(b/2),fill:l,stroke:r,strokeWidth:c})});case"polygon":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*j,",0 ").concat(.9*j,",").concat(.3*b," ").concat(.7*j,",").concat(.9*b," ").concat(.3*j,",").concat(.9*b," ").concat(.1*j,",").concat(.3*b),fill:l,stroke:r,strokeWidth:c})});default:return(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:l,border:"".concat(c,"px solid ").concat(r),borderRadius:"circle"===n?"50%":"0"}})}})()})}),t&&(0,a.jsx)("div",{ref:$,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),P(!0);let a=null==(t=A.current)?void 0:t.getSelfElement();if(!a)return;let i=a.parentElement;if(!i)return;let n=i.getBoundingClientRect(),l=n.left+J.x+j/2,r=n.top+J.y+b/2,c=e=>{let t=e.clientX-l;D(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},o=()=>{P(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:J.x+j/2,top:J.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})};var R=t(92248),D=t(83826),J=t(60307),M=t(69025),L=t(54997),P=t(88076),A=t(24973),$=t(9331),F=t(45874),I=t(25157),T=t(14202);let W={"youtube-standard":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"youtube",batchExport:!1,batchSizes:[]},"twitter-optimized":{resolution:"custom",customWidth:1200,customHeight:675,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"twitter",batchExport:!1,batchSizes:[]},"instagram-square":{resolution:"custom",customWidth:1080,customHeight:1080,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"instagram",batchExport:!1,batchSizes:[]},"batch-all-platforms":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"general",batchExport:!0,batchSizes:[{name:"YouTube",width:1920,height:1080,platform:"youtube"},{name:"Twitter",width:1200,height:675,platform:"twitter"},{name:"Instagram",width:1080,height:1080,platform:"instagram"},{name:"Facebook",width:1200,height:630,platform:"facebook"}]}},q={hd:{width:1280,height:720,label:"HD (1280\xd7720)"},fhd:{width:1920,height:1080,label:"FHD (1920\xd71080)"},"4k":{width:3840,height:2160,label:"4K (3840\xd72160)"},custom:{width:0,height:0,label:"カスタム"}},O={low:{pixelRatio:1,quality:.6,label:"低品質 (軽量)"},medium:{pixelRatio:1.5,quality:.8,label:"中品質 (バランス)"},high:{pixelRatio:2,quality:.9,label:"高品質 (推奨)"},ultra:{pixelRatio:3,quality:1,label:"最高品質 (重い)"}},X=e=>{let{onExport:s,isExporting:t}=e,[n,c]=(0,i.useState)(W["youtube-standard"]),[d,x]=(0,i.useState)({}),[m,h]=(0,i.useState)(!1),u=!(0,T.U)("(min-width: 768px)");i.useEffect(()=>{let e=localStorage.getItem("thumbnailExportPresets");e&&x(JSON.parse(e))},[]);let p=e=>{c(s=>({...s,...e}))},g=e=>{let s=W[e]||d[e];s&&(c(s),l.oR.success("プリセット「".concat(e,"」を適用しました")))},N=async()=>{try{await s(n)}catch(e){console.error("Export failed:",e)}},y="custom"===n.resolution?{width:n.customWidth||1920,height:n.customHeight||1080}:q[n.resolution];return(0,a.jsxs)(D.Zp,{className:"w-full",children:[(0,a.jsx)(D.aR,{children:(0,a.jsxs)(D.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(P.A,{className:"h-5 w-5"}),"エクスポート設定"]})}),(0,a.jsxs)(D.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"プリセット"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"fhd"!==n.resolution||n.batchExport?"outline":"default",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("youtube-standard"),children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-1"}),"YouTube"]}),(0,a.jsxs)(r.$,{variant:"twitter"===n.optimizeForPlatform?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("twitter-optimized"),children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-1"}),"Twitter"]}),(0,a.jsxs)(r.$,{variant:"instagram"===n.optimizeForPlatform?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("instagram-square"),children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-1"}),"Instagram"]}),(0,a.jsxs)(r.$,{variant:n.batchExport?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("batch-all-platforms"),children:[(0,a.jsx)($.A,{className:"h-4 w-4 mr-1"}),"一括出力"]})]})]}),(0,a.jsx)(L.w,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"解像度"}),(0,a.jsxs)(b.l6,{value:n.resolution,onValueChange:e=>p({resolution:e}),children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"hd",children:"HD (1280\xd7720)"}),(0,a.jsx)(b.eb,{value:"fhd",children:"FHD (1920\xd71080)"}),(0,a.jsx)(b.eb,{value:"4k",children:"4K (3840\xd72160)"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]}),"custom"===n.resolution&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs",children:"幅 (px)"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:n.customWidth||1920,onChange:e=>p({customWidth:Number(e.target.value)}),min:"100",max:"8000",className:u?"h-10":""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs",children:"高さ (px)"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:n.customHeight||1080,onChange:e=>p({customHeight:Number(e.target.value)}),min:"100",max:"8000",className:u?"h-10":""})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"品質"}),(0,a.jsxs)(b.l6,{value:n.quality,onValueChange:e=>{let s=O[e];p({quality:e,pixelRatio:s.pixelRatio})},children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"low",children:"低品質 (軽量・1x)"}),(0,a.jsx)(b.eb,{value:"medium",children:"中品質 (バランス・1.5x)"}),(0,a.jsx)(b.eb,{value:"high",children:"高品質 (推奨・2x)"}),(0,a.jsx)(b.eb,{value:"ultra",children:"最高品質 (重い・3x)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"形式"}),(0,a.jsxs)(b.l6,{value:n.format,onValueChange:e=>p({format:e}),children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"png",children:"PNG (高品質・透明対応)"}),(0,a.jsx)(b.eb,{value:"jpeg",children:"JPEG (軽量・写真向け)"})]})]})]})]}),n.batchExport&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(L.w,{}),(0,a.jsx)("h4",{className:"font-medium",children:"バッチエクスポート"}),(0,a.jsx)("div",{className:"space-y-2",children:n.batchSizes.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:[e.width,"\xd7",e.height]})]}),(0,a.jsx)(M.E,{variant:"secondary",children:e.platform})]},s))})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:()=>h(!m),className:"w-full",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),m?"詳細設定を隠す":"詳細設定を表示"]}),m&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"背景色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"color",value:n.backgroundColor||"#ffffff",onChange:e=>p({backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:n.backgroundColor||"#ffffff",onChange:e=>p({backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(J.S,{id:"transparency",checked:n.includeTransparency,onCheckedChange:e=>p({includeTransparency:!!e})}),(0,a.jsx)(f.J,{htmlFor:"transparency",className:"text-sm",children:"透明度を保持する"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(f.J,{className:"text-sm font-medium",children:["ピクセル比: ",n.pixelRatio,"x"]}),(0,a.jsx)(v.A,{value:[n.pixelRatio],onValueChange:e=>{let[s]=e;return p({pixelRatio:s})},min:.5,max:4,step:.5,className:"w-full"})]})]})]}),(0,a.jsx)(L.w,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"出力情報"}),u?(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"解像度:"}),(0,a.jsxs)("span",{className:"font-medium",children:[y.width,"\xd7",y.height]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"形式:"}),(0,a.jsx)("span",{className:"font-medium",children:n.format.toUpperCase()})]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"解像度:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[y.width,"\xd7",y.height]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"形式:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:n.format.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"品質:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:O[n.quality].label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"ファイル数:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[n.batchExport?n.batchSizes.length:1,"個"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{onClick:N,disabled:t,className:(0,C.cn)("flex-1",u&&"h-11"),children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F.A,{className:"h-4 w-4 mr-2 animate-spin"}),"エクスポート中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"エクスポート"]})}),(0,a.jsxs)(r.$,{variant:"outline",onClick:()=>{let e=prompt("プリセット名を入力してください:");if(e&&e.trim()){let s={...d,[e]:n};x(s),localStorage.setItem("thumbnailExportPresets",JSON.stringify(s)),l.oR.success("プリセット「".concat(e,"」を保存しました"))}},disabled:t,className:u?"h-11 px-3":"",children:[(0,a.jsx)(I.A,{className:"h-4 w-4 mr-1"}),u?"":"保存"]})]})]})]})};var B=t(68421),V=t(73574),H=t(1978);let G=["image/jpeg","image/jpg","image/png","image/webp"],U=e=>{if(!e||"none"===e)return{x:0,y:0,blur:0,color:"#000000",opacity:.5};let s=e.match(/(-?\d+)px\s+(-?\d+)px\s+(\d+)px\s+rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(s)return{x:parseInt(s[1]),y:parseInt(s[2]),blur:parseInt(s[3]),color:"#".concat(parseInt(s[4]).toString(16).padStart(2,"0")).concat(parseInt(s[5]).toString(16).padStart(2,"0")).concat(parseInt(s[6]).toString(16).padStart(2,"0")),opacity:s[7]?parseFloat(s[7]):1};let t=e.match(/(-?\d+)px\s+(-?\d+)px\s+(\d+)px\s+(#[0-9a-fA-F]{6})/);return t?{x:parseInt(t[1]),y:parseInt(t[2]),blur:parseInt(t[3]),color:t[4],opacity:1}:{x:0,y:0,blur:0,color:"#000000",opacity:.5}};function Y(){let{isOpen:e,setIsOpen:s,isDesktop:w}=(0,h.c)({defaultOpen:!1,desktopDefaultOpen:!0}),[C,k]=i.useState("settings"),[D,J]=i.useState(!1),[M,L]=i.useState(!1),[P,A]=i.useState(!1),[$,F]=i.useState(!0),[I,T]=i.useState(!1),[W,q]=i.useState(20),[O,Y]=i.useState(!1),{handleAsyncError:Z}=(0,u.u)(),{selectedTemplate:_,setSelectedTemplate:K,currentText:Q,setCurrentText:ee,layers:es,addLayer:et,removeLayer:ea,updateLayer:ei,selectedLayerId:en,setSelectedLayerId:el,reorderLayers:er,duplicateLayer:ec,moveLayerUp:eo,moveLayerDown:ed,aspectRatio:ex,customAspectRatio:em}=(0,N.S)(),eh=es.find(e=>e.id===en);i.useEffect(()=>{(null==eh?void 0:eh.textShadow)&&"none"!==eh.textShadow?Y(!0):Y(!1)},[null==eh?void 0:eh.textShadow]);let eu=i.useCallback(()=>w?M?{width:"min(2000px, 95vw)",maxWidth:"none"}:e?{width:"min(1600px, 80vw)",maxWidth:"none"}:{width:"min(1800px, 90vw)",maxWidth:"none"}:M?{width:"95vw",maxWidth:"none"}:{width:"90vw",maxWidth:"none"},[w,M,e]),{zoom:ep,setZoom:eg,undo:ev,redo:ef,canUndo:ej,canRedo:eb,addToHistory:eN,resetHistoryFlag:ey,saveToLocalStorage:ew,loadFromLocalStorage:eC}=(0,H.Y)(es,en);i.useEffect(()=>{let e=e=>{"Shift"===e.key&&J(!0)},s=e=>{"Shift"===e.key&&J(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",s)}},[]),i.useEffect(()=>{w?s(!0):s(!1)},[w]);let[ek,eS]=(0,i.useState)(!1),ez=i.useCallback(async e=>{let s=document.getElementById("thumbnail-preview");if(!s)return void l.oR.error("サムネイルが見つかりません");eS(!0);try{await Z(async()=>{e.batchExport?await eD(s,e):await eR(s,e)},"エクスポートに失敗しました")}finally{eS(!1)}},[Z]),eE=async e=>{let s=Array.from(e.querySelectorAll("img")).map(e=>new Promise(s=>{if(e.complete&&e.naturalWidth>0)s();else{let t=()=>{e.removeEventListener("load",t),e.removeEventListener("error",a),s()},a=()=>{e.removeEventListener("load",t),e.removeEventListener("error",a),console.warn("画像の読み込みに失敗しました:",e.src),s()};e.addEventListener("load",t),e.addEventListener("error",a)}}));await Promise.all(s),await new Promise(e=>setTimeout(e,500))},eR=async(e,s)=>{let a,i;await eE(e);let r={low:{pixelRatio:1,quality:.6},medium:{pixelRatio:1.5,quality:.8},high:{pixelRatio:2,quality:.9},ultra:{pixelRatio:3,quality:1}}[s.quality],c="custom"===s.resolution?{width:s.customWidth||1920,height:s.customHeight||1080}:({hd:{width:1280,height:720},fhd:{width:1920,height:1080},"4k":{width:3840,height:2160}})[s.resolution],o={cacheBust:!1,pixelRatio:s.pixelRatio||r.pixelRatio,quality:"png"===s.format?1:r.quality,backgroundColor:s.backgroundColor||"#ffffff",width:c.width,height:c.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===s.format)a=await (0,n.$E)(e,o),i="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".png");else if("jpeg"===s.format){let{toJpeg:n}=await Promise.resolve().then(t.bind(t,79419));a=await n(e,o),i="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".jpg")}else a=await (0,n.$E)(e,o),i="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".png");let d=document.createElement("a");d.download=i,d.href=a,d.click(),l.oR.success("".concat(i," をエクスポートしました"))},eD=async(e,s)=>{let a=s.batchSizes.map(async a=>{let i,l,r={cacheBust:!0,pixelRatio:s.pixelRatio||2,quality:"png"===s.format?1:.9,backgroundColor:s.backgroundColor||"#ffffff",width:a.width,height:a.height};if("png"===s.format)i=await (0,n.$E)(e,r),l="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");else if("jpeg"===s.format){let{toJpeg:s}=await Promise.resolve().then(t.bind(t,79419));i=await s(e,r),l="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".jpg")}else i=await (0,n.$E)(e,r),l="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");let c=document.createElement("a");return c.download=l,c.href=i,c.click(),l}),i=await Promise.all(a);l.oR.success("".concat(i.length,"個のファイルをエクスポートしました"))},eJ=i.useCallback((e,s,t)=>{ei(e,{x:t.x,y:t.y}),eN(es,en)},[ei,eN,es,en]),eM=i.useCallback((e,s,t,a,i)=>{ei(e,{width:t.offsetWidth,height:t.offsetHeight,x:i.x,y:i.y}),eN(es,en)},[ei,eN,es,en]),eL=e=>{let s=es.filter(e=>"shape"===e.type).length*(w?20:5),t=es.filter(s=>s.shapeType===e).length+1,a="",i=w?550:10,n=w?250:10,l=w?300:50,r=w?300:50,c=w?2:1,o=w?300:100,d=w?5:3;switch(e){case"rectangle":a="四角 ".concat(t);break;case"circle":a="円 ".concat(t);break;case"line":a="線 ".concat(t);break;case"arrow":a="矢印 ".concat(t)}et({type:"shape",shapeType:e,name:a,visible:!0,locked:!1,x:i+s,y:n+s,width:"line"===e||"arrow"===e?o:l,height:"line"===e||"arrow"===e?d:r,backgroundColor:"#cccccc",borderColor:"#000000",borderWidth:c})};if(!_)return(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("p",{children:"テンプレートを読み込み中..."})});let eP=()=>{var e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本情報"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"レイヤー名"}),(0,a.jsx)(j.p,{value:(null==eh?void 0:eh.name)||"",onChange:e=>eh&&ei(eh.id,{name:e.target.value}),className:"mt-1",placeholder:"レイヤー名を入力",disabled:!eh})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"X座標"}),(0,a.jsx)(j.p,{type:"number",value:(null==eh?void 0:eh.x)||0,onChange:e=>eh&&ei(eh.id,{x:Number(e.target.value)}),className:"mt-1",disabled:!eh})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"Y座標"}),(0,a.jsx)(j.p,{type:"number",value:(null==eh?void 0:eh.y)||0,onChange:e=>eh&&ei(eh.id,{y:Number(e.target.value)}),className:"mt-1",disabled:!eh})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"幅"}),(0,a.jsx)(j.p,{type:"number",value:(null==eh?void 0:eh.width)||0,onChange:e=>eh&&ei(eh.id,{width:Number(e.target.value)}),className:"mt-1",disabled:!eh})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"高さ"}),(0,a.jsx)(j.p,{type:"number",value:(null==eh?void 0:eh.height)||0,onChange:e=>eh&&ei(eh.id,{height:Number(e.target.value)}),className:"mt-1",disabled:!eh})]})]})]})]}),(null==eh?void 0:eh.type)==="text"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"テキスト"}),(0,a.jsx)(g.T,{value:eh.text||"",onChange:e=>ei(eh.id,{text:e.target.value}),className:"mt-1 min-h-[80px] resize-none",placeholder:"テキストを入力してください"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"フォントサイズ"}),(0,a.jsx)(v.A,{value:[parseFloat((null==(e=eh.fontSize)?void 0:e.replace("rem",""))||"2")],onValueChange:e=>{let[s]=e;return ei(eh.id,{fontSize:"".concat(s,"rem")})},min:.5,max:8,step:.1,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center mt-1",children:eh.fontSize||"2rem"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eh.color||"#ffffff",onChange:e=>ei(eh.id,{color:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:eh.color||"#ffffff",onChange:e=>ei(eh.id,{color:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-300",children:"フォント設定"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-400",children:"フォントファミリー"}),(0,a.jsxs)(b.l6,{value:eh.fontFamily||"Arial, sans-serif",onValueChange:e=>ei(eh.id,{fontFamily:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"Noto Sans JP, sans-serif",children:"Noto Sans JP"}),(0,a.jsx)(b.eb,{value:"M PLUS Rounded 1c, sans-serif",children:"M PLUS Rounded 1c"}),(0,a.jsx)(b.eb,{value:"Kosugi Maru, sans-serif",children:"Kosugi Maru"}),(0,a.jsx)(b.eb,{value:"Sawarabi Mincho, serif",children:"Sawarabi Mincho"}),(0,a.jsx)(b.eb,{value:"Noto Serif JP, serif",children:"Noto Serif JP"}),(0,a.jsx)(b.eb,{value:"Roboto, sans-serif",children:"Roboto"}),(0,a.jsx)(b.eb,{value:"Open Sans, sans-serif",children:"Open Sans"}),(0,a.jsx)(b.eb,{value:"Lato, sans-serif",children:"Lato"}),(0,a.jsx)(b.eb,{value:"Montserrat, sans-serif",children:"Montserrat"}),(0,a.jsx)(b.eb,{value:"Source Sans 3, sans-serif",children:"Source Sans 3"}),(0,a.jsx)(b.eb,{value:"Nunito, sans-serif",children:"Nunito"}),(0,a.jsx)(b.eb,{value:"Poppins, sans-serif",children:"Poppins"}),(0,a.jsx)(b.eb,{value:"Inter, sans-serif",children:"Inter"}),(0,a.jsx)(b.eb,{value:"Playfair Display, serif",children:"Playfair Display"}),(0,a.jsx)(b.eb,{value:"Merriweather, serif",children:"Merriweather"}),(0,a.jsx)(b.eb,{value:"Lora, serif",children:"Lora"}),(0,a.jsx)(b.eb,{value:"Crimson Text, serif",children:"Crimson Text"}),(0,a.jsx)(b.eb,{value:"Bebas Neue, sans-serif",children:"Bebas Neue"}),(0,a.jsx)(b.eb,{value:"Oswald, sans-serif",children:"Oswald"}),(0,a.jsx)(b.eb,{value:"Anton, sans-serif",children:"Anton"}),(0,a.jsx)(b.eb,{value:"Dancing Script, cursive",children:"Dancing Script"}),(0,a.jsx)(b.eb,{value:"Pacifico, cursive",children:"Pacifico"}),(0,a.jsx)(b.eb,{value:"Great Vibes, cursive",children:"Great Vibes"}),(0,a.jsx)(b.eb,{value:"Roboto Mono, monospace",children:"Roboto Mono"}),(0,a.jsx)(b.eb,{value:"Source Code Pro, monospace",children:"Source Code Pro"}),(0,a.jsx)(b.eb,{value:"Fira Code, monospace",children:"Fira Code"}),(0,a.jsx)(b.eb,{value:"JetBrains Mono, monospace",children:"JetBrains Mono"}),(0,a.jsx)(b.eb,{value:"Arial, sans-serif",children:"Arial (System)"}),(0,a.jsx)(b.eb,{value:"Helvetica, sans-serif",children:"Helvetica (System)"}),(0,a.jsx)(b.eb,{value:"Georgia, serif",children:"Georgia (System)"}),(0,a.jsx)(b.eb,{value:"Times New Roman, serif",children:"Times New Roman (System)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-400",children:"フォントウェイト"}),(0,a.jsxs)(b.l6,{value:eh.fontWeight||"normal",onValueChange:e=>ei(eh.id,{fontWeight:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"normal",children:"通常"}),(0,a.jsx)(b.eb,{value:"bold",children:"太字"}),(0,a.jsx)(b.eb,{value:"lighter",children:"細字"}),(0,a.jsx)(b.eb,{value:"100",children:"100"}),(0,a.jsx)(b.eb,{value:"300",children:"300"}),(0,a.jsx)(b.eb,{value:"400",children:"400"}),(0,a.jsx)(b.eb,{value:"500",children:"500"}),(0,a.jsx)(b.eb,{value:"600",children:"600"}),(0,a.jsx)(b.eb,{value:"700",children:"700"}),(0,a.jsx)(b.eb,{value:"800",children:"800"}),(0,a.jsx)(b.eb,{value:"900",children:"900"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-400",children:"フォントスタイル"}),(0,a.jsxs)(b.l6,{value:eh.fontStyle||"normal",onValueChange:e=>ei(eh.id,{fontStyle:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"normal",children:"通常"}),(0,a.jsx)(b.eb,{value:"italic",children:"イタリック"}),(0,a.jsx)(b.eb,{value:"oblique",children:"斜体"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-400",children:"文字装飾"}),(0,a.jsxs)(b.l6,{value:eh.textDecoration||"none",onValueChange:e=>ei(eh.id,{textDecoration:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"none",children:"なし"}),(0,a.jsx)(b.eb,{value:"underline",children:"下線"}),(0,a.jsx)(b.eb,{value:"line-through",children:"取り消し線"}),(0,a.jsx)(b.eb,{value:"overline",children:"上線"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-400",children:"文字シャドウ"}),(0,a.jsx)(r.$,{size:"sm",variant:O?"default":"outline",onClick:()=>{let e=!O;Y(e),e?ei(eh.id,{textShadow:"2px 2px 4px rgba(0,0,0,0.5)"}):ei(eh.id,{textShadow:"none"})},className:"h-6 px-3 text-xs",children:O?"ON":"OFF"})]}),O&&(()=>{let e=U(eh.textShadow),s=(e,s)=>{let t={...U(eh.textShadow),[e]:s},a=((e,s,t,a,i)=>{let n=parseInt(a.slice(1,3),16),l=parseInt(a.slice(3,5),16),r=parseInt(a.slice(5,7),16);return"".concat(e,"px ").concat(s,"px ").concat(t,"px rgba(").concat(n,",").concat(l,",").concat(r,",").concat(i,")")})(t.x,t.y,t.blur,t.color,t.opacity);ei(eh.id,{textShadow:a})};return(0,a.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-500",children:"水平位置（X）"}),(0,a.jsx)(v.A,{value:[e.x],onValueChange:e=>{let[t]=e;return s("x",t)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.x,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-500",children:"垂直位置（Y）"}),(0,a.jsx)(v.A,{value:[e.y],onValueChange:e=>{let[t]=e;return s("y",t)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.y,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-500",children:"ぼかし"}),(0,a.jsx)(v.A,{value:[e.blur],onValueChange:e=>{let[t]=e;return s("blur",t)},min:0,max:30,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.blur,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-500",children:"影の色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:e.color,onChange:e=>s("color",e.target.value),className:"w-10 h-8 rounded border border-gray-600"}),(0,a.jsx)(j.p,{value:e.color,onChange:e=>s("color",e.target.value),className:"h-8 text-xs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-xs text-gray-500",children:"不透明度"}),(0,a.jsx)(v.A,{value:[100*e.opacity],onValueChange:e=>{let[t]=e;return s("opacity",t/100)},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[Math.round(100*e.opacity),"%"]})]})]})})()]})]})]})]}),(null==eh?void 0:eh.type)==="image"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"画像設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"画像を変更"}),(0,a.jsx)(j.p,{type:"file",accept:"image/*",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){let e=URL.createObjectURL(t);ei(eh.id,{src:e})}},className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"不透明度"}),(0,a.jsx)(v.A,{value:[eh.opacity||100],onValueChange:e=>{let[s]=e;return ei(eh.id,{opacity:s})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[eh.opacity||100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"回転角度"}),(0,a.jsx)(v.A,{value:[eh.rotation||0],onValueChange:e=>{let[s]=e;return ei(eh.id,{rotation:s})},min:-180,max:180,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[eh.rotation||0,"\xb0"]})]})]})]}),(null==eh?void 0:eh.type)==="shape"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"図形設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"図形の種類"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,a.jsx)(r.$,{variant:"rectangle"===eh.shapeType?"default":"outline",onClick:()=>ei(eh.id,{shapeType:"rectangle"}),size:"sm",children:"四角形"}),(0,a.jsx)(r.$,{variant:"circle"===eh.shapeType?"default":"outline",onClick:()=>ei(eh.id,{shapeType:"circle"}),size:"sm",children:"円"}),(0,a.jsx)(r.$,{variant:"line"===eh.shapeType?"default":"outline",onClick:()=>ei(eh.id,{shapeType:"line"}),size:"sm",children:"線"}),(0,a.jsx)(r.$,{variant:"arrow"===eh.shapeType?"default":"outline",onClick:()=>ei(eh.id,{shapeType:"arrow"}),size:"sm",children:"矢印"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"塗りつぶし色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eh.backgroundColor||"#000000",onChange:e=>ei(eh.id,{backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:eh.backgroundColor||"#000000",onChange:e=>ei(eh.id,{backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"境界線色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:eh.borderColor||"#000000",onChange:e=>ei(eh.id,{borderColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(j.p,{value:eh.borderColor||"#000000",onChange:e=>ei(eh.id,{borderColor:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"境界線の太さ"}),(0,a.jsx)(v.A,{value:[eh.borderWidth||0],onValueChange:e=>{let[s]=e;return ei(eh.id,{borderWidth:s})},min:0,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[eh.borderWidth||0,"px"]})]})]})]}),!eh&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"レイヤーを選択してください"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"レイヤーパネルからレイヤーを選択すると、ここで詳細設定ができます"})]})]})},eA=(0,a.jsxs)(m.tU,{value:C,onValueChange:k,className:"w-full",children:[(0,a.jsxs)(m.j7,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(m.Xi,{value:"settings",children:"テンプレート"}),(0,a.jsx)(m.Xi,{value:"tools",children:"ツール"}),(0,a.jsx)(m.Xi,{value:"layers",children:"レイヤー"}),(0,a.jsx)(m.Xi,{value:"export",children:"エクスポート"})]}),(0,a.jsx)(m.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(y.A,{onSelectTemplate:K,selectedTemplateId:_.id})}),(0,a.jsx)(m.av,{value:"tools",className:"mt-4",children:eP()}),(0,a.jsx)(m.av,{value:"layers",className:"mt-4",children:(0,a.jsx)(R.G,{context:{layers:es,updateLayer:ei,removeLayer:ea,selectedLayerId:en,setSelectedLayerId:el,reorderLayers:er,duplicateLayer:ec,addLayer:et,moveLayerUp:eo,moveLayerDown:ed},onShapeSelect:e=>eL(e),showShapeSelector:!0})}),(0,a.jsx)(m.av,{value:"export",className:"mt-4",children:(0,a.jsx)(X,{onExport:ez,isExporting:ek})})]}),e$=(0,a.jsxs)(m.tU,{value:C,onValueChange:k,className:"w-full",children:[(0,a.jsxs)(m.j7,{className:"w-full h-12 items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground",children:[(0,a.jsx)(m.Xi,{value:"settings",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-6 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"テンプレート"}),(0,a.jsx)(m.Xi,{value:"export",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-6 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"エクスポート"})]}),(0,a.jsx)(m.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(y.A,{onSelectTemplate:K,selectedTemplateId:_.id})}),(0,a.jsx)(m.av,{value:"export",className:"mt-4",children:(0,a.jsx)(X,{onExport:ez,isExporting:ek})})]}),eF=i.useCallback(()=>{ew(es,en)?l.oR.success("プロジェクトを保存しました"):l.oR.error("保存に失敗しました")},[ew,es,en]),eI=i.useCallback(()=>{ev()&&ey()},[ev,ey]),eT=i.useCallback(()=>{ef()&&ey()},[ef,ey]),eW=i.useCallback(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"high",s=document.getElementById("thumbnail-preview");if(!s)return void l.oR.error("プレビューエリアが見つかりません");try{await eR(s,{format:"png",quality:{normal:"medium",high:"high",super:"ultra"}[e],resolution:"fhd",optimizeForPlatform:"youtube",pixelRatio:"super"===e?4:"high"===e?2:1,backgroundColor:"#ffffff",includeTransparency:!1,batchExport:!1,batchSizes:[]})}catch(e){console.error("Export failed:",e),l.oR.error("エクスポートに失敗しました")}},[]);return(0,a.jsxs)("div",{className:"relative flex flex-col lg:h-screen",children:[e&&!w&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-30 lg:hidden",onClick:()=>s(!1)}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row flex-grow lg:h-full lg:overflow-y-auto",children:[(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto",children:[(0,a.jsx)("div",{className:"".concat(w?"p-6":"p-2 pt-16"),children:(0,a.jsx)("div",{className:"".concat(w?"":"max-h-[70vh] overflow-hidden"),children:(0,a.jsxs)(a.Fragment,{children:[w&&(0,a.jsx)(V.M,{zoom:ep,setZoom:eg,onUndo:eI,onRedo:eT,onSave:eF,onDownload:eW,canUndo:ej,canRedo:eb,isPreviewDedicatedMode:M,onTogglePreviewMode:()=>L(!M)}),!w&&M&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-20",children:(0,a.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>L(!1),className:"bg-background/90 backdrop-blur-sm shadow-lg",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"通常表示に戻る"]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100 dark:bg-gray-900 relative",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-full p-4 lg:p-8",children:(0,a.jsx)(B.Z,{zoom:ep,onZoomReset:()=>eg(1),className:"w-full",aspectRatio:ex,customAspectRatio:em,showGrid:P,setShowGrid:A,showAspectGuide:$,setShowAspectGuide:F,showSafeArea:I,setShowSafeArea:T,gridSize:W,setGridSize:q,children:(0,a.jsx)("div",{id:"thumbnail-preview",style:{aspectRatio:"custom"===ex?"".concat(em.width,"/").concat(em.height):(ex||"16:9").replace(":","/"),...eu()},className:"bg-card relative border rounded-md shadow-lg",children:(0,a.jsx)("div",{id:"download-target",className:"w-full h-full relative overflow-hidden",children:es.map(e=>{let s=e.id===en,t=s&&!e.locked,i=s&&!e.locked;return e.visible?"image"===e.type?(0,a.jsx)(z,{id:e.id,isSelected:s,src:e.src||"",alt:e.name,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eJ(e.id,s,t),onResize:(s,t,a,i,n)=>eM(e.id,t,a,i,n),onResizeStop:(s,t,a,i,n)=>eM(e.id,t,a,i,n),lockAspectRatio:D,enableResizing:i,disableDragging:!t,onSelect:()=>el(e.id),isDraggable:t,isLocked:e.locked,onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{}},e.id):"text"===e.type?(0,a.jsx)(S,{id:e.id,isSelected:s,text:e.text||"",color:e.color,fontSize:e.fontSize,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle,textDecoration:e.textDecoration,textShadow:e.textShadow,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eJ(e.id,s,t),onResizeStop:(s,t,a,i,n)=>eM(e.id,t,a,i,n),enableResizing:i,disableDragging:!t},e.id):"shape"===e.type?(0,a.jsx)(E,{id:e.id,isSelected:s,shapeType:e.shapeType,backgroundColor:e.backgroundColor||"#cccccc",borderColor:e.borderColor||"#000000",borderWidth:e.borderWidth||2,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eJ(e.id,s,t),onResize:(s,t,a,i,n)=>eM(e.id,t,a,i,n),onResizeStop:(s,t,a,i,n)=>eM(e.id,t,a,i,n),lockAspectRatio:D,enableResizing:i,disableDragging:!t},e.id):null:null})})})})})})]})})}),!w&&!M&&(0,a.jsxs)("div",{className:"border-t bg-background/95 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"\uD83D\uDCA1 ヒント: 「ツール設定」でレイヤーの詳細編集、「レイヤー管理」でレイヤーの並び替えができます。テンプレートやエクスポートはサイドバーからアクセスできます。"})}),(0,a.jsxs)("div",{className:"p-2 lg:p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"クイックアクセス"}),(0,a.jsx)(m.tU,{value:C,onValueChange:k,className:"w-full",children:(0,a.jsxs)(m.j7,{className:"w-full h-12 items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground",children:[(0,a.jsx)(m.Xi,{value:"tools",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"ツール設定"}),(0,a.jsx)(m.Xi,{value:"layers",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー管理"}),(0,a.jsx)(m.Xi,{value:"edit",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー編集"}),(0,a.jsx)(m.Xi,{value:"preview",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"プレビュー"})]})})]}),"tools"===C&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"ツール設定"}),eP()]}),"layers"===C&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー管理"}),(0,a.jsx)(R.G,{context:{layers:es,updateLayer:ei,removeLayer:ea,selectedLayerId:en,setSelectedLayerId:el,reorderLayers:er,duplicateLayer:ec,addLayer:et,moveLayerUp:eo,moveLayerDown:ed},onShapeSelect:e=>eL(e),showShapeSelector:!0})]}),"edit"===C&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー編集"}),eh?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-2 bg-secondary/50 rounded-md",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"選択中"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:eh.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDCD0 位置"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{x:eh.x-10}),className:"h-7 w-7 p-0",children:"←"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"X"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(eh.x),onChange:e=>ei(eh.id,{x:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{x:eh.x+10}),className:"h-7 w-7 p-0",children:"→"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{y:eh.y-10}),className:"h-7 w-7 p-0",children:"↑"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"Y"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(eh.y),onChange:e=>ei(eh.id,{y:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{y:eh.y+10}),className:"h-7 w-7 p-0",children:"↓"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDCCF サイズ"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{width:Math.max(10,eh.width-20)}),className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"幅"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(eh.width),onChange:e=>ei(eh.id,{width:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{width:eh.width+20}),className:"h-7 w-7 p-0",children:"+"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{height:Math.max(10,eh.height-20)}),className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"高さ"}),(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(eh.height),onChange:e=>ei(eh.id,{height:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{height:eh.height+20}),className:"h-7 w-7 p-0",children:"+"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDD04 回転"}),(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{rotation:(eh.rotation||0)-15}),className:"h-7 w-7 p-0",title:"反時計回り 15\xb0",children:"↺"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{rotation:(eh.rotation||0)-5}),className:"h-7 w-7 p-0",title:"反時計回り 5\xb0",children:"↶"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(j.p,{type:"number",inputMode:"numeric",value:Math.round(eh.rotation||0),onChange:e=>ei(eh.id,{rotation:Number(e.target.value)}),className:"h-7 text-xs text-center",placeholder:"角度"})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{rotation:(eh.rotation||0)+5}),className:"h-7 w-7 p-0",title:"時計回り 5\xb0",children:"↷"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{rotation:(eh.rotation||0)+15}),className:"h-7 w-7 p-0",title:"時計回り 15\xb0",children:"↻"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>ei(eh.id,{rotation:0}),className:"h-7 px-2 text-xs",children:"0\xb0"})]})]}),"text"===eh.type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"✏️ テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.T,{value:eh.text||"",onChange:e=>ei(eh.id,{text:e.target.value}),className:"text-xs min-h-[60px] resize-none",placeholder:"テキストを入力"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground w-8",children:"色"}),(0,a.jsx)("input",{type:"color",value:eh.color||"#000000",onChange:e=>ei(eh.id,{color:e.target.value}),className:"w-8 h-7 rounded border"}),(0,a.jsx)(j.p,{value:eh.color||"#000000",onChange:e=>ei(eh.id,{color:e.target.value}),className:"h-7 text-xs flex-1",placeholder:"#000000"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=Math.max(.5,parseFloat(eh.fontSize||"1rem")-.25);ei(eh.id,{fontSize:"".concat(e,"rem")})},className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"サイズ"}),(0,a.jsx)(j.p,{value:eh.fontSize||"1rem",onChange:e=>ei(eh.id,{fontSize:e.target.value}),className:"h-7 text-xs",placeholder:"1rem"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=parseFloat(eh.fontSize||"1rem");ei(eh.id,{fontSize:"".concat(e+.25,"rem")})},className:"h-7 w-7 p-0",children:"+"})]})]})]})]})]}):(0,a.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:(0,a.jsx)("p",{className:"text-xs",children:"レイヤーを選択してください"})})]}),"preview"===C&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDD0D ズーム"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eg(Math.max(.25,ep-.25)),className:"h-8 w-8 p-0",disabled:ep<=.25,children:"−"}),(0,a.jsx)("div",{className:"flex-1 text-center",children:(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(100*ep),"%"]})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eg(Math.min(4,ep+.25)),className:"h-8 w-8 p-0",disabled:ep>=4,children:"+"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eg(1),className:"w-full h-8",children:"リセット (100%)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDCCA プレビュー情報"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"アスペクト比:"}),(0,a.jsx)("span",{className:"font-medium",children:"custom"===ex?"".concat(em.width,":").concat(em.height):ex||"16:9"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"ズーム率:"}),(0,a.jsxs)("span",{className:"font-medium",children:[Math.round(100*ep),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"グリッド:"}),(0,a.jsx)("span",{className:"font-medium",children:"40px"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"⚙️ プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"グリッド表示"}),(0,a.jsx)(r.$,{size:"sm",variant:P?"default":"outline",onClick:()=>A(!P),className:"h-6 px-2 text-xs",children:P?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"アスペクト比ガイド"}),(0,a.jsx)(r.$,{size:"sm",variant:$?"default":"outline",onClick:()=>F(!$),className:"h-6 px-2 text-xs",children:$?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"セーフエリア"}),(0,a.jsx)(r.$,{size:"sm",variant:I?"default":"outline",onClick:()=>T(!I),className:"h-6 px-2 text-xs",children:I?"ON":"OFF"})]}),P&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(f.J,{className:"text-xs text-muted-foreground",children:"グリッドサイズ"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:10===W?"default":"outline",onClick:()=>q(10),className:"h-6 px-2 text-xs flex-1",children:"10px"}),(0,a.jsx)(r.$,{size:"sm",variant:20===W?"default":"outline",onClick:()=>q(20),className:"h-6 px-2 text-xs flex-1",children:"20px"}),(0,a.jsx)(r.$,{size:"sm",variant:40===W?"default":"outline",onClick:()=>q(40),className:"h-6 px-2 text-xs flex-1",children:"40px"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDCFA 表示モード"}),(0,a.jsx)(r.$,{size:"sm",variant:M?"default":"outline",onClick:()=>L(!M),className:"w-full h-8",children:M?"通常表示に戻る":"フルスクリーン表示"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-xs font-medium",children:"\uD83D\uDCBE 保存・出力"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:eF,className:"h-8",children:"保存"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eW("high"),className:"h-8",children:"ダウンロード"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"レイヤーを追加"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{et({type:"text",name:"テキスト ".concat(es.filter(e=>"text"===e.type).length+1),visible:!0,locked:!1,x:w?550:50,y:w?250:50,width:w?300:150,height:w?100:50,text:Q,color:"#000000",fontSize:w?"2rem":"1rem"})},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"T"}),(0,a.jsx)("span",{children:"テキスト"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("image-upload"))?void 0:e.click()},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDDBC️"}),(0,a.jsx)("span",{children:"画像"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eL("rectangle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⬜"}),(0,a.jsx)("span",{children:"四角"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eL("circle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⭕"}),(0,a.jsx)("span",{children:"円"})]})]}),(0,a.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{let s=e.target.files;if(s){for(let e of Array.from(s)){if(e.size>0xa00000){l.oR.error("ファイルサイズが大きすぎます: ".concat(e.name),{description:"10MB以下のファイルを選択してください。"});continue}if(!G.includes(e.type)){l.oR.error("ファイル形式が無効です: ".concat(e.name),{description:"JPEG, PNG, WEBP形式の画像ファイルを選択してください。"});continue}let s=URL.createObjectURL(e);et({type:"image",name:e.name,visible:!0,locked:!1,x:w?550:50,y:w?250:50,width:w?300:150,height:w?300:150,src:s})}e.target.value=""}},className:"hidden",multiple:!0})]})]})]})]}),!e&&(0,a.jsx)(p.R,{onOpen:()=>s(!0),isDesktop:w,tabs:[{id:"settings",label:"テンプレート",icon:(0,a.jsx)(o.A,{className:"h-4 w-4"})},{id:"tools",label:"ツール",icon:(0,a.jsx)(d.A,{className:"h-4 w-4"})},{id:"layers",label:"レイヤー",icon:(0,a.jsx)(x.A,{className:"h-4 w-4"})}],onTabClick:e=>{console.log("Tab clicked:",e)}}),!M&&(0,a.jsx)(p.B,{isOpen:e,onClose:()=>s(!1),title:"",isDesktop:w,className:"".concat(w?"lg:w-96":"w-full max-w-sm"),children:w?eA:e$})]})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=1207)),_N_E=e.O()}]);