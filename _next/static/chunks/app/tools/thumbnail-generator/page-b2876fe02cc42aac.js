(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{1207:(e,s,t)=>{Promise.resolve().then(t.bind(t,15835))},15835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eT});var a=t(24520),l=t(70404),i=t(79419),n=t(8857),r=t(5344),c=t(72103),o=t(30621),d=t(26357),m=t(99938),h=t(76996),x=t(32651),u=t(15060),j=t(4429),g=t(6690),p=t(22747),v=t(14858),f=t(75628),b=t(76856),y=t(58561),N=t(83826),w=t(69025),C=t(44381),S=t(28735),k=t(50088),z=t(6708),E=t(20849),F=t(74704),A=t(60356),R=t(25157),D=t(21023),T=t(65574);let M=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:320,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:180,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;return new Promise((l,i)=>{let n=new Image;n.crossOrigin="anonymous",n.onload=()=>{let e=document.createElement("canvas"),r=e.getContext("2d");if(!r)return void i(Error("Canvas context not available"));let{width:c,height:o}=n;c>o?c>s&&(o=o*s/c,c=s):o>t&&(c=c*t/o,o=t),e.width=c,e.height=o,r.drawImage(n,0,0,c,o),l(e.toDataURL("image/jpeg",a))},n.onerror=()=>{i(Error("Failed to load image"))},n.src=e})},J=async e=>{try{return await M(e,320,180,.7)}catch(s){return T.vF.error("プレビュー生成失敗",s,"imageUtils"),e}};var I=t(83818),q=t(25653),P=t(58736),L=t(2285),O=t(27477),$=t(73693),B=t(88076),V=t(82273);class W{static async generatePreview(e){let s=document.createElement("canvas"),t=s.getContext("2d");if(!t)throw Error("Canvas context not available");for(let a of(s.width=200,s.height=150,this.drawBackground(t,e.layout.background,200,150),e.layout.objects))this.drawObject(t,a,e,200,150);return s.toDataURL("image/png")}static drawBackground(e,s,t,a){if("color"===s.type)e.fillStyle=s.value,e.fillRect(0,0,t,a);else if("gradient"===s.type){let l=e.createLinearGradient(0,0,t,a);l.addColorStop(0,s.value.start),l.addColorStop(1,s.value.end),e.fillStyle=l,e.fillRect(0,0,t,a)}}static drawObject(e,s,t,a,l){let i=a/1e3,n=l/750,r=s.position.x*i,c=s.position.y*n,o=s.position.width*i,d=s.position.height*n;e.save(),e.translate(r+o/2,c+d/2),e.rotate((s.position.rotation||0)*Math.PI/180),"text"===s.type&&s.content?this.drawText(e,s.content,t,o,d):"shape"===s.type&&s.content?this.drawShape(e,s.content,o,d):"image"===s.type&&s.content&&this.drawImagePlaceholder(e,o,d),e.restore()}static drawText(e,s,t,a,l){e.fillStyle=s.color||t.colorPalette.text,e.font="".concat(s.fontSize||t.fontSettings.size," ").concat(s.fontFamily||t.fontSettings.family),e.textAlign="center",e.textBaseline="middle";let i=s.text||"テキスト";e.fillText(i,0,0)}static drawShape(e,s,t,a){e.fillStyle=s.backgroundColor||"#cccccc",e.strokeStyle=s.borderColor||"#000000",e.lineWidth=s.borderWidth||2;let l=t/2,i=a/2;switch(s.shapeType){case"rectangle":default:e.fillRect(-l,-i,t,a),e.strokeRect(-l,-i,t,a);break;case"circle":e.beginPath(),e.arc(0,0,Math.min(l,i),0,2*Math.PI),e.fill(),e.stroke();break;case"triangle":e.beginPath(),e.moveTo(0,-i),e.lineTo(-l,i),e.lineTo(l,i),e.closePath(),e.fill(),e.stroke();break;case"star":this.drawStar(e,0,0,Math.min(l,i),5);break;case"heart":this.drawHeart(e,0,0,Math.min(l,i));break;case"diamond":e.beginPath(),e.moveTo(0,-i),e.lineTo(l,0),e.lineTo(0,i),e.lineTo(-l,0),e.closePath(),e.fill(),e.stroke()}}static drawStar(e,s,t,a,l){let i=.5*a;e.beginPath();for(let n=0;n<2*l;n++){let r=n*Math.PI/l,c=n%2==0?a:i,o=s+Math.cos(r)*c,d=t+Math.sin(r)*c;0===n?e.moveTo(o,d):e.lineTo(o,d)}e.closePath(),e.fill(),e.stroke()}static drawHeart(e,s,t,a){let l=a/20;e.beginPath(),e.moveTo(s,t+5*l),e.bezierCurveTo(s,t,s-5*l,t,s-5*l,t+5*l),e.bezierCurveTo(s-5*l,t+10*l,s,t+10*l,s,t+15*l),e.bezierCurveTo(s,t+10*l,s+5*l,t+10*l,s+5*l,t+5*l),e.bezierCurveTo(s+5*l,t,s,t,s,t+5*l),e.fill(),e.stroke()}static drawImagePlaceholder(e,s,t){e.fillStyle="#f0f0f0",e.fillRect(-s/2,-t/2,s,t),e.strokeStyle="#cccccc",e.lineWidth=1,e.strokeRect(-s/2,-t/2,s,t),e.fillStyle="#999999",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("\uD83D\uDCF7",0,0)}}let U=e=>{let{onSubmit:s}=e,[t,i]=(0,l.useState)({name:"",description:"",category:"custom",style:"simple",difficulty:"beginner",tags:""});return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s({...t,metadata:{version:"1.0.0",author:"User",tags:t.tags.split(",").map(e=>e.trim()).filter(Boolean),difficulty:t.difficulty,estimatedTime:5,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}}})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"name",children:"テンプレート名"}),(0,a.jsx)(f.p,{id:"name",value:t.name,onChange:e=>i({...t,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"category",children:"カテゴリ"}),(0,a.jsxs)(b.l6,{value:t.category,onValueChange:e=>i({...t,category:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(b.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(b.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"description",children:"説明"}),(0,a.jsx)(g.T,{id:"description",value:t.description,onChange:e=>i({...t,description:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"style",children:"スタイル"}),(0,a.jsxs)(b.l6,{value:t.style,onValueChange:e=>i({...t,style:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(b.eb,{value:"cool",children:"クール"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(b.eb,{value:"simple",children:"シンプル"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"difficulty",children:"難易度"}),(0,a.jsxs)(b.l6,{value:t.difficulty,onValueChange:e=>i({...t,difficulty:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(b.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(b.eb,{value:"advanced",children:"上級"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"tags",children:"タグ（カンマ区切り）"}),(0,a.jsx)(f.p,{id:"tags",value:t.tags,onChange:e=>i({...t,tags:e.target.value}),placeholder:"例: ゲーム, アクション, 面白い"})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2",children:(0,a.jsx)(r.$,{type:"submit",children:"作成"})})]})},G=e=>{let{template:s,onSubmit:t}=e,[i,n]=(0,l.useState)({name:s.name,description:s.description,category:s.category,style:s.style,difficulty:s.metadata.difficulty,tags:s.metadata.tags.join(", ")});return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({...s,...i,metadata:{...s.metadata,tags:i.tags.split(",").map(e=>e.trim()).filter(Boolean),difficulty:i.difficulty,lastModified:new Date().toISOString()}})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-name",children:"テンプレート名"}),(0,a.jsx)(f.p,{id:"edit-name",value:i.name,onChange:e=>n({...i,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-category",children:"カテゴリ"}),(0,a.jsxs)(b.l6,{value:i.category,onValueChange:e=>n({...i,category:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(b.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(b.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-description",children:"説明"}),(0,a.jsx)(g.T,{id:"edit-description",value:i.description,onChange:e=>n({...i,description:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-style",children:"スタイル"}),(0,a.jsxs)(b.l6,{value:i.style,onValueChange:e=>n({...i,style:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(b.eb,{value:"cool",children:"クール"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(b.eb,{value:"simple",children:"シンプル"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-difficulty",children:"難易度"}),(0,a.jsxs)(b.l6,{value:i.difficulty,onValueChange:e=>n({...i,difficulty:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(b.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(b.eb,{value:"advanced",children:"上級"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"edit-tags",children:"タグ（カンマ区切り）"}),(0,a.jsx)(f.p,{id:"edit-tags",value:i.tags,onChange:e=>n({...i,tags:e.target.value}),placeholder:"例: ゲーム, アクション, 面白い"})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2",children:(0,a.jsx)(r.$,{type:"submit",children:"更新"})})]})},X=e=>{let{templates:s,onTemplatesChange:t,onSelectTemplate:i}=e,{createTemplateFromCurrentLayers:n,layers:c}=(0,y.S)(),o=(e=>{let{templates:s,onTemplatesChange:t,layers:a,createTemplateFromCurrentLayers:i}=e,[n,r]=(0,l.useState)(!1),[c,o]=(0,l.useState)(!1),[d,m]=(0,l.useState)(null),[h,x]=(0,l.useState)(""),[u,j]=(0,l.useState)("all"),[g,p]=(0,l.useState)("all"),v=(0,l.useMemo)(()=>s.filter(e=>{let s=e.name.toLowerCase().includes(h.toLowerCase())||(e.description||"").toLowerCase().includes(h.toLowerCase())||e.metadata.tags.some(e=>e.toLowerCase().includes(h.toLowerCase())),t="all"===u||e.category===u,a="all"===g||e.metadata.difficulty===g;return s&&t&&a}),[s,h,u,g]),f=(0,l.useCallback)(async e=>{if(0===a.length)return void alert("テンプレートを作成するには、まずプレビューエリアにオブジェクトを配置してください。");let l=i(e);try{let e=await W.generatePreview(l);l.preview=e}catch(e){T.vF.warn("プレビュー画像生成失敗",{error:e},"TemplateManager")}t([...s,l]),r(!1)},[a,i,t,s]),b=(0,l.useCallback)(e=>{m(e),o(!0)},[]),y=(0,l.useCallback)(e=>{t(s.map(s=>s.id===e.id?e:s)),o(!1),m(null)},[s,t]),N=(0,l.useCallback)(e=>{confirm("このテンプレートを削除しますか？")&&t(s.filter(s=>s.id!==e))},[s,t]),w=(0,l.useCallback)(e=>{t([...s,{...e,id:"template-".concat(Date.now()),name:"".concat(e.name,"のコピー"),metadata:{...e.metadata,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},isCustom:!0,createdAt:new Date().toISOString()}])},[s,t]);return{isCreateDialogOpen:n,setIsCreateDialogOpen:r,isEditDialogOpen:c,setIsEditDialogOpen:o,editingTemplate:d,setEditingTemplate:m,searchQuery:h,setSearchQuery:x,selectedCategory:u,setSelectedCategory:j,selectedDifficulty:g,setSelectedDifficulty:p,filteredTemplates:v,handleCreateTemplate:f,handleEditTemplate:b,handleUpdateTemplate:y,handleDeleteTemplate:N,handleDuplicateTemplate:w,handleExportTemplate:(0,l.useCallback)(e=>{let s="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),t="".concat(e.name.replace(/\s+/g,"_"),".json"),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",t),a.click()},[]),handleImportTemplate:(0,l.useCallback)(e=>{var a;let l=null==(a=e.target.files)?void 0:a[0];if(!l)return;let i=new FileReader;i.onload=e=>{try{var a;let l=JSON.parse(null==(a=e.target)?void 0:a.result);l.id="template-".concat(Date.now()),l.isCustom=!0,l.createdAt=new Date().toISOString(),l.metadata.lastModified=new Date().toISOString(),t([...s,l])}catch(e){alert("テンプレートファイルの読み込みに失敗しました。")}},i.readAsText(l),e.target.value=""},[s,t])}})({templates:s,onTemplatesChange:t,layers:c,createTemplateFromCurrentLayers:n});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold whitespace-nowrap",children:"テンプレート管理"}),(0,a.jsx)("p",{className:"text-muted-foreground whitespace-nowrap",children:"カスタムテンプレートの作成、編集、管理を行います"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("import-template"))?void 0:e.click()},children:[(0,a.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"インポート"]}),(0,a.jsx)("input",{id:"import-template",type:"file",accept:".json",onChange:o.handleImportTemplate,className:"hidden"}),(0,a.jsxs)(P.lG,{open:o.isCreateDialogOpen,onOpenChange:o.setIsCreateDialogOpen,children:[(0,a.jsx)(P.zM,{asChild:!0,children:(0,a.jsxs)(r.$,{size:"sm",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"新規作成"]})}),(0,a.jsxs)(P.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{children:"新しいテンプレートを作成"}),(0,a.jsxs)(P.rr,{children:["プレビューエリアのオブジェクトからテンプレートを作成します（",c.length,"個のオブジェクトが配置されています）"]})]}),(0,a.jsx)(U,{onSubmit:o.handleCreateTemplate})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,a.jsx)(f.p,{placeholder:"テンプレートを検索...",value:o.searchQuery,onChange:e=>o.setSearchQuery(e.target.value)})}),(0,a.jsxs)(b.l6,{value:o.selectedCategory,onValueChange:o.setSelectedCategory,children:[(0,a.jsx)(b.bq,{className:"w-[150px]",children:(0,a.jsx)(b.yv,{placeholder:"カテゴリ"})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"all",children:"すべて"}),(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(b.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(b.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]}),(0,a.jsxs)(b.l6,{value:o.selectedDifficulty,onValueChange:o.setSelectedDifficulty,children:[(0,a.jsx)(b.bq,{className:"w-[150px]",children:(0,a.jsx)(b.yv,{placeholder:"難易度"})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"all",children:"すべて"}),(0,a.jsx)(b.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(b.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(b.eb,{value:"advanced",children:"上級"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.filteredTemplates.map(e=>(0,a.jsxs)(N.Zp,{className:"relative",children:[(0,a.jsxs)(N.aR,{className:"pb-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("div",{className:"flex gap-1",children:(0,a.jsxs)(V.Bc,{children:[(0,a.jsxs)(V.m_,{children:[(0,a.jsx)(V.k$,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>i(e),className:"h-7 w-7 p-0",children:(0,a.jsx)(E.A,{className:"h-3 w-3"})})}),(0,a.jsx)(V.ZI,{children:(0,a.jsx)("p",{children:"プレビュー"})})]}),(0,a.jsxs)(V.m_,{children:[(0,a.jsx)(V.k$,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>o.handleEditTemplate(e),className:"h-7 w-7 p-0",children:(0,a.jsx)(O.A,{className:"h-3 w-3"})})}),(0,a.jsx)(V.ZI,{children:(0,a.jsx)("p",{children:"編集"})})]}),(0,a.jsxs)(V.m_,{children:[(0,a.jsx)(V.k$,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>o.handleDeleteTemplate(e.id),className:"h-7 w-7 p-0 text-destructive hover:text-destructive",children:(0,a.jsx)($.A,{className:"h-3 w-3"})})}),(0,a.jsx)(V.ZI,{children:(0,a.jsx)("p",{children:"削除"})})]})]})})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)(N.ZB,{className:"text-lg truncate",children:e.name}),(0,a.jsx)(N.BT,{className:"mt-1 line-clamp-2",children:e.description}),e.preview&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.preview,alt:"".concat(e.name,"のプレビュー"),className:"w-full h-16 object-cover rounded border"})})]})]}),(0,a.jsx)(N.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(w.E,{variant:"secondary",className:"".concat("gaming"===e.category?"bg-blue-100 text-blue-800 border-blue-200":"talk"===e.category?"bg-green-100 text-green-800 border-green-200":"singing"===e.category?"bg-purple-100 text-purple-800 border-purple-200":"collaboration"===e.category?"bg-orange-100 text-orange-800 border-orange-200":"event"===e.category?"bg-pink-100 text-pink-800 border-pink-200":"bg-gray-100 text-gray-800 border-gray-200"),children:e.category}),(0,a.jsx)(w.E,{variant:"outline",children:e.style}),(0,a.jsx)(w.E,{variant:"outline",children:e.metadata.difficulty})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[e.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[e.layout.objects.length,"オブジェクト"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>o.handleDuplicateTemplate(e),className:"flex-1 text-xs",children:"複製"}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>o.handleExportTemplate(e),className:"flex-1 text-xs",children:[(0,a.jsx)(B.A,{className:"h-3 w-3 mr-1"}),"出力"]})]})]})})]},e.id))}),(0,a.jsx)(P.lG,{open:o.isEditDialogOpen,onOpenChange:o.setIsEditDialogOpen,children:(0,a.jsxs)(P.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{children:"テンプレートを編集"}),(0,a.jsx)(P.rr,{children:"テンプレートの情報を編集できます"})]}),o.editingTemplate&&(0,a.jsx)(G,{template:o.editingTemplate,onSubmit:o.handleUpdateTemplate})]})})]})};var Z=t(54997),H=t(57232),Y=t(14801),_=t(6163),K=t(9331),Q=t(38631),ee=t(83708),es=t(9921);class et{validateConfig(){let{target:e,parameters:s,constraints:t}=this.config;return!(s.objectCount.min>s.objectCount.max)&&!(s.objectCount.preferred<s.objectCount.min)&&!(s.objectCount.preferred>s.objectCount.max)&&!(t.minObjectSize>t.maxObjectSize)}generateId(){return"auto-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}generateName(e,s){let t={cute:["可愛い","キュート","チャーミング"],cool:["クール","スタイリッシュ","モダン"],elegant:["エレガント","上品","洗練された"],funny:["面白い","ユーモラス","楽しい"],simple:["シンプル","ミニマル","クリーン"]},a={gaming:["ゲーム","プレイ","バトル"],talk:["トーク","おしゃべり","雑談"],singing:["歌","ミュージック","パフォーマンス"],collaboration:["コラボ","協力","チーム"],event:["イベント","お祭り","特別"],custom:["カスタム","オリジナル","ユニーク"]},l=t[s]||t.simple,i=a[e]||a.custom,n=l[Math.floor(Math.random()*l.length)],r=i[Math.floor(Math.random()*i.length)];return"".concat(n).concat(r,"テンプレート")}constructor(e){this.config=e}}class ea extends et{async generate(){let e=Date.now();if(!this.validateConfig())throw Error("Invalid configuration");let s=await this.generateTemplate(),t=await this.evaluate(s);return{template:s,score:t,metadata:{generationTime:Date.now()-e,algorithm:"rule-based",version:"1.0.0"},suggestions:this.generateSuggestions(s,t)}}async generateTemplate(){let{target:e,parameters:s,constraints:t}=this.config,a=this.colorPalettes[s.colorScheme]||this.colorPalettes.complementary,l=a[Math.floor(Math.random()*a.length)],i=this.fontSettings[s.fontStyle]||this.fontSettings.modern,n=this.determineObjectCount(),r=this.generateLayout(n,e.aspectRatio);return{id:this.generateId(),name:this.generateName(e.category,e.style),description:"".concat(e.category,"向けの").concat(e.style,"なデザインテンプレート"),category:e.category,style:e.style,rating:0,preview:"",supportedAspectRatios:[e.aspectRatio],layout:r,colorPalette:l,fontSettings:{family:i.family,size:this.determineFontSize(e.difficulty),weight:i.weight,style:i.style,lineHeight:1.2,letterSpacing:"0",textAlign:"center",textDecoration:"none",textShadow:"none"},settings:{defaultFontSize:this.determineFontSize(e.difficulty),defaultFontFamily:i.family,defaultTextColor:l.text,defaultBackgroundColor:l.background,maxObjects:t.maxObjectSize,minObjectSize:t.minObjectSize,maxObjectSize:t.maxObjectSize,allowAnimation:!1,allowEffects:!1,allowVideo:!1,allowGif:!1,exportFormats:["png","jpg"],defaultExportFormat:"png",exportQuality:"high"},metadata:{version:"1.0.0",author:"Auto Generator",tags:this.generateTags(e.category,e.style),difficulty:e.difficulty,estimatedTime:this.estimateTime(n,e.difficulty),lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},isCustom:!1,createdAt:new Date().toISOString()}}determineObjectCount(){let{min:e,max:s,preferred:t}=this.config.parameters.objectCount,{difficulty:a}=this.config.target;return Math.max(e,Math.min(s,Math.round(t*({beginner:.7,intermediate:1,advanced:1.3})[a])))}generateLayout(e,s){let[t,a]=s.split(":").map(Number),l=1e3*a/t,i=[],n=Math.max(1,Math.floor(.6*e));for(let e=0;e<n;e++)i.push(this.generateTextObject(e,1e3,l));let r=e-n;for(let e=0;e<r;e++)i.push(this.generateShapeObject(e,1e3,l));return{background:{type:"color",value:"#ffffff"},objects:i}}generateTextObject(e,s,t){let a=this.generatePositions(s,t),l=a[e%a.length];return{id:"text-".concat(e),type:"text",visible:!0,locked:!1,position:{x:l.x,y:l.y,width:l.width,height:l.height,rotation:0,opacity:1},zIndex:e+1,content:{text:this.generateTextContent(e),color:"#1f2937",fontSize:this.determineFontSize(this.config.target.difficulty),fontFamily:this.fontSettings[this.config.parameters.fontStyle].family}}}generateShapeObject(e,s,t){let a=this.generatePositions(s,t),l=a[e%a.length],i=["rectangle","circle","triangle","star"],n=i[Math.floor(Math.random()*i.length)];return{id:"shape-".concat(e),type:"shape",visible:!0,locked:!1,position:{x:l.x,y:l.y,width:l.width,height:l.height,rotation:360*Math.random(),opacity:.8},zIndex:e+1,content:{shapeType:n,backgroundColor:this.getRandomColor(),borderColor:"#000000",borderWidth:2}}}generatePositions(e,s){let t=[];for(let a=0;a<3;a++)for(let l=0;l<3;l++){let i=50+l*(e-100)/3,n=50+a*(s-100)/3,r=(e-100)/3-20,c=(s-100)/3-20;t.push({x:i,y:n,width:r,height:c})}return t}generateTextContent(e){let s=["サンプルテキスト","タイトル","サブタイトル","説明文","キャッチコピー","メッセージ","テーマ","コンセプト"];return s[e%s.length]}determineFontSize(e){let s={beginner:["2rem","2.5rem","3rem"],intermediate:["1.5rem","2rem","2.5rem","3rem","3.5rem"],advanced:["1rem","1.5rem","2rem","2.5rem","3rem","3.5rem","4rem"]},t=s[e]||s.beginner;return t[Math.floor(Math.random()*t.length)]}getRandomColor(){let e=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"];return e[Math.floor(Math.random()*e.length)]}generateTags(e,s){return[...{gaming:["ゲーム","プレイ","バトル","アクション"],talk:["トーク","おしゃべり","雑談","コミュニケーション"],singing:["歌","ミュージック","パフォーマンス","音楽"],collaboration:["コラボ","協力","チーム","パートナーシップ"],event:["イベント","お祭り","特別","記念"],custom:["カスタム","オリジナル","ユニーク","特別"]}[e]||[],...{cute:["可愛い","キュート","チャーミング","愛らしい"],cool:["クール","スタイリッシュ","モダン","洗練"],elegant:["エレガント","上品","洗練された","美しい"],funny:["面白い","ユーモラス","楽しい","愉快"],simple:["シンプル","ミニマル","クリーン","シンプル"]}[s]||[],"自動生成"]}estimateTime(e,s){return Math.round(2*e*({beginner:1,intermediate:1.5,advanced:2})[s])}async evaluate(e){let s=this.evaluateAesthetics(e),t=this.evaluateUsability(e),a=this.evaluateUniqueness(e),l=this.evaluateTrendiness(e);return{overall:Math.round((s+t+a+l)/4),aesthetics:Math.round(s),usability:Math.round(t),uniqueness:Math.round(a),trendiness:Math.round(l)}}evaluateAesthetics(e){let s=50,{primary:t,secondary:a,accent:l}=e.colorPalette;this.isColorHarmonious(t,a)&&(s+=10),this.isColorHarmonious(a,l)&&(s+=10);let i=e.layout.objects.length;return i>=3&&i<=8&&(s+=15),i>8&&(s-=10),"Arial, sans-serif"!==e.fontSettings.family&&(s+=5),Math.min(100,Math.max(0,s))}evaluateUsability(e){let s=50,t=e.layout.objects.length;return t>=2&&t<=6&&(s+=20),t>6&&(s-=15),e.layout.objects.filter(e=>"text"===e.type).length>0&&(s+=10),"color"===e.layout.background.type&&(s+=5),Math.min(100,Math.max(0,s))}evaluateUniqueness(e){let s=30,{primary:t,secondary:a,accent:l}=e.colorPalette;return this.isUniqueColorCombination(t,a,l)&&(s+=20),e.layout.objects.length%2==1&&(s+=10),(e.fontSettings.family.includes("serif")||e.fontSettings.family.includes("cursive"))&&(s+=15),Math.min(100,Math.max(0,s))}evaluateTrendiness(e){let s=40,t=new Date().getFullYear();return e.createdAt&&new Date(e.createdAt).getFullYear()===t&&(s+=10),(e.fontSettings.family.includes("Inter")||e.fontSettings.family.includes("Roboto"))&&(s+=15),e.layout.objects.length<=4&&(s+=10),Math.min(100,Math.max(0,s))}isColorHarmonious(e,s){let t=e.replace("#",""),a=s.replace("#",""),l=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),n=parseInt(t.substr(4,2),16),r=parseInt(a.substr(0,2),16),c=Math.sqrt((l-r)**2+(i-parseInt(a.substr(2,2),16))**2+(n-parseInt(a.substr(4,2),16))**2);return c>100&&c<300}isUniqueColorCombination(e,s,t){return 3===new Set([e,s,t]).size}generateSuggestions(e,s){let t=[];return s.aesthetics<70&&(t.push("カラーパレットの調整を検討してください"),t.push("オブジェクトの配置バランスを改善してください")),s.usability<70&&(t.push("テキストの可読性を向上させてください"),t.push("オブジェクト数を適切な範囲に調整してください")),s.uniqueness<60&&(t.push("より独自性のあるデザイン要素を追加してください"),t.push("カラーパレットの組み合わせを変更してください")),s.trendiness<60&&(t.push("モダンなフォントを使用してください"),t.push("ミニマルなデザインを心がけてください")),0===t.length&&t.push("バランスの取れた良いテンプレートです"),t}constructor(...e){super(...e),this.colorPalettes={monochrome:[{primary:"#2D3748",secondary:"#4A5568",accent:"#718096",background:"#F7FAFC",text:"#1A202C"},{primary:"#2B6CB0",secondary:"#3182CE",accent:"#4299E1",background:"#EBF8FF",text:"#1A365D"},{primary:"#805AD5",secondary:"#9F7AEA",accent:"#B794F6",background:"#FAF5FF",text:"#322659"}],complementary:[{primary:"#E53E3E",secondary:"#38A169",accent:"#D69E2E",background:"#FFF5F5",text:"#1A202C"},{primary:"#3182CE",secondary:"#E53E3E",accent:"#38A169",background:"#EBF8FF",text:"#1A365D"},{primary:"#805AD5",secondary:"#D69E2E",accent:"#38A169",background:"#FAF5FF",text:"#322659"}],triadic:[{primary:"#E53E3E",secondary:"#38A169",accent:"#3182CE",background:"#FFF5F5",text:"#1A202C"},{primary:"#805AD5",secondary:"#E53E3E",accent:"#38A169",background:"#FAF5FF",text:"#322659"},{primary:"#D69E2E",secondary:"#3182CE",accent:"#E53E3E",background:"#FFFBEB",text:"#1A202C"}]},this.fontSettings={modern:{family:"Inter, sans-serif",weight:"500",style:"normal"},classic:{family:"Georgia, serif",weight:"400",style:"normal"},playful:{family:"Comic Sans MS, cursive",weight:"400",style:"normal"},elegant:{family:"Playfair Display, serif",weight:"400",style:"italic"},bold:{family:"Impact, Arial Black, sans-serif",weight:"900",style:"normal"}}}}class el extends et{async generate(){let e=Date.now();if(!this.validateConfig())throw Error("Invalid configuration");let s=await this.callAIAPI(),t=await this.evaluate(s);return{template:s,score:t,metadata:{generationTime:Date.now()-e,algorithm:"ai-powered",version:"1.0.0"},suggestions:this.generateSuggestions(s,t)}}async callAIAPI(){throw Error("AI generation not yet implemented")}async evaluate(e){return{overall:85,aesthetics:90,usability:80,uniqueness:85,trendiness:90}}generateSuggestions(e,s){return["AI生成による高品質なテンプレートです"]}constructor(e,s,t){super(e),this.apiEndpoint=s,this.apiKey=t}}class ei{static createGenerator(e,s,t){switch(e){case"rule-based":return new ea(s);case"ai-powered":if(!(null==t?void 0:t.apiEndpoint)||!(null==t?void 0:t.apiKey))throw Error("API endpoint and key required for AI generator");return new el(s,t.apiEndpoint,t.apiKey);default:throw Error("Unknown generator type: ".concat(e))}}}let en={target:{category:"custom",style:"simple",aspectRatio:"16:9",difficulty:"beginner"},parameters:{objectCount:{min:2,max:8,preferred:4},colorScheme:"complementary",fontStyle:"modern",layoutType:"centered"},constraints:{maxTextLength:50,minObjectSize:20,maxObjectSize:400,allowOverlap:!1,requireBalance:!0},quality:{complexity:"medium",uniqueness:"medium",trendiness:"medium"}},er=e=>{let{onTemplateGenerated:s,onTemplatesGenerated:t}=e,[i,c]=(0,l.useState)(en),[o,d]=(0,l.useState)(!1),[m,x]=(0,l.useState)([]),[u,j]=(0,l.useState)(null),[g,f]=(0,l.useState)(1),y=e=>{c(s=>({...s,target:{...s.target,...e}}))},C=e=>{c(s=>({...s,parameters:{...s.parameters,...e}}))},k=e=>{c(s=>({...s,quality:{...s.quality,...e}}))},z=async()=>{d(!0);try{let e=ei.createGenerator("rule-based",i),s=[];for(let t=0;t<g;t++){let t=await e.generate();s.push(t)}x(s),n.oR.success("".concat(g,"個のテンプレートを生成しました！"))}catch(e){T.vF.error("テンプレート生成失敗",e,"AutoGenerationPanel"),n.oR.error("テンプレート生成に失敗しました")}finally{d(!1)}},F=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600";return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2 whitespace-nowrap",children:[(0,a.jsx)(S.A,{className:"h-6 w-6 text-purple-500"}),"AI自動生成"]}),(0,a.jsx)("p",{className:"text-muted-foreground whitespace-nowrap",children:"AIが自動でテンプレートを生成します"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{c(en),n.oR.success("設定をリセットしました")},children:[(0,a.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"リセット"]})})]}),(0,a.jsxs)(h.tU,{defaultValue:"basic",className:"w-full",children:[(0,a.jsxs)(h.j7,{className:"grid w-full grid-cols-3 h-auto",children:[(0,a.jsx)(h.Xi,{value:"basic",className:"text-xs sm:text-sm",children:"基本設定"}),(0,a.jsx)(h.Xi,{value:"advanced",className:"text-xs sm:text-sm",children:"詳細設定"}),(0,a.jsx)(h.Xi,{value:"results",className:"text-xs sm:text-sm",children:"生成結果"})]}),(0,a.jsxs)(h.av,{value:"basic",className:"space-y-6",children:[(0,a.jsxs)(N.Zp,{children:[(0,a.jsxs)(N.aR,{children:[(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(Y.A,{className:"h-5 w-5"}),"生成対象"]}),(0,a.jsx)(N.BT,{children:"生成するテンプレートの基本情報を設定します"})]}),(0,a.jsxs)(N.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"category",children:"カテゴリ"}),(0,a.jsxs)(b.l6,{value:i.target.category,onValueChange:e=>y({category:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーミング"}),(0,a.jsx)(b.eb,{value:"talk",children:"トーク"}),(0,a.jsx)(b.eb,{value:"singing",children:"音楽"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"style",children:"スタイル"}),(0,a.jsxs)(b.l6,{value:i.target.style,onValueChange:e=>y({style:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"cute",children:"キュート"}),(0,a.jsx)(b.eb,{value:"cool",children:"クール"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"funny",children:"ファニー"}),(0,a.jsx)(b.eb,{value:"simple",children:"シンプル"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"aspectRatio",children:"アスペクト比"}),(0,a.jsxs)(b.l6,{value:i.target.aspectRatio,onValueChange:e=>y({aspectRatio:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"1:1",children:"1:1 (正方形)"}),(0,a.jsx)(b.eb,{value:"4:3",children:"4:3 (標準)"}),(0,a.jsx)(b.eb,{value:"16:9",children:"16:9 (横長)"}),(0,a.jsx)(b.eb,{value:"9:16",children:"9:16 (縦長)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"difficulty",children:"難易度"}),(0,a.jsxs)(b.l6,{value:i.target.difficulty,onValueChange:e=>y({difficulty:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(b.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(b.eb,{value:"advanced",children:"上級"})]})]})]})]})]})]}),(0,a.jsxs)(N.Zp,{children:[(0,a.jsxs)(N.aR,{children:[(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.A,{className:"h-5 w-5"}),"生成設定"]}),(0,a.jsx)(N.BT,{children:"生成するテンプレートの数と品質を設定します"})]}),(0,a.jsxs)(N.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v.J,{htmlFor:"generationCount",children:["生成数: ",g,"個"]}),(0,a.jsx)(p.A,{value:[g],onValueChange:e=>f(e[0]),min:1,max:10,step:1,className:"mt-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"複雑さ"}),(0,a.jsxs)(b.l6,{value:i.quality.complexity,onValueChange:e=>k({complexity:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"low",children:"低"}),(0,a.jsx)(b.eb,{value:"medium",children:"中"}),(0,a.jsx)(b.eb,{value:"high",children:"高"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"独自性"}),(0,a.jsxs)(b.l6,{value:i.quality.uniqueness,onValueChange:e=>k({uniqueness:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"low",children:"低"}),(0,a.jsx)(b.eb,{value:"medium",children:"中"}),(0,a.jsx)(b.eb,{value:"high",children:"高"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{children:"トレンド性"}),(0,a.jsxs)(b.l6,{value:i.quality.trendiness,onValueChange:e=>k({trendiness:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"low",children:"低"}),(0,a.jsx)(b.eb,{value:"medium",children:"中"}),(0,a.jsx)(b.eb,{value:"high",children:"高"})]})]})]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(r.$,{onClick:z,disabled:o,size:"lg",className:"px-8",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.A,{className:"h-5 w-5 mr-2 animate-spin"}),"生成中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.A,{className:"h-5 w-5 mr-2"}),"テンプレート生成"]})})})]}),(0,a.jsxs)(h.av,{value:"advanced",className:"space-y-6",children:[(0,a.jsxs)(N.Zp,{children:[(0,a.jsx)(N.aR,{children:(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"h-5 w-5"}),"カラーパレット"]})}),(0,a.jsx)(N.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"colorScheme",children:"配色パターン"}),(0,a.jsxs)(b.l6,{value:i.parameters.colorScheme,onValueChange:e=>C({colorScheme:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"monochrome",children:"モノクロ"}),(0,a.jsx)(b.eb,{value:"complementary",children:"補色"}),(0,a.jsx)(b.eb,{value:"triadic",children:"三色配色"}),(0,a.jsx)(b.eb,{value:"analogous",children:"類似色"}),(0,a.jsx)(b.eb,{value:"random",children:"ランダム"})]})]})]})})]}),(0,a.jsxs)(N.Zp,{children:[(0,a.jsx)(N.aR,{children:(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ee.A,{className:"h-5 w-5"}),"フォント設定"]})}),(0,a.jsx)(N.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"fontStyle",children:"フォントスタイル"}),(0,a.jsxs)(b.l6,{value:i.parameters.fontStyle,onValueChange:e=>C({fontStyle:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"modern",children:"モダン"}),(0,a.jsx)(b.eb,{value:"classic",children:"クラシック"}),(0,a.jsx)(b.eb,{value:"playful",children:"プレイフル"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"bold",children:"ボールド"})]})]})]})})]}),(0,a.jsxs)(N.Zp,{children:[(0,a.jsx)(N.aR,{children:(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(es.A,{className:"h-5 w-5"}),"レイアウト設定"]})}),(0,a.jsxs)(N.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{htmlFor:"layoutType",children:"レイアウトタイプ"}),(0,a.jsxs)(b.l6,{value:i.parameters.layoutType,onValueChange:e=>C({layoutType:e}),children:[(0,a.jsx)(b.bq,{children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"centered",children:"中央配置"}),(0,a.jsx)(b.eb,{value:"asymmetric",children:"非対称"}),(0,a.jsx)(b.eb,{value:"grid",children:"グリッド"}),(0,a.jsx)(b.eb,{value:"flow",children:"フロー"}),(0,a.jsx)(b.eb,{value:"random",children:"ランダム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(v.J,{children:["オブジェクト数: ",i.parameters.objectCount.preferred,"個"]}),(0,a.jsx)(p.A,{value:[i.parameters.objectCount.preferred],onValueChange:e=>C({objectCount:{...i.parameters.objectCount,preferred:e[0]}}),min:i.parameters.objectCount.min,max:i.parameters.objectCount.max,step:1,className:"mt-2"})]})]})]})]}),(0,a.jsx)(h.av,{value:"results",className:"space-y-6",children:0===m.length?(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(S.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"テンプレートが生成されていません"}),(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"基本設定タブでテンプレートを生成してください"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["生成結果 (",m.length,"個)"]}),(0,a.jsxs)(r.$,{onClick:()=>{let e=m.map(e=>e.template);t(e),n.oR.success("".concat(e.length,"個のテンプレートを追加しました！"))},variant:"outline",children:[(0,a.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"全て追加"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((e,t)=>(0,a.jsxs)(N.Zp,{className:"relative",children:[(0,a.jsx)(N.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(N.ZB,{className:"text-lg",children:e.template.name}),(0,a.jsx)(N.BT,{className:"mt-1",children:e.template.description})]}),(0,a.jsxs)(w.E,{variant:"secondary",className:"ml-2",children:["#",t+1]})]})}),(0,a.jsx)(N.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{children:"総合スコア"}),(0,a.jsxs)("span",{className:"font-semibold ".concat(F(e.score.overall)),children:[e.score.overall,"/100"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"美学"}),(0,a.jsx)("span",{className:F(e.score.aesthetics),children:e.score.aesthetics})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"使いやすさ"}),(0,a.jsx)("span",{className:F(e.score.usability),children:e.score.usability})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"独自性"}),(0,a.jsx)("span",{className:F(e.score.uniqueness),children:e.score.uniqueness})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"トレンド性"}),(0,a.jsx)("span",{className:F(e.score.trendiness),children:e.score.trendiness})]})]})]}),(0,a.jsx)(Z.w,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[e.template.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[e.template.layout.objects.length,"オブジェクト"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>(e=>{j(e),s(e.template),n.oR.success("テンプレートを選択しました！")})(e),className:"flex-1",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"選択"]}),(0,a.jsxs)(P.lG,{children:[(0,a.jsx)(P.zM,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"outline",size:"sm",children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(P.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{children:"テンプレート詳細"}),(0,a.jsxs)(P.rr,{children:[e.template.name,"の詳細情報と改善提案"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"スコア詳細"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"総合スコア"}),(0,a.jsxs)("span",{className:F(e.score.overall),children:[e.score.overall,"/100"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"美学"}),(0,a.jsxs)("span",{className:F(e.score.aesthetics),children:[e.score.aesthetics,"/100"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"使いやすさ"}),(0,a.jsxs)("span",{className:F(e.score.usability),children:[e.score.usability,"/100"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"独自性"}),(0,a.jsxs)("span",{className:F(e.score.uniqueness),children:[e.score.uniqueness,"/100"]})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"改善提案"}),(0,a.jsx)("ul",{className:"space-y-1",children:e.suggestions.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"生成情報"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{children:["生成時間: ",e.metadata.generationTime,"ms"]}),(0,a.jsxs)("div",{children:["アルゴリズム: ",e.metadata.algorithm]}),(0,a.jsxs)("div",{children:["バージョン: ",e.metadata.version]})]})]})]})]})]})]})]})})]},e.template.id))})]})})]})]})},ec=["1:1","4:3","9:16","16:9"];var eo=t(73686);let ed=e=>{let{onCreateTemplate:s,onClose:t}=e,[i,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[m,h]=(0,l.useState)("custom"),[x,u]=(0,l.useState)("simple"),[j,p]=(0,l.useState)(""),[y,w]=(0,l.useState)(""),[C,S]=(0,l.useState)(!1),[z,E]=(0,l.useState)(!1),A=async e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){S(!0);try{let e=await new Promise((e,s)=>{let a=new FileReader;a.onload=s=>{var t;e(null==(t=s.target)?void 0:t.result)},a.onerror=()=>{s(Error("Failed to read file"))},a.readAsDataURL(t)});p(e),E(!0);let s=await J(e);w(s),n.oR.success("画像をアップロードし、プレビューを生成しました！")}catch(e){T.vF.error("画像アップロード失敗",e,"TemplateSelector"),n.oR.error("画像のアップロードに失敗しました")}finally{S(!1),E(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)(N.Zp,{className:"w-full max-w-md mx-4",children:[(0,a.jsxs)(N.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(k.A,{className:"h-5 w-5"}),"カスタムテンプレート作成"]}),(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:t,children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"既存のサムネイル画像をアップロードしてテンプレートとして保存できます"}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:(0,a.jsxs)("p",{className:"text-xs text-yellow-800",children:[(0,a.jsx)("strong",{children:"注意:"})," カスタムテンプレートは現在1280\xd7720でのエクスポートのみ対応しています。 他の解像度でのエクスポートは正常に動作しない場合があります。"]})})]}),(0,a.jsxs)(N.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"テンプレート画像"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(f.p,{type:"file",accept:"image/*",onChange:A,className:"mb-2"}),j&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"aspect-video bg-gray-100 rounded-md overflow-hidden",children:(0,a.jsx)("img",{src:j,alt:"テンプレート",className:"w-full h-full object-cover"})}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"元画像 (1280\xd7720px推奨)"})]}),y&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"aspect-video bg-gray-100 rounded-md overflow-hidden max-w-xs",children:(0,a.jsx)("img",{src:y,alt:"プレビュー",className:"w-full h-full object-cover"})}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"プレビュー画像 (320\xd7180px)"})]}),C&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"アップロード中..."}),z&&(0,a.jsx)("p",{className:"text-xs text-blue-500 mt-1",children:"プレビュー生成中..."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"テンプレート名"}),(0,a.jsx)(f.p,{value:i,onChange:e=>c(e.target.value),placeholder:"テンプレート名を入力",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"説明"}),(0,a.jsx)(g.T,{value:o,onChange:e=>d(e.target.value),placeholder:"テンプレートの説明を入力",className:"mt-1 min-h-[80px] resize-none"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"カテゴリ"}),(0,a.jsxs)(b.l6,{value:m,onValueChange:h,children:[(0,a.jsx)(b.bq,{className:"mt-1",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーム"}),(0,a.jsx)(b.eb,{value:"talk",children:"雑談"}),(0,a.jsx)(b.eb,{value:"singing",children:"歌枠"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"スタイル"}),(0,a.jsxs)(b.l6,{value:x,onValueChange:u,children:[(0,a.jsx)(b.bq,{className:"mt-1",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"cute",children:"可愛い"}),(0,a.jsx)(b.eb,{value:"cool",children:"クール"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"funny",children:"面白い"}),(0,a.jsx)(b.eb,{value:"simple",children:"シンプル"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsxs)(r.$,{onClick:()=>i.trim()?j?void(s({name:i,description:o,category:m,style:x,preview:y}),c(""),d(""),h("custom"),u("simple"),p(""),w("")):void n.oR.error("テンプレート画像をアップロードしてください"):void n.oR.error("テンプレート名を入力してください"),className:"flex-1",disabled:!i.trim(),children:[(0,a.jsx)(R.A,{className:"h-4 w-4 mr-2"}),"テンプレートを作成"]}),(0,a.jsx)(r.$,{variant:"outline",onClick:t,children:"キャンセル"})]})]})]})})},em=e=>{let{onSelectTemplate:s,selectedTemplateId:t}=e,{aspectRatio:i,setAspectRatio:c,customAspectRatio:d,setCustomAspectRatio:m}=(0,y.S)(),[h,x]=(0,l.useState)(""),[u,j]=(0,l.useState)("all"),[g,p]=(0,l.useState)("all"),[R,T]=(0,l.useState)("all"),[M,J]=(0,l.useState)(!1),[P,L]=(0,l.useState)([]),[O,$]=(0,l.useState)(eo.k),[B,V]=(0,l.useState)("browse");(0,l.useEffect)(()=>{let e=localStorage.getItem("customThumbnailTemplates");if(e){let s=JSON.parse(e);L(s),$([...eo.k,...s])}},[]);let W=(e,s)=>{let t=parseInt(e.target.value,10),a={...d,[s]:t};!isNaN(t)&&t>0&&(m(a),c("custom"))},U=O.filter(e=>{var s;let t=e.name.toLowerCase().includes(h.toLowerCase())||(null==(s=e.description)?void 0:s.toLowerCase().includes(h.toLowerCase()))||e.metadata.tags.some(e=>e.toLowerCase().includes(h.toLowerCase())),a="all"===u||e.category===u,l="all"===g||e.style===g,n="all"===R||e.metadata.difficulty===R,r="custom"===i||e.supportedAspectRatios.includes(i);return t&&a&&l&&n&&r}),G=e=>{if(confirm("このカスタムテンプレートを削除しますか？")){let s=P.filter(s=>s.id!==e);L(s),$([...eo.k,...s]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(s)),n.oR.success("カスタムテンプレートを削除しました！")}},Z=e=>{L(e),$([...eo.k,...e]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(e))};return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"border-b mb-4",children:(0,a.jsxs)("div",{className:"flex justify-center",children:[(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("browse"===B?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>V("browse"),children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"選択"})]}),(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("manage"===B?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>V("manage"),children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"管理"})]}),(0,a.jsxs)("button",{className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ".concat("auto-generate"===B?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),onClick:()=>V("auto-generate"),children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"AI生成"})]})]})}),"browse"===B?(0,a.jsxs)(I.nD,{type:"multiple",className:"w-full",defaultValue:["aspect-ratio","templates"],children:[(0,a.jsxs)(I.As,{value:"aspect-ratio",children:[(0,a.jsx)(I.$m,{children:"アスペクト比"}),(0,a.jsxs)(I.ub,{className:"space-y-4 pt-4",children:[(0,a.jsx)(v.J,{children:"プリセット"}),(0,a.jsx)(q.O,{type:"single",value:"custom"===i?"":i,onValueChange:e=>{e&&c(e)},variant:"outline",className:"flex-wrap justify-start",children:ec.map(e=>(0,a.jsx)(q.d,{value:e,"aria-label":"比率 ".concat(e),children:e},e))}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{children:"手動設定"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.p,{type:"number",placeholder:"幅",className:"w-24",value:d.width,onChange:e=>W(e,"width")}),(0,a.jsx)("span",{children:":"}),(0,a.jsx)(f.p,{type:"number",placeholder:"高さ",className:"w-24",value:d.height,onChange:e=>W(e,"height")})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"小さい数字で比率、大きい数字で解像度を指定できます。"})]})]})]}),(0,a.jsxs)(I.As,{value:"templates",children:[(0,a.jsx)(I.$m,{children:"テンプレート選択"}),(0,a.jsx)(I.ub,{className:"pt-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg md:text-lg font-semibold",children:"テンプレート選択"}),(0,a.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>J(!0),className:"flex items-center gap-1 md:gap-2 h-9 px-3 md:px-4",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"カスタム作成"}),(0,a.jsx)("span",{className:"sm:hidden",children:"作成"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(f.p,{placeholder:"テンプレートを検索...",value:h,onChange:e=>x(e.target.value),className:"pl-10 h-10 md:h-9"})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,a.jsxs)(b.l6,{value:u,onValueChange:j,children:[(0,a.jsx)(b.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(b.yv,{placeholder:"カテゴリ"})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"all",children:"すべて"}),(0,a.jsx)(b.eb,{value:"gaming",children:"ゲーム"}),(0,a.jsx)(b.eb,{value:"talk",children:"雑談"}),(0,a.jsx)(b.eb,{value:"singing",children:"歌枠"}),(0,a.jsx)(b.eb,{value:"collaboration",children:"コラボ"}),(0,a.jsx)(b.eb,{value:"event",children:"イベント"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]}),(0,a.jsxs)(b.l6,{value:g,onValueChange:p,children:[(0,a.jsx)(b.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(b.yv,{placeholder:"スタイル"})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"all",children:"すべて"}),(0,a.jsx)(b.eb,{value:"cute",children:"可愛い"}),(0,a.jsx)(b.eb,{value:"cool",children:"クール"}),(0,a.jsx)(b.eb,{value:"elegant",children:"エレガント"}),(0,a.jsx)(b.eb,{value:"funny",children:"面白い"}),(0,a.jsx)(b.eb,{value:"simple",children:"シンプル"})]})]}),(0,a.jsxs)(b.l6,{value:R,onValueChange:T,children:[(0,a.jsx)(b.bq,{className:"w-full md:w-32 h-10 md:h-9",children:(0,a.jsx)(b.yv,{placeholder:"難易度"})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"all",children:"すべて"}),(0,a.jsx)(b.eb,{value:"beginner",children:"初級"}),(0,a.jsx)(b.eb,{value:"intermediate",children:"中級"}),(0,a.jsx)(b.eb,{value:"advanced",children:"上級"})]})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-3",children:U.map(e=>(0,a.jsx)("div",{className:(0,D.cn)("relative group cursor-pointer transition-all hover:scale-[1.02] md:hover:scale-105 p-1",t===e.id&&"ring-2 ring-blue-500 ring-inset"),onClick:()=>s(e),children:(0,a.jsx)(N.Zp,{className:"overflow-hidden md:block",children:(0,a.jsxs)("div",{className:"flex md:block",children:[(0,a.jsxs)("div",{className:"w-24 h-16 md:w-full md:aspect-video bg-gray-100 dark:bg-gray-800 relative flex-shrink-0",children:[e.preview?(0,a.jsx)("img",{src:e.preview,alt:e.name,className:"w-full h-full object-cover"}):(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-center text-xs md:text-sm relative overflow-hidden",style:{background:"color"===e.layout.background.type||"gradient"===e.layout.background.type?e.layout.background.value:"#f8f9fa"},children:[e.layout.objects.map(s=>{var t,l;return"text"===s.type&&(null==(t=s.content)?void 0:t.text)?(0,a.jsx)("div",{className:"absolute",style:{left:"".concat(s.position.x/1200*100,"%"),top:"".concat(s.position.y/675*100,"%"),width:"".concat(s.position.width/1200*100,"%"),height:"".concat(s.position.height/675*100,"%"),fontSize:"0.5rem",color:s.content.color||e.colorPalette.text,fontFamily:s.content.fontFamily||e.fontSettings.family,fontWeight:(null==(l=s.content.fontSize)?void 0:l.includes("bold"))?"bold":"normal",textAlign:s.content.textAlign||e.fontSettings.textAlign,display:"flex",alignItems:"center",justifyContent:"center",transform:"scale(".concat(Math.min(1,100/(s.content.text.length||1)),")")},children:s.content.text},s.id):null}),0===e.layout.objects.length&&e.initialText&&(0,a.jsx)("p",{className:"font-bold text-center px-1",style:{color:e.initialTextColor||e.colorPalette.text,fontSize:"0.5rem"},children:e.initialText})]}),(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 md:group-hover:opacity-100 transition-opacity hidden md:flex items-center justify-center gap-2",children:[(0,a.jsxs)(r.$,{size:"sm",variant:"secondary",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"プレビュー"]}),e.isCustom&&(0,a.jsxs)(r.$,{size:"sm",variant:"destructive",onClick:s=>{s.stopPropagation(),G(e.id)},children:[(0,a.jsx)(F.A,{className:"h-4 w-4 mr-1"}),"削除"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 p-3 md:p-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-sm md:text-sm truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1 md:line-clamp-2",children:e.description})]}),e.isCustom&&(0,a.jsx)(r.$,{size:"sm",variant:"ghost",className:"md:hidden ml-2 h-6 w-6 p-0",onClick:s=>{s.stopPropagation(),G(e.id)},children:(0,a.jsx)(F.A,{className:"h-3 w-3"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(w.E,{variant:"secondary",className:"text-xs",children:"gaming"===e.category?"ゲーム":"talk"===e.category?"雑談":"singing"===e.category?"歌枠":"collaboration"===e.category?"コラボ":"event"===e.category?"イベント":"カスタム"}),(0,a.jsx)(w.E,{variant:"outline",className:"text-xs",style:{color:"beginner"===e.metadata.difficulty?"#22c55e":"intermediate"===e.metadata.difficulty?"#f59e0b":"#ef4444"},children:"beginner"===e.metadata.difficulty?"初級":"intermediate"===e.metadata.difficulty?"中級":"上級"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(A.A,{className:"h-3 w-3 text-yellow-500"}),(0,a.jsx)("span",{className:"text-xs",children:e.rating})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1 text-xs text-gray-400",children:[(0,a.jsxs)("span",{children:[e.metadata.estimatedTime,"分"]}),(0,a.jsxs)("span",{children:[e.layout.objects.length,"オブジェクト"]})]})]})]})})},e.id))}),M&&(0,a.jsx)(ed,{onCreateTemplate:e=>{let s=[...P,{id:"custom-".concat(Date.now()),name:e.name||"カスタムテンプレート",description:e.description||"",category:e.category||"custom",style:e.style||"simple",rating:0,preview:e.preview||"",supportedAspectRatios:["16:9","9:16","1:1","4:3"],layout:{background:{type:"color",value:"#FFFFFF"},objects:[{id:"text-main",type:"text",position:{x:340,y:285,width:600,height:150},content:{text:"新しいテキスト",fontSize:"4rem",fontFamily:"Arial, sans-serif",color:"#000000"},zIndex:1,visible:!0}]},colorPalette:{primary:"#000000",secondary:"#333333",accent:"#007bff",background:"#FFFFFF",text:"#000000",light:"#FFFFFF",dark:"#000000",muted:"#6c757d",highlight:"#007bff"},fontSettings:{family:"Arial, sans-serif",size:"4rem",weight:"normal",style:"normal",lineHeight:1.2,letterSpacing:"0.05em",textAlign:"center",textDecoration:"none",textShadow:"none"},settings:{defaultFontSize:"4rem",defaultFontFamily:"Arial, sans-serif",defaultTextColor:"#000000",defaultBackgroundColor:"#FFFFFF",maxObjects:20,minObjectSize:10,maxObjectSize:1e3,allowAnimation:!0,allowEffects:!0,allowVideo:!0,allowGif:!0,exportFormats:["png","jpg","webp","svg","pdf"],defaultExportFormat:"png",exportQuality:"high"},metadata:{version:"1.0.0",author:"User",tags:["custom","user-created"],difficulty:"beginner",estimatedTime:5,lastModified:new Date().toISOString(),usage:{views:0,downloads:0,favorites:0}},initialText:"新しいテキスト",initialTextColor:"#000000",initialFontSize:"4rem",isCustom:!0,createdAt:new Date().toISOString()}];L(s),$([...eo.k,...s]),localStorage.setItem("customThumbnailTemplates",JSON.stringify(s)),n.oR.success("カスタムテンプレートを作成しました！"),J(!1)},onClose:()=>J(!1)})]})})]})]}):"manage"===B?(0,a.jsx)(X,{templates:P,onTemplatesChange:Z,onSelectTemplate:s,selectedTemplateId:t}):(0,a.jsx)(er,{onTemplateGenerated:s,onTemplatesGenerated:e=>{Z([...P,...e])}})]})};var eh=t(78708),ex=t(80472);let eu=l.memo(e=>{let{id:s,isSelected:t,text:i,color:n="white",fontSize:r="2rem",fontFamily:c,fontWeight:o,fontStyle:d,textDecoration:m,textShadow:h,className:x,x:u,y:j,width:g,height:p,rotation:v,zIndex:f=0,onDragStop:b,onResizeStop:N,enableResizing:w,disableDragging:C,onSelect:S,isLocked:k,isDraggable:z,onRotateStart:E,onRotate:F,onRotateStop:A}=e,{updateLayer:R}=(0,y.S)(),[T,M]=(0,l.useState)({x:u,y:j}),[J,I]=(0,l.useState)(!1),q=(0,l.useRef)(null),P=(0,l.useRef)(null);(0,l.useEffect)(()=>{M({x:u,y:j})},[u,j]);let L=(0,l.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),I(!0);let a=null==(t=q.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+T.x+g/2,r=i.top+T.y+p/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-n;R(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},o=()=>{I(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[s,R,T.x,T.y,g,p]);return(0,l.useEffect)(()=>{let e=P.current;if(e)return e.addEventListener("touchstart",L,{passive:!1}),()=>{e.removeEventListener("touchstart",L)}},[L]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh.p,{ref:q,size:{width:g,height:p},position:T,onDragStart:()=>{if(J)return!1;null==S||S()},onDrag:(e,s)=>{J||M({x:s.x,y:s.y})},onDragStop:b,onResizeStop:N,minWidth:50,minHeight:20,enableResizing:w,disableDragging:C||J,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{display:"flex",alignItems:"center",justifyContent:"center",zIndex:f},children:(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",style:{transform:"rotate(".concat(v,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("p",{className:(0,D.cn)("cursor-move",x),style:{color:n,fontSize:r,fontFamily:c,fontWeight:o,fontStyle:d,textDecoration:m,textShadow:h,lineHeight:1,whiteSpace:"pre-wrap"},children:i})})}),t&&(0,a.jsx)("div",{ref:P,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),I(!0);let a=null==(t=q.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+T.x+g/2,r=i.top+T.y+p/2,c=e=>{let t=e.clientX-n;R(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},o=()=>{I(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:T.x+g/2,top:T.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})]})}),ej=l.memo(e=>{let{id:s,isSelected:t,src:i,alt:n,x:r,y:c,width:o,height:d,rotation:m,zIndex:h=0,onDragStop:x,onResize:u,onResizeStop:j,onSelect:g,isLocked:p,isDraggable:v,lockAspectRatio:f,enableResizing:b,disableDragging:N,onRotateStart:w,onRotate:C,onRotateStop:S}=e,{updateLayer:k}=(0,y.S)(),[z,E]=(0,l.useState)({x:r,y:c}),[F,A]=(0,l.useState)(!1),R=(0,l.useRef)(null),D=(0,l.useRef)(null);(0,l.useEffect)(()=>{E({x:r,y:c})},[r,c]);let T=(0,l.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),A(!0);let a=null==(t=R.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+z.x+o/2,r=i.top+z.y+d/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-n;k(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},m=()=>{A(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",m)};window.addEventListener("touchmove",c),window.addEventListener("touchend",m)},[s,k,z.x,z.y,o,d]);return(0,l.useEffect)(()=>{let e=D.current;if(e)return e.addEventListener("touchstart",T,{passive:!1}),()=>{e.removeEventListener("touchstart",T)}},[T]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh.p,{ref:R,size:{width:o,height:d},position:z,onDragStart:()=>{if(F)return!1},onDrag:(e,s)=>{F||E({x:s.x,y:s.y})},onDragStop:x,onResize:u,onResizeStop:j,lockAspectRatio:f,enableResizing:b,disableDragging:N||F,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{zIndex:h},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(m,"deg)"),transformOrigin:"center"},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundImage:i?"url(".concat(i,")"):"none",backgroundSize:"cover",backgroundPosition:"center"}})})}),t&&(0,a.jsx)("div",{ref:D,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),A(!0);let a=null==(t=R.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+z.x+o/2,r=i.top+z.y+d/2,c=e=>{let t=e.clientX-n;k(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},m=()=>{A(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",m)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",m)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:z.x+o/2,top:z.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})]})}),eg=e=>{let{id:s,isSelected:t,shapeType:i,backgroundColor:n,borderColor:r,borderWidth:c,rotation:o,zIndex:d=0,onDragStop:m,onResize:h,onResizeStop:x,lockAspectRatio:u,enableResizing:j,disableDragging:g,x:p,y:v,width:f,height:b,onSelect:N,isLocked:w,isDraggable:C,onRotateStart:S,onRotate:k,onRotateStop:z}=e,{updateLayer:E}=(0,y.S)(),[F,A]=(0,l.useState)({x:p||0,y:v||0}),[R,D]=(0,l.useState)(!1),T=(0,l.useRef)(null),M=(0,l.useRef)(null);(0,l.useEffect)(()=>{A({x:p||0,y:v||0})},[p,v]);let J=(0,l.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),D(!0);let a=null==(t=T.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+F.x+f/2,r=i.top+F.y+b/2,c=e=>{if(0===e.touches.length)return;let t=e.touches[0].clientX-n;E(s,{rotation:180/Math.PI*Math.atan2(e.touches[0].clientY-r,t)+90})},o=()=>{D(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",o)};window.addEventListener("touchmove",c),window.addEventListener("touchend",o)},[s,E,F.x,F.y,f,b]);return(0,l.useEffect)(()=>{let e=M.current;if(e)return e.addEventListener("touchstart",J,{passive:!1}),()=>{e.removeEventListener("touchstart",J)}},[J]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh.p,{ref:T,size:{width:f,height:b},position:F,onDragStart:()=>{if(R)return!1;null==N||N()},onDrag:(e,s)=>{R||A({x:s.x,y:s.y})},onDragStop:m,onResize:h,onResizeStop:x,lockAspectRatio:u,enableResizing:j,disableDragging:g||R,className:"border border-dashed border-transparent hover:border-gray-500 transition-colors duration-200",style:{zIndex:d},children:(0,a.jsx)("div",{style:{width:"100%",height:"100%",transform:"rotate(".concat(o,"deg)"),transformOrigin:"center"},children:(()=>{let e={width:"100%",height:"100%",style:{overflow:"visible"}};switch(i){case"line":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("line",{x1:0,y1:b/2,x2:f,y2:b/2,stroke:r,strokeWidth:c})});case"arrow":return(0,a.jsxs)("svg",{...e,children:[(0,a.jsx)("defs",{children:(0,a.jsx)("marker",{id:"arrowhead-".concat(s),markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",fill:r,children:(0,a.jsx)("polygon",{points:"0 0, 10 3.5, 0 7"})})}),(0,a.jsx)("line",{x1:0,y1:b/2,x2:f-10,y2:b/2,stroke:r,strokeWidth:c,markerEnd:"url(#arrowhead-".concat(s,")")})]});case"triangle":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(f/2,",0 0,").concat(b," ").concat(f,",").concat(b),fill:n,stroke:r,strokeWidth:c})});case"star":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*f,",0 ").concat(.618*f,",").concat(.382*b," ").concat(f,",").concat(.382*b," ").concat(.691*f,",").concat(.618*b," ").concat(.809*f,",").concat(b," ").concat(.5*f,",").concat(.764*b," ").concat(.191*f,",").concat(b," ").concat(.309*f,",").concat(.618*b," 0,").concat(.382*b," ").concat(.382*f,",").concat(.382*b),fill:n,stroke:r,strokeWidth:c})});case"heart":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("path",{d:"M".concat(.5*f,",").concat(.9*b," C").concat(.5*f,",").concat(.9*b," ").concat(.1*f,",").concat(.5*b," ").concat(.1*f,",").concat(.3*b," C").concat(.1*f,",").concat(.15*b," ").concat(.25*f,",").concat(.1*b," ").concat(.4*f,",").concat(.1*b," C").concat(.5*f,",").concat(.1*b," ").concat(.5*f,",").concat(.2*b," ").concat(.5*f,",").concat(.2*b," C").concat(.5*f,",").concat(.2*b," ").concat(.5*f,",").concat(.1*b," ").concat(.6*f,",").concat(.1*b," C").concat(.75*f,",").concat(.1*b," ").concat(.9*f,",").concat(.15*b," ").concat(.9*f,",").concat(.3*b," C").concat(.9*f,",").concat(.5*b," ").concat(.5*f,",").concat(.9*b," ").concat(.5*f,",").concat(.9*b," Z"),fill:n,stroke:r,strokeWidth:c})});case"diamond":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(f/2,",0 ").concat(f,",").concat(b/2," ").concat(f/2,",").concat(b," 0,").concat(b/2),fill:n,stroke:r,strokeWidth:c})});case"polygon":return(0,a.jsx)("svg",{...e,children:(0,a.jsx)("polygon",{points:"".concat(.5*f,",0 ").concat(.9*f,",").concat(.3*b," ").concat(.7*f,",").concat(.9*b," ").concat(.3*f,",").concat(.9*b," ").concat(.1*f,",").concat(.3*b),fill:n,stroke:r,strokeWidth:c})});default:return(0,a.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:n,border:"".concat(c,"px solid ").concat(r),borderRadius:"circle"===i?"50%":"0"}})}})()})}),t&&(0,a.jsx)("div",{ref:M,onMouseDown:e=>{var t;e.preventDefault(),e.stopPropagation(),D(!0);let a=null==(t=T.current)?void 0:t.getSelfElement();if(!a)return;let l=a.parentElement;if(!l)return;let i=l.getBoundingClientRect(),n=i.left+F.x+f/2,r=i.top+F.y+b/2,c=e=>{let t=e.clientX-n;E(s,{rotation:180/Math.PI*Math.atan2(e.clientY-r,t)+90})},o=()=>{D(!1),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",o)},className:"absolute cursor-grab active:cursor-grabbing bg-white border rounded-full p-1 shadow z-10",style:{left:F.x+f/2,top:F.y-30,transform:"translateX(-50%)"},children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})]})};var ep=t(92248),ev=t(60307),ef=t(24973),eb=t(45874),ey=t(14202);let eN={"youtube-standard":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"youtube",batchExport:!1,batchSizes:[]},"twitter-optimized":{resolution:"custom",customWidth:1200,customHeight:675,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"twitter",batchExport:!1,batchSizes:[]},"instagram-square":{resolution:"custom",customWidth:1080,customHeight:1080,quality:"high",format:"jpeg",pixelRatio:2,includeTransparency:!1,optimizeForPlatform:"instagram",batchExport:!1,batchSizes:[]},"batch-all-platforms":{resolution:"fhd",quality:"high",format:"png",pixelRatio:2,includeTransparency:!0,optimizeForPlatform:"general",batchExport:!0,batchSizes:[{name:"YouTube",width:1920,height:1080,platform:"youtube"},{name:"Twitter",width:1200,height:675,platform:"twitter"},{name:"Instagram",width:1080,height:1080,platform:"instagram"},{name:"Facebook",width:1200,height:630,platform:"facebook"}]}},ew={hd:{width:1280,height:720,label:"HD (1280\xd7720)"},fhd:{width:1920,height:1080,label:"FHD (1920\xd71080)"},"4k":{width:3840,height:2160,label:"4K (3840\xd72160)"},custom:{width:0,height:0,label:"カスタム"}},eC={low:{pixelRatio:1,quality:.6,label:"低品質 (軽量)"},medium:{pixelRatio:1.5,quality:.8,label:"中品質 (バランス)"},high:{pixelRatio:2,quality:.9,label:"高品質 (推奨)"},ultra:{pixelRatio:3,quality:1,label:"最高品質 (重い)"}},eS=e=>{let{onExport:s,isExporting:t}=e,[i,c]=(0,l.useState)(eN["youtube-standard"]),[d,m]=(0,l.useState)({}),[h,x]=(0,l.useState)(!1),u=!(0,ey.U)("(min-width: 768px)");l.useEffect(()=>{let e=localStorage.getItem("thumbnailExportPresets");e&&m(JSON.parse(e))},[]);let j=e=>{c(s=>({...s,...e}))},g=e=>{let s=eN[e]||d[e];s&&(c(s),n.oR.success("プリセット「".concat(e,"」を適用しました")))},y=async()=>{try{await s(i)}catch(e){T.vF.error("エクスポート失敗",e,"ExportSettingsPanel")}},C="custom"===i.resolution?{width:i.customWidth||1920,height:i.customHeight||1080}:ew[i.resolution];return(0,a.jsxs)(N.Zp,{className:"w-full",children:[(0,a.jsx)(N.aR,{children:(0,a.jsxs)(N.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(B.A,{className:"h-5 w-5"}),"エクスポート設定"]})}),(0,a.jsxs)(N.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"プリセット"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"fhd"!==i.resolution||i.batchExport?"outline":"default",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("youtube-standard"),children:[(0,a.jsx)(ef.A,{className:"h-4 w-4 mr-1"}),"YouTube"]}),(0,a.jsxs)(r.$,{variant:"twitter"===i.optimizeForPlatform?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("twitter-optimized"),children:[(0,a.jsx)(ef.A,{className:"h-4 w-4 mr-1"}),"Twitter"]}),(0,a.jsxs)(r.$,{variant:"instagram"===i.optimizeForPlatform?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("instagram-square"),children:[(0,a.jsx)(ef.A,{className:"h-4 w-4 mr-1"}),"Instagram"]}),(0,a.jsxs)(r.$,{variant:i.batchExport?"default":"outline",size:u?"default":"sm",className:u?"h-10":"",onClick:()=>g("batch-all-platforms"),children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-1"}),"一括出力"]})]})]}),(0,a.jsx)(Z.w,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"解像度"}),(0,a.jsxs)(b.l6,{value:i.resolution,onValueChange:e=>j({resolution:e}),children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"hd",children:"HD (1280\xd7720)"}),(0,a.jsx)(b.eb,{value:"fhd",children:"FHD (1920\xd71080)"}),(0,a.jsx)(b.eb,{value:"4k",children:"4K (3840\xd72160)"}),(0,a.jsx)(b.eb,{value:"custom",children:"カスタム"})]})]}),"custom"===i.resolution&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs",children:"幅 (px)"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:i.customWidth||1920,onChange:e=>j({customWidth:Number(e.target.value)}),min:"100",max:"8000",className:u?"h-10":""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs",children:"高さ (px)"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:i.customHeight||1080,onChange:e=>j({customHeight:Number(e.target.value)}),min:"100",max:"8000",className:u?"h-10":""})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"品質"}),(0,a.jsxs)(b.l6,{value:i.quality,onValueChange:e=>{let s=eC[e];j({quality:e,pixelRatio:s.pixelRatio})},children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"low",children:"低品質 (軽量・1x)"}),(0,a.jsx)(b.eb,{value:"medium",children:"中品質 (バランス・1.5x)"}),(0,a.jsx)(b.eb,{value:"high",children:"高品質 (推奨・2x)"}),(0,a.jsx)(b.eb,{value:"ultra",children:"最高品質 (重い・3x)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"形式"}),(0,a.jsxs)(b.l6,{value:i.format,onValueChange:e=>j({format:e}),children:[(0,a.jsx)(b.bq,{className:u?"h-10":"",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"png",children:"PNG (高品質・透明対応)"}),(0,a.jsx)(b.eb,{value:"jpeg",children:"JPEG (軽量・写真向け)"})]})]})]})]}),i.batchExport&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Z.w,{}),(0,a.jsx)("h4",{className:"font-medium",children:"バッチエクスポート"}),(0,a.jsx)("div",{className:"space-y-2",children:i.batchSizes.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:[e.width,"\xd7",e.height]})]}),(0,a.jsx)(w.E,{variant:"secondary",children:e.platform})]},s))})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:()=>x(!h),className:"w-full",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),h?"詳細設定を隠す":"詳細設定を表示"]}),h&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"背景色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"color",value:i.backgroundColor||"#ffffff",onChange:e=>j({backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(f.p,{value:i.backgroundColor||"#ffffff",onChange:e=>j({backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ev.S,{id:"transparency",checked:i.includeTransparency,onCheckedChange:e=>j({includeTransparency:!!e})}),(0,a.jsx)(v.J,{htmlFor:"transparency",className:"text-sm",children:"透明度を保持する"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(v.J,{className:"text-sm font-medium",children:["ピクセル比: ",i.pixelRatio,"x"]}),(0,a.jsx)(p.A,{value:[i.pixelRatio],onValueChange:e=>{let[s]=e;return j({pixelRatio:s})},min:.5,max:4,step:.5,className:"w-full"})]})]})]}),(0,a.jsx)(Z.w,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"出力情報"}),u?(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"解像度:"}),(0,a.jsxs)("span",{className:"font-medium",children:[C.width,"\xd7",C.height]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"形式:"}),(0,a.jsx)("span",{className:"font-medium",children:i.format.toUpperCase()})]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"解像度:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[C.width,"\xd7",C.height]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"形式:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:i.format.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"品質:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:eC[i.quality].label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"ファイル数:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[i.batchExport?i.batchSizes.length:1,"個"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.$,{onClick:y,disabled:t,className:(0,D.cn)("flex-1",u&&"h-11"),children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"h-4 w-4 mr-2 animate-spin"}),"エクスポート中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"エクスポート"]})}),(0,a.jsxs)(r.$,{variant:"outline",onClick:()=>{let e=prompt("プリセット名を入力してください:");if(e&&e.trim()){let s={...d,[e]:i};m(s),localStorage.setItem("thumbnailExportPresets",JSON.stringify(s)),n.oR.success("プリセット「".concat(e,"」を保存しました"))}},disabled:t,className:u?"h-11 px-3":"",children:[(0,a.jsx)(R.A,{className:"h-4 w-4 mr-1"}),u?"":"保存"]})]})]})]})};var ek=t(68421),ez=t(73574),eE=t(1978),eF=t(46568),eA=t(58502),eR=t(17789);let eD=["image/jpeg","image/jpg","image/png","image/webp"];function eT(){let{isOpen:e,setIsOpen:s,isDesktop:N}=(0,x.c)({defaultOpen:!1,desktopDefaultOpen:!0}),[w,C]=l.useState("settings"),[S,k]=l.useState(!1),[z,E]=l.useState(!1),[F,A]=l.useState(!1),[R,D]=l.useState(!0),[M,J]=l.useState(!1),[I,q]=l.useState(20),[P,L]=l.useState(!1),{handleAsyncError:O}=(0,u.u)(),{selectedTemplate:$,setSelectedTemplate:B,currentText:V,setCurrentText:W,layers:U,addLayer:G,removeLayer:X,updateLayer:Z,selectedLayerId:H,setSelectedLayerId:Y,reorderLayers:_,duplicateLayer:K,moveLayerUp:Q,moveLayerDown:ee,aspectRatio:es,customAspectRatio:et}=(0,y.S)(),ea=U.find(e=>e.id===H);l.useEffect(()=>{(null==ea?void 0:ea.textShadow)&&"none"!==ea.textShadow?L(!0):L(!1)},[null==ea?void 0:ea.textShadow]);let el=l.useCallback(()=>N?z?{width:"min(2000px, 95vw)",maxWidth:"none"}:e?{width:"min(1600px, 80vw)",maxWidth:"none"}:{width:"min(1800px, 90vw)",maxWidth:"none"}:z?{width:"95vw",maxWidth:"none"}:{width:"90vw",maxWidth:"none"},[N,z,e]),{zoom:ei,setZoom:en,undo:er,redo:ec,canUndo:eo,canRedo:ed,addToHistory:eh,resetHistoryFlag:ex,saveToLocalStorage:ev,loadFromLocalStorage:ef}=(0,eE.Y)(U,H);l.useEffect(()=>{let e=e=>{"Shift"===e.key&&k(!0)},s=e=>{"Shift"===e.key&&k(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",s)}},[]),l.useEffect(()=>{N?s(!0):s(!1)},[N]);let[eb,ey]=(0,l.useState)(!1),eN=l.useCallback(async e=>{let s=document.getElementById("thumbnail-preview");if(!s)return void n.oR.error("サムネイルが見つかりません");ey(!0);try{await O(async()=>{e.batchExport?await eT(s,e):await eC(s,e)},"エクスポートに失敗しました")}finally{ey(!1)}},[O]),ew=async e=>{let s=Array.from(e.querySelectorAll("img")).map(e=>new Promise(s=>{if(e.complete&&e.naturalWidth>0)s();else{let t=()=>{e.removeEventListener("load",t),e.removeEventListener("error",a),s()},a=()=>{e.removeEventListener("load",t),e.removeEventListener("error",a),T.vF.warn("画像の読み込みに失敗しました",{src:e.src},"ThumbnailGenerator"),s()};e.addEventListener("load",t),e.addEventListener("error",a)}}));await Promise.all(s),await new Promise(e=>setTimeout(e,500))},eC=async(e,s)=>{let a,l;await ew(e);let r={low:{pixelRatio:1,quality:.6},medium:{pixelRatio:1.5,quality:.8},high:{pixelRatio:2,quality:.9},ultra:{pixelRatio:3,quality:1}}[s.quality],c="custom"===s.resolution?{width:s.customWidth||1920,height:s.customHeight||1080}:({hd:{width:1280,height:720},fhd:{width:1920,height:1080},"4k":{width:3840,height:2160}})[s.resolution],o={cacheBust:!1,pixelRatio:s.pixelRatio||r.pixelRatio,quality:"png"===s.format?1:r.quality,backgroundColor:s.backgroundColor||"#ffffff",width:c.width,height:c.height,style:{transform:"scale(1)",transformOrigin:"top left"}};if("png"===s.format)a=await (0,i.$E)(e,o),l="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".png");else if("jpeg"===s.format){let{toJpeg:i}=await Promise.resolve().then(t.bind(t,79419));a=await i(e,o),l="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".jpg")}else a=await (0,i.$E)(e,o),l="thumbnail-".concat(s.optimizeForPlatform,"-").concat(c.width,"x").concat(c.height,".png");let d=document.createElement("a");d.download=l,d.href=a,d.click(),n.oR.success("".concat(l," をエクスポートしました"))},eT=async(e,s)=>{let a=s.batchSizes.map(async a=>{let l,n,r={cacheBust:!0,pixelRatio:s.pixelRatio||2,quality:"png"===s.format?1:.9,backgroundColor:s.backgroundColor||"#ffffff",width:a.width,height:a.height};if("png"===s.format)l=await (0,i.$E)(e,r),n="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");else if("jpeg"===s.format){let{toJpeg:s}=await Promise.resolve().then(t.bind(t,79419));l=await s(e,r),n="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".jpg")}else l=await (0,i.$E)(e,r),n="thumbnail-".concat(a.platform,"-").concat(a.width,"x").concat(a.height,".png");let c=document.createElement("a");return c.download=n,c.href=l,c.click(),n}),l=await Promise.all(a);n.oR.success("".concat(l.length,"個のファイルをエクスポートしました"))},eM=l.useCallback((e,s,t)=>{Z(e,{x:t.x,y:t.y}),eh(U,H)},[Z,eh,U,H]),eJ=l.useCallback((e,s,t,a,l)=>{Z(e,{width:t.offsetWidth,height:t.offsetHeight,x:l.x,y:l.y}),eh(U,H)},[Z,eh,U,H]),eI=e=>{let s=U.filter(e=>"shape"===e.type).length*(N?20:5),t=U.filter(s=>s.shapeType===e).length+1,a="",l=N?550:10,i=N?250:10,n=N?300:50,r=N?300:50,c=N?2:1,o=N?300:100,d=N?5:3;switch(e){case"rectangle":a="四角 ".concat(t);break;case"circle":a="円 ".concat(t);break;case"line":a="線 ".concat(t);break;case"arrow":a="矢印 ".concat(t)}G({type:"shape",shapeType:e,name:a,visible:!0,locked:!1,x:l+s,y:i+s,width:"line"===e||"arrow"===e?o:n,height:"line"===e||"arrow"===e?d:r,backgroundColor:"#cccccc",borderColor:"#000000",borderWidth:c})};if(!$)return(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("p",{children:"テンプレートを読み込み中..."})});let eq=()=>{var e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"基本情報"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"レイヤー名"}),(0,a.jsx)(f.p,{value:(null==ea?void 0:ea.name)||"",onChange:e=>ea&&Z(ea.id,{name:e.target.value}),className:"mt-1",placeholder:"レイヤー名を入力",disabled:!ea})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"X座標"}),(0,a.jsx)(f.p,{type:"number",value:(null==ea?void 0:ea.x)||0,onChange:e=>ea&&Z(ea.id,{x:Number(e.target.value)}),className:"mt-1",disabled:!ea})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"Y座標"}),(0,a.jsx)(f.p,{type:"number",value:(null==ea?void 0:ea.y)||0,onChange:e=>ea&&Z(ea.id,{y:Number(e.target.value)}),className:"mt-1",disabled:!ea})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"幅"}),(0,a.jsx)(f.p,{type:"number",value:(null==ea?void 0:ea.width)||0,onChange:e=>ea&&Z(ea.id,{width:Number(e.target.value)}),className:"mt-1",disabled:!ea})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"高さ"}),(0,a.jsx)(f.p,{type:"number",value:(null==ea?void 0:ea.height)||0,onChange:e=>ea&&Z(ea.id,{height:Number(e.target.value)}),className:"mt-1",disabled:!ea})]})]})]})]}),(null==ea?void 0:ea.type)==="text"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"テキスト"}),(0,a.jsx)(g.T,{value:ea.text||"",onChange:e=>Z(ea.id,{text:e.target.value}),className:"mt-1 min-h-[80px] resize-none",placeholder:"テキストを入力してください"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"フォントサイズ"}),(0,a.jsx)(p.A,{value:[parseFloat((null==(e=ea.fontSize)?void 0:e.replace("rem",""))||"2")],onValueChange:e=>{let[s]=e;return Z(ea.id,{fontSize:"".concat(s,"rem")})},min:.5,max:8,step:.1,className:"mt-2"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center mt-1",children:ea.fontSize||"2rem"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:ea.color||"#ffffff",onChange:e=>Z(ea.id,{color:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(f.p,{value:ea.color||"#ffffff",onChange:e=>Z(ea.id,{color:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-300",children:"フォント設定"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-400",children:"フォントファミリー"}),(0,a.jsx)(eA.R,{value:ea.fontFamily||"Arial, sans-serif",onValueChange:e=>Z(ea.id,{fontFamily:e})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-400",children:"フォントウェイト"}),(0,a.jsxs)(b.l6,{value:ea.fontWeight||"normal",onValueChange:e=>Z(ea.id,{fontWeight:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"normal",children:"通常"}),(0,a.jsx)(b.eb,{value:"bold",children:"太字"}),(0,a.jsx)(b.eb,{value:"lighter",children:"細字"}),(0,a.jsx)(b.eb,{value:"100",children:"100"}),(0,a.jsx)(b.eb,{value:"300",children:"300"}),(0,a.jsx)(b.eb,{value:"400",children:"400"}),(0,a.jsx)(b.eb,{value:"500",children:"500"}),(0,a.jsx)(b.eb,{value:"600",children:"600"}),(0,a.jsx)(b.eb,{value:"700",children:"700"}),(0,a.jsx)(b.eb,{value:"800",children:"800"}),(0,a.jsx)(b.eb,{value:"900",children:"900"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-400",children:"フォントスタイル"}),(0,a.jsxs)(b.l6,{value:ea.fontStyle||"normal",onValueChange:e=>Z(ea.id,{fontStyle:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"normal",children:"通常"}),(0,a.jsx)(b.eb,{value:"italic",children:"イタリック"}),(0,a.jsx)(b.eb,{value:"oblique",children:"斜体"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-400",children:"文字装飾"}),(0,a.jsxs)(b.l6,{value:ea.textDecoration||"none",onValueChange:e=>Z(ea.id,{textDecoration:e}),children:[(0,a.jsx)(b.bq,{className:"h-8 text-xs",children:(0,a.jsx)(b.yv,{})}),(0,a.jsxs)(b.gC,{children:[(0,a.jsx)(b.eb,{value:"none",children:"なし"}),(0,a.jsx)(b.eb,{value:"underline",children:"下線"}),(0,a.jsx)(b.eb,{value:"line-through",children:"取り消し線"}),(0,a.jsx)(b.eb,{value:"overline",children:"上線"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-400",children:"文字シャドウ"}),(0,a.jsx)(r.$,{size:"sm",variant:P?"default":"outline",onClick:()=>{let e=!P;L(e),e?Z(ea.id,{textShadow:"2px 2px 4px rgba(0,0,0,0.5)"}):Z(ea.id,{textShadow:"none"})},className:"h-6 px-3 text-xs",children:P?"ON":"OFF"})]}),P&&(()=>{let e=(0,eF.T)(ea.textShadow),s=(e,s)=>{let t={...(0,eF.T)(ea.textShadow),[e]:s},a=(0,eF.A)(t.x,t.y,t.blur,t.color,t.opacity);Z(ea.id,{textShadow:a})};return(0,a.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-500",children:"水平位置（X）"}),(0,a.jsx)(p.A,{value:[e.x],onValueChange:e=>{let[t]=e;return s("x",t)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.x,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-500",children:"垂直位置（Y）"}),(0,a.jsx)(p.A,{value:[e.y],onValueChange:e=>{let[t]=e;return s("y",t)},min:-20,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.y,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-500",children:"ぼかし"}),(0,a.jsx)(p.A,{value:[e.blur],onValueChange:e=>{let[t]=e;return s("blur",t)},min:0,max:30,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[e.blur,"px"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-500",children:"影の色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:e.color,onChange:e=>s("color",e.target.value),className:"w-10 h-8 rounded border border-gray-600"}),(0,a.jsx)(f.p,{value:e.color,onChange:e=>s("color",e.target.value),className:"h-8 text-xs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-xs text-gray-500",children:"不透明度"}),(0,a.jsx)(p.A,{value:[100*e.opacity],onValueChange:e=>{let[t]=e;return s("opacity",t/100)},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[Math.round(100*e.opacity),"%"]})]})]})})()]})]})]})]}),(null==ea?void 0:ea.type)==="image"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"画像設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"画像を変更"}),(0,a.jsx)(f.p,{type:"file",accept:"image/*",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){let e=URL.createObjectURL(t);Z(ea.id,{src:e})}},className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"不透明度"}),(0,a.jsx)(p.A,{value:[ea.opacity||100],onValueChange:e=>{let[s]=e;return Z(ea.id,{opacity:s})},min:0,max:100,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[ea.opacity||100,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"回転角度"}),(0,a.jsx)(p.A,{value:[ea.rotation||0],onValueChange:e=>{let[s]=e;return Z(ea.id,{rotation:s})},min:-180,max:180,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[ea.rotation||0,"\xb0"]})]})]})]}),(null==ea?void 0:ea.type)==="shape"&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"図形設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"図形の種類"}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(eR.X,{value:ea.shapeType||"rectangle",onChange:e=>Z(ea.id,{shapeType:e})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"塗りつぶし色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:ea.backgroundColor||"#000000",onChange:e=>Z(ea.id,{backgroundColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(f.p,{value:ea.backgroundColor||"#000000",onChange:e=>Z(ea.id,{backgroundColor:e.target.value}),className:"flex-1"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"境界線色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"color",value:ea.borderColor||"#000000",onChange:e=>Z(ea.id,{borderColor:e.target.value}),className:"w-8 h-8 rounded border border-gray-300"}),(0,a.jsx)(f.p,{value:ea.borderColor||"#000000",onChange:e=>Z(ea.id,{borderColor:e.target.value}),className:"flex-1"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v.J,{className:"text-sm font-medium",children:"境界線の太さ"}),(0,a.jsx)(p.A,{value:[ea.borderWidth||0],onValueChange:e=>{let[s]=e;return Z(ea.id,{borderWidth:s})},min:0,max:20,step:1,className:"mt-2"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-1",children:[ea.borderWidth||0,"px"]})]})]})]}),!ea&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"レイヤーを選択してください"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"レイヤーパネルからレイヤーを選択すると、ここで詳細設定ができます"})]})]})},eP=(0,a.jsxs)(h.tU,{value:w,onValueChange:C,className:"w-full",children:[(0,a.jsxs)(h.j7,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(h.Xi,{value:"settings",children:"テンプレート"}),(0,a.jsx)(h.Xi,{value:"tools",children:"ツール"}),(0,a.jsx)(h.Xi,{value:"layers",children:"レイヤー"}),(0,a.jsx)(h.Xi,{value:"export",children:"エクスポート"})]}),(0,a.jsx)(h.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(em,{onSelectTemplate:B,selectedTemplateId:$.id})}),(0,a.jsx)(h.av,{value:"tools",className:"mt-4",children:eq()}),(0,a.jsx)(h.av,{value:"layers",className:"mt-4",children:(0,a.jsx)(ep.G,{context:{layers:U,updateLayer:Z,removeLayer:X,selectedLayerId:H,setSelectedLayerId:Y,reorderLayers:_,duplicateLayer:K,addLayer:G,moveLayerUp:Q,moveLayerDown:ee},onShapeSelect:e=>eI(e),showShapeSelector:!0})}),(0,a.jsx)(h.av,{value:"export",className:"mt-4",children:(0,a.jsx)(eS,{onExport:eN,isExporting:eb})})]}),eL=(0,a.jsxs)(h.tU,{value:w,onValueChange:C,className:"w-full",children:[(0,a.jsxs)(h.j7,{className:"w-full h-12 items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground",children:[(0,a.jsx)(h.Xi,{value:"settings",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-6 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"テンプレート"}),(0,a.jsx)(h.Xi,{value:"export",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-6 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"エクスポート"})]}),(0,a.jsx)(h.av,{value:"settings",className:"mt-4",children:(0,a.jsx)(em,{onSelectTemplate:B,selectedTemplateId:$.id})}),(0,a.jsx)(h.av,{value:"export",className:"mt-4",children:(0,a.jsx)(eS,{onExport:eN,isExporting:eb})})]}),eO=l.useCallback(()=>{ev(U,H)?n.oR.success("プロジェクトを保存しました"):n.oR.error("保存に失敗しました")},[ev,U,H]),e$=l.useCallback(()=>{er()&&ex()},[er,ex]),eB=l.useCallback(()=>{ec()&&ex()},[ec,ex]),eV=l.useCallback(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"high",s=document.getElementById("thumbnail-preview");if(!s)return void n.oR.error("プレビューエリアが見つかりません");try{await eC(s,{format:"png",quality:{normal:"medium",high:"high",super:"ultra"}[e],resolution:"fhd",optimizeForPlatform:"youtube",pixelRatio:"super"===e?4:"high"===e?2:1,backgroundColor:"#ffffff",includeTransparency:!1,batchExport:!1,batchSizes:[]})}catch(e){T.vF.error("エクスポート失敗",e,"ThumbnailGenerator"),n.oR.error("エクスポートに失敗しました")}},[]);return(0,a.jsxs)("div",{className:"relative flex flex-col lg:h-screen",children:[e&&!N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-30 lg:hidden",onClick:()=>s(!1)}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row flex-grow lg:h-full lg:overflow-y-auto",children:[(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto",children:[(0,a.jsx)("div",{className:"".concat(N?"p-6":"p-2 pt-16"),children:(0,a.jsx)("div",{className:"".concat(N?"":"max-h-[85vh] overflow-hidden"),children:(0,a.jsxs)(a.Fragment,{children:[N&&(0,a.jsx)(ez.M,{zoom:ei,setZoom:en,onUndo:e$,onRedo:eB,onSave:eO,onDownload:eV,canUndo:eo,canRedo:ed,isPreviewDedicatedMode:z,onTogglePreviewMode:()=>E(!z)}),!N&&z&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-20",children:(0,a.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>E(!1),className:"bg-background/90 backdrop-blur-sm shadow-lg",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"通常表示に戻る"]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100 dark:bg-gray-900 relative",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-full p-4 lg:p-8",children:(0,a.jsx)(ek.Z,{zoom:ei,onZoomReset:()=>en(1),className:"w-full",aspectRatio:es,customAspectRatio:et,showGrid:F,setShowGrid:A,showAspectGuide:R,setShowAspectGuide:D,showSafeArea:M,setShowSafeArea:J,gridSize:I,setGridSize:q,children:(0,a.jsx)("div",{id:"thumbnail-preview",style:{aspectRatio:"custom"===es?"".concat(et.width,"/").concat(et.height):(es||"16:9").replace(":","/"),...el()},className:"bg-card relative border rounded-md shadow-lg",children:(0,a.jsx)("div",{id:"download-target",className:"w-full h-full relative overflow-hidden",children:U.map(e=>{let s=e.id===H,t=s&&!e.locked,l=s&&!e.locked;return e.visible?"image"===e.type?(0,a.jsx)(ej,{id:e.id,isSelected:s,src:e.src||"",alt:e.name,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eM(e.id,s,t),onResize:(s,t,a,l,i)=>eJ(e.id,t,a,l,i),onResizeStop:(s,t,a,l,i)=>eJ(e.id,t,a,l,i),lockAspectRatio:S,enableResizing:l,disableDragging:!t,onSelect:()=>Y(e.id),isDraggable:t,isLocked:e.locked,onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{}},e.id):"text"===e.type?(0,a.jsx)(eu,{id:e.id,isSelected:s,text:e.text||"",color:e.color,fontSize:e.fontSize,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle,textDecoration:e.textDecoration,textShadow:e.textShadow,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eM(e.id,s,t),onResizeStop:(s,t,a,l,i)=>eJ(e.id,t,a,l,i),enableResizing:l,disableDragging:!t},e.id):"shape"===e.type?(0,a.jsx)(eg,{id:e.id,isSelected:s,shapeType:e.shapeType,backgroundColor:e.backgroundColor||"#cccccc",borderColor:e.borderColor||"#000000",borderWidth:e.borderWidth||2,x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation,zIndex:e.zIndex,onDragStop:(s,t)=>eM(e.id,s,t),onResize:(s,t,a,l,i)=>eJ(e.id,t,a,l,i),onResizeStop:(s,t,a,l,i)=>eJ(e.id,t,a,l,i),lockAspectRatio:S,enableResizing:l,disableDragging:!t},e.id):null:null})})})})})})]})})}),!N&&!z&&(0,a.jsxs)("div",{className:"border-t bg-background/95 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"\uD83D\uDCA1 ヒント: 「ツール設定」でレイヤーの詳細編集、「レイヤー管理」でレイヤーの並び替えができます。テンプレートやエクスポートはサイドバーからアクセスできます。"})}),(0,a.jsxs)("div",{className:"p-2 lg:p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"クイックアクセス"}),(0,a.jsx)(h.tU,{value:w,onValueChange:C,className:"w-full",children:(0,a.jsxs)(h.j7,{className:"w-full h-12 items-center justify-center rounded-md bg-secondary p-1 text-secondary-foreground",children:[(0,a.jsx)(h.Xi,{value:"tools",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"ツール設定"}),(0,a.jsx)(h.Xi,{value:"layers",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー管理"}),(0,a.jsx)(h.Xi,{value:"edit",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"レイヤー編集"}),(0,a.jsx)(h.Xi,{value:"preview",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-2 text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",children:"プレビュー"})]})})]}),"tools"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"ツール設定"}),eq()]}),"layers"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー管理"}),(0,a.jsx)(ep.G,{context:{layers:U,updateLayer:Z,removeLayer:X,selectedLayerId:H,setSelectedLayerId:Y,reorderLayers:_,duplicateLayer:K,addLayer:G,moveLayerUp:Q,moveLayerDown:ee},onShapeSelect:e=>eI(e),showShapeSelector:!0})]}),"edit"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"レイヤー編集"}),ea?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-2 bg-secondary/50 rounded-md",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"選択中"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:ea.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCD0 位置"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{x:ea.x-10}),className:"h-7 w-7 p-0",children:"←"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"X"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:Math.round(ea.x),onChange:e=>Z(ea.id,{x:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{x:ea.x+10}),className:"h-7 w-7 p-0",children:"→"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{y:ea.y-10}),className:"h-7 w-7 p-0",children:"↑"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"Y"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:Math.round(ea.y),onChange:e=>Z(ea.id,{y:Number(e.target.value)}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{y:ea.y+10}),className:"h-7 w-7 p-0",children:"↓"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCCF サイズ"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{width:Math.max(10,ea.width-20)}),className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"幅"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:Math.round(ea.width),onChange:e=>Z(ea.id,{width:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{width:ea.width+20}),className:"h-7 w-7 p-0",children:"+"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{height:Math.max(10,ea.height-20)}),className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"高さ"}),(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:Math.round(ea.height),onChange:e=>Z(ea.id,{height:Math.max(10,Number(e.target.value))}),className:"h-7 text-xs"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{height:ea.height+20}),className:"h-7 w-7 p-0",children:"+"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDD04 回転"}),(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{rotation:(ea.rotation||0)-15}),className:"h-7 w-7 p-0",title:"反時計回り 15\xb0",children:"↺"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{rotation:(ea.rotation||0)-5}),className:"h-7 w-7 p-0",title:"反時計回り 5\xb0",children:"↶"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(f.p,{type:"number",inputMode:"numeric",value:Math.round(ea.rotation||0),onChange:e=>Z(ea.id,{rotation:Number(e.target.value)}),className:"h-7 text-xs text-center",placeholder:"角度"})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{rotation:(ea.rotation||0)+5}),className:"h-7 w-7 p-0",title:"時計回り 5\xb0",children:"↷"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{rotation:(ea.rotation||0)+15}),className:"h-7 w-7 p-0",title:"時計回り 15\xb0",children:"↻"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>Z(ea.id,{rotation:0}),className:"h-7 px-2 text-xs",children:"0\xb0"})]})]}),"text"===ea.type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"✏️ テキスト設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.T,{value:ea.text||"",onChange:e=>Z(ea.id,{text:e.target.value}),className:"text-xs min-h-[60px] resize-none",placeholder:"テキストを入力"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground w-8",children:"色"}),(0,a.jsx)("input",{type:"color",value:ea.color||"#000000",onChange:e=>Z(ea.id,{color:e.target.value}),className:"w-8 h-7 rounded border"}),(0,a.jsx)(f.p,{value:ea.color||"#000000",onChange:e=>Z(ea.id,{color:e.target.value}),className:"h-7 text-xs flex-1",placeholder:"#000000"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=Math.max(.5,parseFloat(ea.fontSize||"1rem")-.25);Z(ea.id,{fontSize:"".concat(e,"rem")})},className:"h-7 w-7 p-0",children:"−"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"サイズ"}),(0,a.jsx)(f.p,{value:ea.fontSize||"1rem",onChange:e=>Z(ea.id,{fontSize:e.target.value}),className:"h-7 text-xs",placeholder:"1rem"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>{let e=parseFloat(ea.fontSize||"1rem");Z(ea.id,{fontSize:"".concat(e+.25,"rem")})},className:"h-7 w-7 p-0",children:"+"})]})]})]})]})]}):(0,a.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:(0,a.jsx)("p",{className:"text-xs",children:"レイヤーを選択してください"})})]}),"preview"===w&&(0,a.jsxs)("div",{className:"space-y-3 border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDD0D ズーム"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>en(Math.max(.25,ei-.25)),className:"h-8 w-8 p-0",disabled:ei<=.25,children:"−"}),(0,a.jsx)("div",{className:"flex-1 text-center",children:(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(100*ei),"%"]})}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>en(Math.min(4,ei+.25)),className:"h-8 w-8 p-0",disabled:ei>=4,children:"+"})]}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>en(1),className:"w-full h-8",children:"リセット (100%)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCCA プレビュー情報"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"アスペクト比:"}),(0,a.jsx)("span",{className:"font-medium",children:"custom"===es?"".concat(et.width,":").concat(et.height):es||"16:9"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"ズーム率:"}),(0,a.jsxs)("span",{className:"font-medium",children:[Math.round(100*ei),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"グリッド:"}),(0,a.jsx)("span",{className:"font-medium",children:"40px"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"⚙️ プレビュー設定"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"グリッド表示"}),(0,a.jsx)(r.$,{size:"sm",variant:F?"default":"outline",onClick:()=>A(!F),className:"h-6 px-2 text-xs",children:F?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"アスペクト比ガイド"}),(0,a.jsx)(r.$,{size:"sm",variant:R?"default":"outline",onClick:()=>D(!R),className:"h-6 px-2 text-xs",children:R?"ON":"OFF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"セーフエリア"}),(0,a.jsx)(r.$,{size:"sm",variant:M?"default":"outline",onClick:()=>J(!M),className:"h-6 px-2 text-xs",children:M?"ON":"OFF"})]}),F&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(v.J,{className:"text-xs text-muted-foreground",children:"グリッドサイズ"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(r.$,{size:"sm",variant:10===I?"default":"outline",onClick:()=>q(10),className:"h-6 px-2 text-xs flex-1",children:"10px"}),(0,a.jsx)(r.$,{size:"sm",variant:20===I?"default":"outline",onClick:()=>q(20),className:"h-6 px-2 text-xs flex-1",children:"20px"}),(0,a.jsx)(r.$,{size:"sm",variant:40===I?"default":"outline",onClick:()=>q(40),className:"h-6 px-2 text-xs flex-1",children:"40px"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCFA 表示モード"}),(0,a.jsx)(r.$,{size:"sm",variant:z?"default":"outline",onClick:()=>E(!z),className:"w-full h-8",children:z?"通常表示に戻る":"フルスクリーン表示"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.J,{className:"text-xs font-medium",children:"\uD83D\uDCBE 保存・出力"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:eO,className:"h-8",children:"保存"}),(0,a.jsx)(r.$,{size:"sm",variant:"outline",onClick:()=>eV("high"),className:"h-8",children:"ダウンロード"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"レイヤーを追加"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{G({type:"text",name:"テキスト ".concat(U.filter(e=>"text"===e.type).length+1),visible:!0,locked:!1,x:N?550:50,y:N?250:50,width:N?300:150,height:N?100:50,text:V,color:"#000000",fontSize:N?"2rem":"1rem"})},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"T"}),(0,a.jsx)("span",{children:"テキスト"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("image-upload"))?void 0:e.click()},className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDDBC️"}),(0,a.jsx)("span",{children:"画像"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eI("rectangle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⬜"}),(0,a.jsx)("span",{children:"四角"})]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>eI("circle"),className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⭕"}),(0,a.jsx)("span",{children:"円"})]})]}),(0,a.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{let s=e.target.files;if(s){for(let e of Array.from(s)){if(e.size>0xa00000){n.oR.error("ファイルサイズが大きすぎます: ".concat(e.name),{description:"10MB以下のファイルを選択してください。"});continue}if(!eD.includes(e.type)){n.oR.error("ファイル形式が無効です: ".concat(e.name),{description:"JPEG, PNG, WEBP形式の画像ファイルを選択してください。"});continue}let s=URL.createObjectURL(e);G({type:"image",name:e.name,visible:!0,locked:!1,x:N?550:50,y:N?250:50,width:N?300:150,height:N?300:150,src:s})}e.target.value=""}},className:"hidden",multiple:!0})]})]})]})]}),!e&&(0,a.jsx)(j.R,{onOpen:()=>s(!0),isDesktop:N,tabs:[{id:"settings",label:"テンプレート",icon:(0,a.jsx)(o.A,{className:"h-4 w-4"})},{id:"tools",label:"ツール",icon:(0,a.jsx)(d.A,{className:"h-4 w-4"})},{id:"layers",label:"レイヤー",icon:(0,a.jsx)(m.A,{className:"h-4 w-4"})}],onTabClick:e=>{T.vF.debug("タブクリック",{tabId:e},"ThumbnailGenerator")}}),!z&&(0,a.jsx)(j.B,{isOpen:e,onClose:()=>s(!1),title:"",isDesktop:N,className:"".concat(N?"lg:w-96":"w-full max-w-sm"),children:N?eP:eL})]})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=1207)),_N_E=e.O()}]);